<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise Completa - Combina√ß√µes de 1 a 10 D√≠gitos - Mega Sena (CORRIGIDA)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1B9A67'
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1B9A67 0%, #0F6B47 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <!-- Detec√ß√£o de tema escuro -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <!-- Header -->
    <div class="gradient-bg text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">üìä Combina√ß√µes (Todas)</h1>
            <h2 class="text-2xl md:text-3xl font-semibold mb-6">Combina√ß√µes de 1 a 10 D√≠gitos - Mega Sena</h2>
            <p class="text-lg opacity-90 max-w-3xl mx-auto">
                An√°lise estat√≠stica completa de todas as configura√ß√µes poss√≠veis para otimizar suas estrat√©gias no jogo Mega Sena
            </p>
            <p class="text-sm opacity-75 mt-2 bg-green-600 inline-block px-3 py-1 rounded-full">
                ‚úÖ C√ÅLCULOS CORRIGIDOS - C(n,6) para Mega Sena
            </p>
        </div>
    </div>

    <!-- Resumo Geral -->
    <div class="container mx-auto px-4 py-8">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üéØ Resumo Executivo</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-green-600 dark:text-green-400" id="best-config">-</div>
                    <div class="text-sm text-green-700 dark:text-green-300">Melhor Configura√ß√£o</div>
                    <div class="text-xs text-green-600 dark:text-green-400 mt-1">Maior volume de jogos</div>
                </div>
                
                <div class="text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-blue-600 dark:text-blue-400" id="optimal-range">-</div>
                    <div class="text-sm text-blue-700 dark:text-blue-300">Faixa Ideal</div>
                    <div class="text-xs text-blue-600 dark:text-blue-400 mt-1">Melhor custo-benef√≠cio</div>
                </div>
                
                <div class="text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-purple-600 dark:text-purple-400" id="total-possibilities">1023</div>
                    <div class="text-sm text-purple-700 dark:text-purple-300">Total de Configura√ß√µes</div>
                    <div class="text-xs text-purple-600 dark:text-purple-400 mt-1">Soma de todas as possibilidades</div>
                </div>
            </div>

            <!-- Gr√°fico Comparativo -->
            <div class="mb-6">
                <h4 class="text-lg font-semibold mb-4 text-center">üìà Gr√°fico Comparativo - Volume de Combina√ß√µes</h4>
                <div class="h-64 md:h-80">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </div>

        <!-- An√°lises Detalhadas por Configura√ß√£o -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">üìã An√°lises Detalhadas por Configura√ß√£o</h3>
                <button 
                    id="toggleDetailedAnalysis" 
                    class="flex items-center px-4 py-2 bg-primary hover:bg-green-700 text-white font-semibold rounded-lg transition-colors duration-200"
                    onclick="toggleDetailedAnalysisSection()"
                >
                    <span id="toggleIcon">üëÅÔ∏è</span>
                    <span id="toggleText" class="ml-2">Ocultar</span>
                </button>
            </div>
            <div id="detailed-analysis">
                <!-- Ser√° preenchido dinamicamente -->
            </div>
        </div>

        <!-- Tabela Resumo de Volumes -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mt-8">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-center md:text-left mb-4 md:mb-0">üìã Tabela Resumo - Volumes de Jogos por N√∫meros V√°lidos</h3>
                
                <!-- Campo para valor do jogo -->
                <div class="flex items-center space-x-3 bg-green-50 dark:bg-green-900/20 rounded-lg p-3">
                    <label for="gameValue" class="text-sm font-semibold" style="color: #1B9A67;">
                        üí∞ Valor por jogo:
                    </label>
                    <div class="relative">
                        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 font-bold" style="color: #1B9A67;">R$</span>
                        <input 
                            type="number" 
                            id="gameValue" 
                            value="5.00" 
                            step="0.01" 
                            min="0.01" 
                            class="w-24 pl-8 pr-3 py-2 text-base border rounded-lg focus:ring-2 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
                            style="border-color: #1B9A67; --tw-ring-color: #1B9A67;"
                            onchange="updateGameCosts()"
                        >
                    </div>
                </div>
            </div>
            
            <!-- Aviso de corre√ß√£o -->
            <div class="mb-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-md">
                <p class="text-sm text-green-800 dark:text-green-200">
                    <strong>‚úÖ C√ÅLCULOS CORRIGIDOS:</strong> Agora usando C(n,6) corretamente para Mega Sena. 
                    Exemplo: 22 n√∫meros v√°lidos = C(22,6) = 74.613 combina√ß√µes = R$ 373.065,00 (sem multiplica√ß√µes extras).
                </p>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full border-collapse">
                    <thead class="bg-gray-100 dark:bg-gray-700">
                        <tr>
                            <th class="py-3 px-4 text-left text-sm font-semibold border dark:border-gray-600">N√∫meros V√°lidos</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">Volume de Jogos C(n,6)</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">Custo Total</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600 bg-yellow-50 dark:bg-yellow-900/20">
                                <div class="flex flex-col items-center space-y-1">
                                    <span class="font-bold text-yellow-700 dark:text-yellow-300">Total de</span>
                                    <span class="font-bold text-yellow-700 dark:text-yellow-300">Configura√ß√µes</span>
                                    <div class="text-xs bg-yellow-600 text-white px-2 py-1 rounded">Soma de todas</div>
                                </div>
                            </th>

                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>3 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">120</div>
                                    <div class="text-xs font-bold bg-red-600 text-white px-2 py-1 rounded">15</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>4 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">210</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">140</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>5 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">252</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">196</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>6 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">210</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">182</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>7 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">120</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">119</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>8 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">45</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">45</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>9 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">10</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">10</div>
                                </div>
                            </th>
                            <th class="py-3 px-4 text-center text-sm font-semibold border dark:border-gray-600">
                                <div class="flex flex-col items-center space-y-1">
                                    <span>10 D√≠g.</span>
                                    <div class="text-xs font-bold bg-gray-800 text-white px-2 py-1 rounded">1</div>
                                    <div class="text-xs font-bold" style="background-color: #1B9A67; color: white;" class="px-2 py-1 rounded">1</div>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="volume-table-body">
                        <!-- Ser√° preenchido dinamicamente -->
                    </tbody>
                </table>
            </div>
            
            <div class="mt-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-md">
                <p class="text-sm" style="color: #1B9A67;">
                    <strong>üí° Legenda:</strong> A tabela mostra quantas configura√ß√µes de cada n√∫mero de d√≠gitos conseguem formar determinado n√∫mero de n√∫meros v√°lidos (1-60), 
                    seus respectivos volumes de jogos poss√≠veis usando <strong>C(n,6)</strong> para Mega Sena e o custo total baseado no valor por jogo. 
                    Os badges cinzas mostram o total de combina√ß√µes e os badges coloridos mostram as combina√ß√µes v√°lidas.
                </p>
            </div>
            
            <!-- Bot√µes de A√ß√£o da Tabela -->
            <div class="mt-6 flex flex-col sm:flex-row gap-3 justify-center">
                <button 
                    id="btnPrintTable" 
                    class="flex items-center justify-center px-6 py-3 text-white font-semibold rounded-lg shadow-lg transition-colors duration-200"
                    style="background-color: #1B9A67; hover:background-color: #0F6B47;"
                    onclick="printTable()"
                >
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    üñ®Ô∏è Imprimir Tabela
                </button>
            </div>
        </div>

        <!-- Recomenda√ß√µes -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mt-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üí° Recomenda√ß√µes Estrat√©gicas</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg">
                    <h4 class="font-bold text-green-800 dark:text-green-200 mb-3">üéØ Para M√°xima Cobertura:</h4>
                    <ul class="text-sm text-green-700 dark:text-green-300 space-y-2">
                        <li>‚Ä¢ <strong>5-6 d√≠gitos:</strong> Cobertura completa de todos os n√∫meros 1-60</li>
                        <li>‚Ä¢ <strong>Volume m√°ximo:</strong> Milh√µes de combina√ß√µes poss√≠veis</li>
                        <li>‚Ä¢ <strong>Ideal para:</strong> Estrat√©gias agressivas e or√ßamentos maiores</li>
                    </ul>
                </div>
                
                <div class="p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
                    <h4 class="font-bold text-blue-800 dark:text-blue-200 mb-3">‚öñÔ∏è Para Equil√≠brio:</h4>
                    <ul class="text-sm text-blue-700 dark:text-blue-300 space-y-2">
                        <li>‚Ä¢ <strong>3-4 d√≠gitos:</strong> Boa cobertura com volume gerenci√°vel</li>
                        <li>‚Ä¢ <strong>Volume m√©dio:</strong> Milhares a centenas de milhares de jogos</li>
                        <li>‚Ä¢ <strong>Ideal para:</strong> Estrat√©gias moderadas e or√ßamentos m√©dios</li>
                    </ul>
                </div>
                
                <div class="p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg">
                    <h4 class="font-bold text-yellow-800 dark:text-yellow-200 mb-3">üé≤ Para Iniciantes:</h4>
                    <ul class="text-sm text-yellow-700 dark:text-yellow-300 space-y-2">
                        <li>‚Ä¢ <strong>2-3 d√≠gitos:</strong> Simplicidade com alguma variedade</li>
                        <li>‚Ä¢ <strong>Volume baixo:</strong> Dezenas a centenas de jogos</li>
                        <li>‚Ä¢ <strong>Ideal para:</strong> Primeiros testes e or√ßamentos limitados</li>
                    </ul>
                </div>
                
                <div class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg">
                    <h4 class="font-bold text-red-800 dark:text-red-200 mb-3">‚ö†Ô∏è N√£o Recomendado:</h4>
                    <ul class="text-sm text-red-700 dark:text-red-300 space-y-2">
                        <li>‚Ä¢ <strong>1 d√≠gito:</strong> Cobertura muito limitada</li>
                        <li>‚Ä¢ <strong>9-10 d√≠gitos:</strong> Redund√¢ncia desnecess√°ria</li>
                        <li>‚Ä¢ <strong>Problema:</strong> Inefici√™ncia no uso dos recursos</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sistema de Cache para otimiza√ß√£o
        class GameCache {
            constructor() {
                this.cacheKey = 'megasena_analysis_cache';
                this.cacheVersion = '1.0';
                this.cache = this.loadCache();
            }
            
            loadCache() {
                try {
                    // Simular cache usando uma vari√°vel global j√° que localStorage n√£o est√° dispon√≠vel
                    if (window.gameAnalysisCache) {
                        return window.gameAnalysisCache;
                    }
                    return {};
                } catch (e) {
                    return {};
                }
            }
            
            saveCache() {
                try {
                    window.gameAnalysisCache = this.cache;
                } catch (e) {
                    console.warn('Cache n√£o p√¥de ser salvo');
                }
            }
            
            get(key) {
                return this.cache[key];
            }
            
            set(key, value) {
                this.cache[key] = value;
                this.saveCache();
            }
            
            has(key) {
                return key in this.cache;
            }
        }
        
        // Inst√¢ncia global do cache
        const gameCache = new GameCache();
        
        // Dados das configura√ß√µes com dados reais do index.html (apenas 3-10 d√≠gitos)
        const configurations = [
            { digits: 1, totalCombinations: 10, validCombinations: null, name: "1 D√≠gito" },
            { digits: 2, totalCombinations: 45, validCombinations: null, name: "2 D√≠gitos" },
            { digits: 3, totalCombinations: 120, validCombinations: 15, name: "3 D√≠gitos" },
            { digits: 4, totalCombinations: 210, validCombinations: 140, name: "4 D√≠gitos" },
            { digits: 5, totalCombinations: 252, validCombinations: 196, name: "5 D√≠gitos" },
            { digits: 6, totalCombinations: 210, validCombinations: 182, name: "6 D√≠gitos" },
            { digits: 7, totalCombinations: 120, validCombinations: 119, name: "7 D√≠gitos" },
            { digits: 8, totalCombinations: 45, validCombinations: 45, name: "8 D√≠gitos" },
            { digits: 9, totalCombinations: 10, validCombinations: 10, name: "9 D√≠gitos" },
            { digits: 10, totalCombinations: 1, validCombinations: 1, name: "10 D√≠gitos" }
        ];

        // Fun√ß√£o para verificar se todos os d√≠gitos de um n√∫mero est√£o no conjunto permitido
        function containsOnlyAllowedDigits(num, allowedDigits) {
            const numStr = num.toString();
            return numStr.split('').every(digit => allowedDigits.includes(parseInt(digit)));
        }

        // FUN√á√ÉO CORRIGIDA - Calcular combina√ß√µes C(n,r) para Mega Sena
        function combinations(n, r) {
            if (r > n || r < 0) return 0;
            if (r === 0 || r === n) return 1;
            
            // Usar m√©todo iterativo mais eficiente para evitar overflow
            r = Math.min(r, n - r);
            let resultado = 1;
            
            for (let i = 0; i < r; i++) {
                resultado = resultado * (n - i) / (i + 1);
            }
            
            return Math.round(resultado);
        }

        // Fun√ß√£o para calcular estat√≠sticas detalhadas para uma configura√ß√£o (com cache)
        function calculateDetailedStats(digitCount) {
            const cacheKey = `stats_${digitCount}`;
            
            // Verificar se j√° est√° em cache
            if (gameCache.has(cacheKey)) {
                return gameCache.get(cacheKey);
            }
            
            // Gerar todas as combina√ß√µes de d√≠gitos
            const digits = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
            const allDigitCombinations = generateDigitCombinations(digits, digitCount);
            
            let totalGameCombinations = 0;
            let validConfigurations = 0;
            let insufficientConfigurations = 0;
            let lowVolumeConfigurations = 0;
            let mediumVolumeConfigurations = 0;
            let highVolumeConfigurations = 0;
            
            const exactGameCounts = {};
            
            let maxVolume = 0;
            let minVolume = Infinity;
            
            allDigitCombinations.forEach(digitSet => {
                // Calcular n√∫meros v√°lidos para esta combina√ß√£o de d√≠gitos
                const validNumbers = [];
                for (let i = 1; i <= 60; i++) { // Mega Sena: 1-60
                    if (containsOnlyAllowedDigits(i, digitSet)) {
                        validNumbers.push(i);
                    }
                }
                
                // Calcular combina√ß√µes de jogos poss√≠veis - CORRIGIDO para C(n,6)
                let gameCombinations = 0;
                if (validNumbers.length >= 6) { // Mega Sena: 6 n√∫meros
                    gameCombinations = combinations(validNumbers.length, 6);
                    validConfigurations++;
                    totalGameCombinations += gameCombinations;
                    
                    // Contar valores exatos de jogos
                    exactGameCounts[gameCombinations] = (exactGameCounts[gameCombinations] || 0) + 1;
                    
                    // Categorizar por volume
                    if (gameCombinations < 100) {
                        lowVolumeConfigurations++;
                    } else if (gameCombinations < 1000) {
                        mediumVolumeConfigurations++;
                    } else {
                        highVolumeConfigurations++;
                    }
                    
                    // Atualizar min/max
                    maxVolume = Math.max(maxVolume, gameCombinations);
                    minVolume = Math.min(minVolume, gameCombinations);
                } else {
                    insufficientConfigurations++;
                    exactGameCounts['insuficiente'] = (exactGameCounts['insuficiente'] || 0) + 1;
                }
            });
            
            const avgVolume = validConfigurations > 0 ? Math.round(totalGameCombinations / validConfigurations) : 0;
            
            const result = {
                digitCount,
                totalDigitCombinations: allDigitCombinations.length,
                validConfigurations,
                insufficientConfigurations,
                lowVolumeConfigurations,
                mediumVolumeConfigurations,
                highVolumeConfigurations,
                totalGameCombinations,
                avgVolume,
                maxVolume: maxVolume > 0 ? maxVolume : 0,
                minVolume: minVolume < Infinity ? minVolume : 0,
                exactGameCounts,
                allDigitCombinations
            };
            
            // Salvar no cache
            gameCache.set(cacheKey, result);
            return result;
        }

        // Fun√ß√£o para gerar combina√ß√µes de d√≠gitos
        function generateDigitCombinations(arr, k) {
            const combinations = [];
            
            function backtrack(start, current) {
                if (current.length === k) {
                    combinations.push([...current]);
                    return;
                }
                
                for (let i = start; i < arr.length; i++) {
                    current.push(arr[i]);
                    backtrack(i + 1, current);
                    current.pop();
                }
            }
            
            backtrack(0, []);
            return combinations;
        }

        // Fun√ß√£o para atualizar custos dos jogos
        function updateGameCosts() {
            const gameValue = parseFloat(document.getElementById('gameValue').value) || 5.00;
            
            // Atualizar todas as c√©lulas com badges de custo das configura√ß√µes
            const cells = document.querySelectorAll('.cost-badge');
            cells.forEach(cell => {
                const count = parseInt(cell.dataset.count);
                const volume = parseInt(cell.dataset.volume);
                if (count && volume) {
                    const cost = count * volume * gameValue;
                    const costFormatted = cost.toLocaleString('pt-BR', { 
                        style: 'currency', 
                        currency: 'BRL' 
                    });
                    
                    // Encontrar o badge de custo dentro da c√©lula
                    const costBadge = cell.querySelector('.cost-value');
                    if (costBadge) {
                        costBadge.textContent = costFormatted;
                    }
                }
            });
            
            // Atualizar custos dos volumes de jogos
            const volumeCells = document.querySelectorAll('.volume-cost-cell');
            volumeCells.forEach(cell => {
                const volume = parseInt(cell.dataset.volume);
                if (volume) {
                    const totalCost = volume * gameValue;
                    const totalCostFormatted = totalCost.toLocaleString('pt-BR', { 
                        style: 'currency', 
                        currency: 'BRL' 
                    });
                    
                    const costDiv = cell.querySelector('.volume-cost');
                    if (costDiv) {
                        costDiv.textContent = totalCostFormatted;
                    }
                }
            });
        }

        // Fun√ß√£o para criar volumes espec√≠ficos din√¢micos
        function createSpecificVolumes(digitCount, exactGameCounts) {
            const container = document.getElementById(`specific-volumes-${digitCount}`);
            if (!container) return;
            
            container.innerHTML = '';

            // Ordenar os valores de jogos em ordem decrescente
            const sortedGameValues = Object.keys(exactGameCounts)
                .filter(key => key !== 'insuficiente')
                .map(key => parseInt(key))
                .sort((a, b) => b - a);

            // Adicionar valores v√°lidos primeiro
            sortedGameValues.forEach(gameValue => {
                const count = exactGameCounts[gameValue];
                if (count > 0) {
                    const div = document.createElement('div');
                    div.className = 'flex justify-between';
                    
                    const label = document.createElement('span');
                    label.textContent = `‚Üí ${gameValue.toLocaleString('pt-BR')}:`;
                    
                    const value = document.createElement('span');
                    // Definir cor baseada no volume
                    let colorClass = 'text-red-500';
                    if (gameValue >= 1000) {
                        colorClass = 'text-green-600 dark:text-green-400';
                    } else if (gameValue >= 100) {
                        colorClass = 'text-blue-600 dark:text-blue-400';
                    } else if (gameValue > 0) {
                        colorClass = 'text-yellow-600 dark:text-yellow-400';
                    }
                    
                    value.className = `font-bold ${colorClass}`;
                    value.textContent = `${count} configura√ß√µes`;
                    
                    div.appendChild(label);
                    div.appendChild(value);
                    container.appendChild(div);
                }
            });

            // Adicionar "Insuficiente" por √∫ltimo, se existir
            if (exactGameCounts['insuficiente'] > 0) {
                const div = document.createElement('div');
                div.className = 'flex justify-between';
                
                const label = document.createElement('span');
                label.textContent = '‚Üí Insuficiente:';
                
                const value = document.createElement('span');
                value.className = 'font-bold text-red-500';
                value.textContent = `${exactGameCounts['insuficiente']} configura√ß√µes`;
                
                div.appendChild(label);
                div.appendChild(value);
                container.appendChild(div);
            }

            // Se nenhuma categoria tiver valores > 0, mostrar mensagem
            if (container.children.length === 0) {
                const div = document.createElement('div');
                div.className = 'text-center text-gray-500 dark:text-gray-400 py-4';
                div.textContent = 'Nenhuma categoria de volume identificada';
                container.appendChild(div);
            }
        }

        // Fun√ß√£o para criar o gr√°fico comparativo
        function createComparisonChart() {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            
            // Calcular estat√≠sticas b√°sicas para cada configura√ß√£o
            const chartData = configurations.map(config => {
                const stats = calculateDetailedStats(config.digits);
                return {
                    label: config.name,
                    digitCombinations: config.totalCombinations,
                    avgGameVolume: stats.avgVolume,
                    maxGameVolume: stats.maxVolume
                };
            });
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartData.map(d => d.label),
                    datasets: [
                        {
                            label: 'Combina√ß√µes de D√≠gitos',
                            data: chartData.map(d => d.digitCombinations),
                            backgroundColor: 'rgba(27, 154, 103, 0.7)',
                            borderColor: 'rgba(27, 154, 103, 1)',
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'M√©dia de Jogos (milhares)',
                            data: chartData.map(d => d.avgGameVolume / 1000),
                            backgroundColor: 'rgba(15, 107, 71, 0.7)',
                            borderColor: 'rgba(15, 107, 71, 1)',
                            borderWidth: 1,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Compara√ß√£o entre Configura√ß√µes'
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Combina√ß√µes de D√≠gitos'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'M√©dia de Jogos (milhares)'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });
        }

        // FUN√á√ÉO CORRIGIDA - Criar tabela de volumes para Mega Sena
        function createVolumeTable() {
            const tableBody = document.getElementById('volume-table-body');
            
            // Calcular dados para todas as configura√ß√µes
            const allStats = configurations.map(config => calculateDetailedStats(config.digits));
            
            // Coleta todos os volumes √∫nicos e n√∫meros v√°lidos
            const allVolumes = new Set();
            const allValidNumbers = new Set();
            
            allStats.forEach(stats => {
                stats.allDigitCombinations.forEach(digitSet => {
                    // Calcular n√∫meros v√°lidos para esta combina√ß√£o
                    const validNumbers = [];
                    for (let i = 1; i <= 60; i++) { // Mega Sena: 1-60
                        if (containsOnlyAllowedDigits(i, digitSet)) {
                            validNumbers.push(i);
                        }
                    }
                    
                    allValidNumbers.add(validNumbers.length);
                    
                    if (validNumbers.length >= 6) { // Mega Sena: 6 n√∫meros
                        const volume = combinations(validNumbers.length, 6);
                        allVolumes.add(volume);
                    }
                });
            });
            
            // Converter para arrays ordenados
            const sortedValidNumbers = Array.from(allValidNumbers).sort((a, b) => b - a);
            const sortedVolumes = Array.from(allVolumes).sort((a, b) => b - a);
            
            // Criar matriz de contagem
            const countMatrix = {};
            
            allStats.forEach((stats, configIndex) => {
                stats.allDigitCombinations.forEach(digitSet => {
                    const validNumbers = [];
                    for (let i = 1; i <= 60; i++) { // Mega Sena: 1-60
                        if (containsOnlyAllowedDigits(i, digitSet)) {
                            validNumbers.push(i);
                        }
                    }
                    
                    const validCount = validNumbers.length;
                    let volume = 0;
                    
                    if (validCount >= 6) { // Mega Sena: 6 n√∫meros
                        volume = combinations(validCount, 6);
                    }
                    
                    const key = `${validCount}-${volume}`;
                    if (!countMatrix[key]) {
                        countMatrix[key] = new Array(10).fill(0);
                    }
                    countMatrix[key][configIndex]++;
                });
            });
            
            // Preencher tabela
            sortedValidNumbers.forEach(validCount => {
                if (validCount >= 6) { // Mega Sena: 6 n√∫meros
                    const volume = combinations(validCount, 6);
                    const key = `${validCount}-${volume}`;
                    const counts = countMatrix[key] || new Array(10).fill(0);
                    
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700/50';
                    
                    // Coluna de n√∫meros v√°lidos
                    const validCell = document.createElement('td');
                    validCell.className = 'py-2 px-4 border dark:border-gray-600 font-semibold';
                    validCell.textContent = `${validCount} n√∫meros`;
                    row.appendChild(validCell);
                    
                    // Coluna de volume - CORRIGIDA
                    const volumeCell = document.createElement('td');
                    volumeCell.className = 'py-2 px-4 border dark:border-gray-600 text-center';
                    
                    const volumeDiv = document.createElement('div');
                    volumeDiv.className = 'font-bold text-sm';
                    
                    // Colorir baseado no volume usando tons de verde
                    if (volume >= 10000000) {
                        volumeDiv.style.color = '#0D5C2E'; // Verde muito escuro
                    } else if (volume >= 1000000) {
                        volumeDiv.style.color = '#1B9A67'; // Verde prim√°rio
                    } else if (volume >= 100000) {
                        volumeDiv.style.color = '#2AB77B'; // Verde m√©dio
                    } else if (volume >= 1000) {
                        volumeDiv.style.color = '#3BC98F'; // Verde claro
                    } else {
                        volumeDiv.style.color = '#F59E0B'; // Amarelo para volumes baixos
                    }
                    
                    volumeDiv.textContent = volume.toLocaleString('pt-BR');
                    volumeCell.appendChild(volumeDiv);
                    row.appendChild(volumeCell);
                    
                    // Coluna de custo total - NOVA
                    const costCell = document.createElement('td');
                    costCell.className = 'py-2 px-4 border dark:border-gray-600 text-center';
                    
                    const gameValue = parseFloat(document.getElementById('gameValue').value) || 5.00;
                    const totalCost = volume * gameValue;
                    const totalCostFormatted = totalCost.toLocaleString('pt-BR', { 
                        style: 'currency', 
                        currency: 'BRL' 
                    });
                    
                    const costDiv = document.createElement('div');
                    costDiv.className = 'text-sm font-semibold px-2 py-1 rounded bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 volume-cost';
                    costDiv.textContent = totalCostFormatted;
                    
                    // Adicionar classe para atualiza√ß√£o din√¢mica
                    costCell.classList.add('volume-cost-cell');
                    costCell.dataset.volume = volume;
                    
                    costCell.appendChild(costDiv);
                    row.appendChild(costCell);
                    
                    // NOVA COLUNA - Total de Configura√ß√µes (soma de todas) com detalhes dos d√≠gitos
                    const totalConfigCell = document.createElement('td');
                    totalConfigCell.className = 'py-2 px-4 border dark:border-gray-600 text-center bg-yellow-50 dark:bg-yellow-900/20';
                    
                    // Somar todas as configura√ß√µes que geram este n√∫mero de n√∫meros v√°lidos
                    const totalConfigs = counts.slice(2).reduce((sum, count) => sum + count, 0);
                    
                    // Criar container para mostrar total e detalhes
                    const totalContainer = document.createElement('div');
                    totalContainer.className = 'flex flex-col items-center space-y-1';
                    
                    // N√∫mero total em destaque
                    const totalConfigDiv = document.createElement('div');
                    totalConfigDiv.className = 'text-lg font-bold text-yellow-700 dark:text-yellow-300';
                    totalConfigDiv.textContent = totalConfigs;
                    
                    // Detalhes dos d√≠gitos utilizados
                    const detailsDiv = document.createElement('div');
                    detailsDiv.className = 'text-xs space-y-1';
                    
                    // Configura√ß√µes com n√∫meros dos d√≠gitos (3-10 d√≠gitos)
                    const digitNumbers = [3, 4, 5, 6, 7, 8, 9, 10];
                    const detailParts = [];
                    
                    counts.slice(2).forEach((count, index) => {
                        if (count > 0) {
                            const digitNumber = digitNumbers[index];
                            detailParts.push(`${digitNumber}/${count}`);
                        }
                    });
                    
                    if (detailParts.length > 0) {
                        // Quebrar em m√∫ltiplas linhas se necess√°rio
                        const detailText = detailParts.join(' | ');
                        
                        if (detailParts.length <= 2) {
                            // Se poucos itens, mostrar em uma linha
                            const detailSpan = document.createElement('div');
                            detailSpan.className = 'text-xs text-yellow-600 dark:text-yellow-400 font-medium';
                            detailSpan.textContent = `(${detailText})`;
                            detailsDiv.appendChild(detailSpan);
                        } else {
                            // Se muitos itens, mostrar em v√°rias linhas
                            detailParts.forEach(part => {
                                const partSpan = document.createElement('div');
                                partSpan.className = 'text-xs text-yellow-600 dark:text-yellow-400 font-medium';
                                partSpan.textContent = part;
                                detailsDiv.appendChild(partSpan);
                            });
                        }
                    }
                    
                    totalContainer.appendChild(totalConfigDiv);
                    totalContainer.appendChild(detailsDiv);
                    totalConfigCell.appendChild(totalContainer);
                    row.appendChild(totalConfigCell);
                    
                    // Colunas para cada configura√ß√£o (apenas 3-10 d√≠gitos)
                    counts.slice(2).forEach((count, configIndex) => {
                        const countCell = document.createElement('td');
                        countCell.className = 'py-2 px-4 border dark:border-gray-600 text-center relative';
                        
                        if (count > 0) {
                            // Adicionar classe para identificar c√©lulas com custo
                            countCell.classList.add('cost-badge');
                            countCell.dataset.count = count;
                            countCell.dataset.volume = volume;
                            
                            // Criar container para n√∫mero de configura√ß√µes e custo
                            const container = document.createElement('div');
                            container.className = 'flex flex-col items-center space-y-1';
                            
                            // N√∫mero de configura√ß√µes
                            const countDiv = document.createElement('div');
                            countDiv.className = 'font-semibold';
                            countDiv.style.color = '#1B9A67';
                            countDiv.textContent = count;
                            
                            container.appendChild(countDiv);
                            countCell.appendChild(container);
                        } else {
                            countCell.textContent = '-';
                            countCell.classList.add('text-gray-400');
                        }
                        
                        row.appendChild(countCell);
                    });
                    
                    tableBody.appendChild(row);
                }
            });
            
            // Adicionar linha para insuficientes
            const insufRow = document.createElement('tr');
            insufRow.className = 'hover:bg-gray-50 dark:hover:bg-gray-700/50 bg-red-50 dark:bg-red-900/20';
            
            const insufValidCell = document.createElement('td');
            insufValidCell.className = 'py-2 px-4 border dark:border-gray-600 font-semibold text-red-600 dark:text-red-400';
            insufValidCell.textContent = '‚â§ 5 n√∫meros';
            insufRow.appendChild(insufValidCell);
            
            const insufVolumeCell = document.createElement('td');
            insufVolumeCell.className = 'py-2 px-4 border dark:border-gray-600 text-center font-bold text-red-600 dark:text-red-400';
            insufVolumeCell.textContent = 'Insuficiente';
            insufRow.appendChild(insufVolumeCell);
            
            const insufCostCell = document.createElement('td');
            insufCostCell.className = 'py-2 px-4 border dark:border-gray-600 text-center font-bold text-red-600 dark:text-red-400';
            insufCostCell.textContent = 'R$ 0,00';
            insufRow.appendChild(insufCostCell);
            
            // C√©lula total para insuficientes
            const insufTotalCell = document.createElement('td');
            insufTotalCell.className = 'py-2 px-4 border dark:border-gray-600 text-center bg-yellow-50 dark:bg-yellow-900/20';
            const totalInsuficient = allStats.slice(2).reduce((sum, stats) => sum + stats.insufficientConfigurations, 0);
            insufTotalCell.innerHTML = `<div class="text-lg font-bold text-red-600 dark:text-red-400">${totalInsuficient}</div>`;
            insufRow.appendChild(insufTotalCell);
            
            allStats.slice(2).forEach(stats => {
                const insufCell = document.createElement('td');
                insufCell.className = 'py-2 px-4 border dark:border-gray-600 text-center';
                
                if (stats.insufficientConfigurations > 0) {
                    insufCell.textContent = stats.insufficientConfigurations;
                    insufCell.classList.add('font-semibold', 'text-red-600', 'dark:text-red-400');
                } else {
                    insufCell.textContent = '-';
                    insufCell.classList.add('text-gray-400');
                }
                
                insufRow.appendChild(insufCell);
            });
            
            tableBody.appendChild(insufRow);
        }

        // Fun√ß√£o para criar an√°lise detalhada
        function createDetailedAnalysis() {
            const container = document.getElementById('detailed-analysis');
            
            configurations.forEach(config => {
                const stats = calculateDetailedStats(config.digits);
                
                // Determinar classifica√ß√£o
                let classification = '';
                let classificationColor = '';
                if (config.digits === 1) {
                    classification = 'Muito Limitado';
                    classificationColor = 'text-red-600 dark:text-red-400';
                } else if (config.digits <= 2) {
                    classification = 'Limitado';
                    classificationColor = 'text-orange-600 dark:text-orange-400';
                } else if (config.digits <= 4) {
                    classification = 'Equilibrado';
                    classificationColor = 'text-blue-600 dark:text-blue-400';
                } else if (config.digits <= 6) {
                    classification = 'Excelente';
                    classificationColor = 'text-green-600 dark:text-green-400';
                } else {
                    classification = 'Redundante';
                    classificationColor = 'text-purple-600 dark:text-purple-400';
                }
                
                const cardHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6 card-hover">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">${config.name}</h3>
                            <span class="px-3 py-1 rounded-full text-sm font-semibold ${classificationColor} bg-gray-100 dark:bg-gray-700">
                                ${classification}
                            </span>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div class="text-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                <div class="text-2xl font-bold text-red-600 dark:text-red-400">${stats.insufficientConfigurations}</div>
                                <div class="text-xs text-red-700 dark:text-red-300">Insuficientes</div>
                                <div class="text-xs text-red-600 dark:text-red-400 mt-1">(0 jogos)</div>
                            </div>
                            
                            <div class="text-center p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                                <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-400">${stats.lowVolumeConfigurations}</div>
                                <div class="text-xs text-yellow-700 dark:text-yellow-300">Baixo Volume</div>
                                <div class="text-xs text-yellow-600 dark:text-yellow-400 mt-1">(1-99 jogos)</div>
                            </div>
                            
                            <div class="text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">${stats.mediumVolumeConfigurations}</div>
                                <div class="text-xs text-blue-700 dark:text-blue-300">M√©dio Volume</div>
                                <div class="text-xs text-blue-600 dark:text-blue-400 mt-1">(100-999 jogos)</div>
                            </div>
                            
                            <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                <div class="text-2xl font-bold text-green-600 dark:text-green-400">${stats.highVolumeConfigurations}</div>
                                <div class="text-xs text-green-700 dark:text-green-300">Alto Volume</div>
                                <div class="text-xs text-green-600 dark:text-green-400 mt-1">(1000+ jogos)</div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                                <h4 class="font-semibold mb-3" style="color: #1B9A67;">üéØ Volumes de jogos por N√∫meros V√°lidos:</h4>
                                <div class="space-y-2 text-sm" id="specific-volumes-${config.digits}">
                                    <!-- Conte√∫do ser√° gerado dinamicamente -->
                                </div>
                            </div>
                            
                            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                                <h4 class="font-semibold mb-3" style="color: #1B9A67;">üèÜ Destaques:</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Maior volume:</span>
                                        <span class="font-bold text-green-600 dark:text-green-400">${stats.maxVolume > 0 ? stats.maxVolume.toLocaleString('pt-BR') + ' jogos' : '-'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Menor volume (v√°lido):</span>
                                        <span class="font-bold text-blue-600 dark:text-blue-400">${stats.minVolume > 0 ? stats.minVolume.toLocaleString('pt-BR') + ' jogos' : '-'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>M√©dia de jogos:</span>
                                        <span class="font-bold text-purple-600 dark:text-purple-400">${stats.avgVolume > 0 ? stats.avgVolume.toLocaleString('pt-BR') + ' jogos' : '-'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Total configura√ß√µes:</span>
                                        <span class="font-bold">${config.totalCombinations}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Configura√ß√µes v√°lidas:</span>
                                        <span class="font-bold text-green-600 dark:text-green-400">${stats.validConfigurations}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-md">
                            <p class="text-sm" style="color: #1B9A67;">
                                <strong>üí° An√°lise:</strong> ${getAnalysisText(config.digits, stats)}
                            </p>
                        </div>
                    </div>
                `;
                
                container.innerHTML += cardHTML;
                
                // Criar volumes espec√≠ficos ap√≥s adicionar o HTML
                setTimeout(() => createSpecificVolumes(config.digits, stats.exactGameCounts), 100);
            });
        }

        // Fun√ß√£o para gerar texto de an√°lise personalizado
        function getAnalysisText(digitCount, stats) {
            if (digitCount === 1) {
                return "Com apenas 1 d√≠gito, existem 10 configura√ß√µes poss√≠veis, mas a cobertura √© muito limitada. A maioria das configura√ß√µes n√£o consegue formar 6 n√∫meros v√°lidos para Mega Sena.";
            } else if (digitCount === 2) {
                return "Com 2 d√≠gitos, existem 45 configura√ß√µes poss√≠veis. Oferece mais op√ß√µes que 1 d√≠gito, mas ainda com cobertura limitada de n√∫meros v√°lidos de 1-60.";
            } else if (digitCount === 3) {
                return "Com 3 d√≠gitos, existem 120 configura√ß√µes poss√≠veis. Esta configura√ß√£o oferece ainda mais op√ß√µes, aumentando significativamente a cobertura de n√∫meros v√°lidos.";
            } else if (digitCount === 4) {
                return "Com 4 d√≠gitos, existem 210 configura√ß√µes poss√≠veis. Esta configura√ß√£o oferece excelente cobertura de n√∫meros v√°lidos, permitindo combina√ß√µes muito robustas.";
            } else if (digitCount === 5) {
                return "Com 5 d√≠gitos, existem 252 configura√ß√µes poss√≠veis. Esta √© a configura√ß√£o com maior n√∫mero de possibilidades, oferecendo cobertura m√°xima e volume de jogos muito alto.";
            } else if (digitCount === 6) {
                return "Com 6 d√≠gitos, existem 210 configura√ß√µes poss√≠veis. Oferece cobertura completa dos n√∫meros v√°lidos, mas com menos variedade que 5 d√≠gitos.";
            } else if (digitCount === 7) {
                return "Com 7 d√≠gitos, existem 120 configura√ß√µes poss√≠veis. Cobertura completa, mas com redund√¢ncia crescente e menor variedade.";
            } else if (digitCount === 8) {
                return "Com 8 d√≠gitos, existem 45 configura√ß√µes poss√≠veis. Alta redund√¢ncia, pois exclui apenas 2 d√≠gitos. Efici√™ncia question√°vel.";
            } else if (digitCount === 9) {
                return "Com 9 d√≠gitos, existem 10 configura√ß√µes poss√≠veis. Alt√≠ssima redund√¢ncia, excluindo apenas 1 d√≠gito. N√£o recomendado.";
            } else {
                return "Com 10 d√≠gitos, existe apenas 1 configura√ß√£o (todos os d√≠gitos). Redund√¢ncia m√°xima, incluindo d√≠gitos desnecess√°rios. N√£o recomendado.";
            }
        }

        // Fun√ß√£o para atualizar resumo executivo
        function updateExecutiveSummary() {
            // Encontrar melhor configura√ß√£o (mais equilibrada)
            const bestConfig = configurations.find(c => c.digits === 5);
            document.getElementById('best-config').textContent = bestConfig.name;
            
            // Definir faixa ideal
            document.getElementById('optimal-range').textContent = "3-6 D√≠gitos";
            
            // Total j√° est√° definido como 1023 (soma de todas as combina√ß√µes)
        }

        // Fun√ß√£o para imprimir a tabela
        function printTable() {
            // Criar uma nova janela para impress√£o
            const printWindow = window.open('', '_blank');
            
            // Obter o conte√∫do da tabela
            const table = document.querySelector('table').outerHTML;
            const gameValue = document.getElementById('gameValue').value;
            const currentDate = new Date().toLocaleDateString('pt-BR');
            
            // HTML para impress√£o
            const printHTML = `
                <!DOCTYPE html>
                <html lang="pt-BR">
                <head>
                    <meta charset="UTF-8">
                    <title>Tabela Resumo - Volumes de Jogos por N√∫meros V√°lidos - Mega Sena</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            margin: 20px;
                            color: #333;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 20px;
                        }
                        .info {
                            margin-bottom: 15px;
                            font-size: 14px;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 20px 0;
                        }
                        th, td {
                            border: 1px solid #333;
                            padding: 8px;
                            text-align: center;
                            font-size: 11px;
                        }
                        th {
                            background-color: #f5f5f5;
                            font-weight: bold;
                        }
                        .badge {
                            display: inline-block;
                            padding: 2px 6px;
                            border-radius: 3px;
                            font-size: 9px;
                            font-weight: bold;
                            color: white;
                            margin: 1px;
                        }
                        .bg-gray { background-color: #374151; }
                        .bg-red { background-color: #dc2626; }
                        .bg-green { background-color: #1B9A67; }
                        .footer {
                            margin-top: 20px;
                            font-size: 12px;
                            text-align: center;
                            color: #666;
                        }
                        @media print {
                            body { margin: 10px; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>üìä An√°lise Completa - Mega Sena</h1>
                        <h2>üìã Tabela Resumo - Volumes de Jogos por N√∫meros V√°lidos (CORRIGIDA)</h2>
                    </div>
                    
                    <div class="info">
                        <p><strong>Data:</strong> ${currentDate}</p>
                        <p><strong>Valor por jogo:</strong> R$ ${gameValue}</p>
                        <p><strong>Corre√ß√£o:</strong> C√°lculos usando C(n,6) para Mega Sena sem multiplica√ß√µes extras</p>
                    </div>
                    
                    ${table}
                    
                    <div class="footer">
                        <p>Gerado em ${new Date().toLocaleString('pt-BR')}</p>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(printHTML);
            printWindow.document.close();
            
            // Aguardar um momento e imprimir
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
        }

        // Fun√ß√£o para mostrar/ocultar an√°lise detalhada
        function toggleDetailedAnalysisSection() {
            const detailSection = document.getElementById('detailed-analysis');
            const toggleIcon = document.getElementById('toggleIcon');
            const toggleText = document.getElementById('toggleText');
            
            if (detailSection.style.display === 'none') {
                detailSection.style.display = 'block';
                toggleIcon.textContent = 'üëÅÔ∏è';
                toggleText.textContent = 'Ocultar';
            } else {
                detailSection.style.display = 'none';
                toggleIcon.textContent = 'üîç';
                toggleText.textContent = 'Mostrar';
            }
        }

        // Inicializar p√°gina
        window.onload = function() {
            updateExecutiveSummary();
            createDetailedAnalysis();
            createVolumeTable();
            
            // Criar gr√°fico ap√≥s um pequeno delay para garantir que o DOM est√° pronto
            setTimeout(() => {
                createComparisonChart();
            }, 200);
        };
    </script>
</body>
</html>