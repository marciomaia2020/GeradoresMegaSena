<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mega-Sena - Analisador de Combina√ß√µes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#1B9A67',
                        'primary-50': '#e9fbf4',
                        'primary-100': '#d4f7e9',
                        'primary-200': '#bef4de',
                        'primary-300': '#a8f0d3',
                        'primary-400': '#93ecc8',
                        'primary-500': '#7de8bd',
                        'primary-600': '#67e4b2',
                        'primary-700': '#52e0a7',
                        'primary-800': '#3cdd9c',
                        'primary-900': '#26d991',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .transition-all {
            transition: all 0.3s ease;
        }
        
        .combination-card {
            transition: transform 0.2s ease-in-out;
        }
        
        .combination-card:hover {
            transform: translateY(-3px);
        }
        
        /* Anima√ß√£o de carregamento */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .spinner {
            animation: spin 1s linear infinite;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #1B9A67 0%, #26d991 100%);
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header com gradiente verde -->
        <div class="gradient-bg rounded-2xl shadow-xl p-6 mb-6 text-white">
            <div class="text-center">
                <h1 class="text-3xl font-bold mb-2">üçÄ Mega-Sena</h1>
                <p class="text-primary-100 text-lg">Analisador de Combina√ß√µes e Probabilidades</p>
            </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-6">
            <h2 class="text-2xl font-bold text-center mb-6 text-primary">Analisador de Combina√ß√µes para Mega-Sena</h2>
            
            <div class="flex flex-wrap gap-4 items-center mb-6">
                <label for="tamanho" class="font-medium">Tamanho do grupo:</label>
                <select id="tamanho" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-base">
                    <option value="3">3 d√≠gitos</option>
                    <option value="4">4 d√≠gitos</option>
                    <option value="5">5 d√≠gitos</option>
                    <option value="6" selected>6 d√≠gitos</option>
                    <option value="7">7 d√≠gitos</option>
                    <option value="8">8 d√≠gitos</option>
                    <option value="9">9 d√≠gitos</option>
                    <option value="10">10 d√≠gitos</option>
                </select>
                
                <button id="gerar" class="bg-primary hover:bg-primary-600 text-white px-4 py-2 rounded-lg font-medium">
                    Analisar Combina√ß√µes
                </button>
                <button id="ver-resumo" class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg font-medium">
                    Ver Resumo Completo
                </button>
                <button id="carregar-dados-api" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium">
                    üì° Dados da API
                </button>

                <p class="w-full mt-2"><small>Selecione o "<strong>Tamanho do grupo</strong>" e depois em "<strong>Analisar Combina√ß√µes</strong>", ao clicar em "<strong>Ver Resumo Completo</strong>" , voc√™ ver√° as combina√ß√µes poss√≠vel para cada grupo. "<strong>Dados da API</strong>" carrega informa√ß√µes reais da Mega-Sena.</small></p>
            </div>
            
            <div class="mb-6">
                <div class="relative">
                    <input type="text" id="pesquisar" placeholder="Pesquisar combina√ß√µes..." 
                           class="w-full bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 pr-10 text-base">
                    <button id="limpar-pesquisa" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 hidden">
                        &times;
                    </button>
                </div>
                <div id="resultado-pesquisa" class="text-sm text-gray-600 dark:text-gray-400 mt-2 hidden"></div>
            </div>
            
            <div id="loading" class="hidden flex justify-center my-6">
                <div class="spinner w-8 h-8 border-4 border-primary border-t-transparent rounded-full"></div>
            </div>
            
            <div id="resultado-container" class="hidden">
                <div class="bg-primary-50 dark:bg-primary-900/30 border-l-4 border-primary p-4 mb-6 rounded">
                    <h2 class="text-lg font-semibold mb-2 text-primary">Informa√ß√µes de Jogos da Mega-Sena</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                        <div>
                            <span class="font-semibold">Total de combina√ß√µes:</span>
                            <div id="total-combinacoes" class="text-xl font-bold">0</div>
                        </div>
                        <div>
                            <span class="font-semibold">Combina√ß√µes v√°lidas:</span>
                            <div id="combinacoes-validas" class="text-xl font-bold text-primary">0</div>
                        </div>
                        <div>
                            <span class="font-semibold">Jogos poss√≠veis:</span>
                            <div id="jogos-possiveis" class="text-xl font-bold text-primary">0</div>
                        </div>
                        <div>
                            <span class="font-semibold">Cobertura total:</span>
                            <div id="cobertura-total" class="text-xl font-bold">0%</div>
                        </div>
                    </div>
                </div>
                
                <h2 id="resultado-titulo" class="text-xl font-semibold mb-4">Combina√ß√µes Analisadas</h2>
                
                <div id="combinacoes" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6"></div>
                
                <div class="flex justify-center gap-4 mb-2">
                    <button id="anterior" disabled class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-lg font-medium disabled:opacity-50">
                        Anterior
                    </button>
                    <button id="proximo" disabled class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-lg font-medium disabled:opacity-50">
                        Pr√≥ximo
                    </button>
                </div>
                <div id="pagina-info" class="text-center text-sm text-gray-600 dark:text-gray-400"></div>
            </div>
        </div>

        <!-- Se√ß√£o dos dados da API -->
        <div id="api-container" class="hidden bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-6">
            <div class="gradient-bg text-white p-4 rounded-lg mb-4">
                <h2 class="text-xl font-bold text-center">Dados Reais da Mega-Sena</h2>
            </div>
            
            <div id="api-loading" class="hidden flex justify-center my-6">
                <div class="spinner w-8 h-8 border-4 border-primary border-t-transparent rounded-full mr-3"></div>
                <p class="text-lg">Carregando dados da API da Caixa...</p>
            </div>

            <div id="api-content" class="hidden">
                <!-- √öltimo concurso -->
                <div class="bg-primary-50 dark:bg-primary-900/20 p-4 rounded-lg mb-4">
                    <h3 class="font-semibold text-lg mb-3 text-primary">√öltimo Concurso</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        <div>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span>Concurso:</span>
                                    <span id="api-numero" class="font-bold"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Data:</span>
                                    <span id="api-data" class="font-bold"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Acumulou:</span>
                                    <span id="api-acumulou" class="font-bold"></span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-medium mb-2">N√∫meros Sorteados:</h4>
                            <div id="api-numeros" class="flex flex-wrap gap-2">
                                <!-- N√∫meros ser√£o inseridos aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Premia√ß√£o -->
                <div id="api-premiacao" class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3 text-yellow-700 dark:text-yellow-300">Premia√ß√£o</h3>
                    <div id="api-premios" class="space-y-2">
                        <!-- Pr√™mios ser√£o inseridos aqui -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal para detalhes da combina√ß√£o -->
        <div id="modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
            <div class="modal-content bg-white dark:bg-gray-800 rounded-xl shadow-xl w-11/12 max-w-3xl max-h-[90vh] overflow-y-auto">
                <div class="bg-primary text-white p-4 rounded-t-xl flex justify-between items-center">
                    <h2 id="modal-title" class="text-xl font-bold">Detalhes da Combina√ß√£o</h2>
                    <button id="modal-close" class="text-3xl font-light">&times;</button>
                </div>
                <div id="modal-body" class="p-6">
                    <!-- Conte√∫do do modal ser√° preenchido dinamicamente -->
                </div>
            </div>
        </div>
        
        <!-- Modal para resumo completo -->
        <div id="resumo-modal-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
            <div class="resumo-modal-content bg-white dark:bg-gray-800 rounded-xl shadow-xl w-11/12 max-w-5xl max-h-[90vh] overflow-y-auto">
                <div class="bg-primary text-white p-4 rounded-t-xl flex justify-between items-center">
                    <h2 id="resumo-modal-title" class="text-xl font-bold">Resumo Completo por Grupos - Mega-Sena</h2>
                    <button id="resumo-modal-close" class="text-3xl font-light">&times;</button>
                </div>
                <div id="resumo-modal-body" class="p-6">
                    <div id="resumo-loading" class="flex justify-center my-6">
                        <div class="spinner w-8 h-8 border-4 border-primary border-t-transparent rounded-full"></div>
                        <p class="ml-3 text-lg">Gerando resumo completo...</p>
                    </div>
                    <div id="resumo-content" class="hidden">
                        <!-- Conte√∫do do resumo ser√° preenchido dinamicamente -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="container mx-auto px-4 py-4 text-center text-sm text-gray-600 dark:text-gray-400 mt-8">
        Mega-Sena - An√°lise de Combina√ß√µes - 2025 | Dados da Caixa Econ√¥mica Federal
    </footer>

    <script>
        // Detec√ß√£o de dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Vari√°veis globais para API
        let dadosMegaSena = null;

        // Fun√ß√µes matem√°ticas
        function factorial(n) {
            if (n === 0 || n === 1) return 1;
            let result = 1;
            for (let i = 2; i <= n; i++) {
                result *= i;
            }
            return result;
        }

        function comb(n, k) {
            // Combina√ß√£o: C(n,k) = n! / (k! * (n-k)!)
            if (k < 0 || k > n) return 0;
            if (k === 0 || k === n) return 1;
            
            // Otimiza√ß√£o para n√∫meros grandes
            let result = 1;
            for (let i = 1; i <= k; i++) {
                result *= (n - (k - i));
                result /= i;
            }
            return Math.round(result);
        }

        // Fun√ß√£o para gerar combina√ß√µes
        function gerarCombinacoes(conjunto, tamanho) {
            const combinacoes = [];
            
            function combinar(inicio, atual) {
                if (atual.length === tamanho) {
                    combinacoes.push([...atual]);
                    return;
                }
                
                for (let i = inicio; i < conjunto.length; i++) {
                    atual.push(conjunto[i]);
                    combinar(i + 1, atual);
                    atual.pop();
                }
            }
            
            combinar(0, []);
            return combinacoes;
        }

        // Analisar se uma combina√ß√£o pode formar jogos v√°lidos para Mega-Sena
        function analisarCombinacao(combinacao) {
            // Converter para array se for uma string
            if (typeof combinacao === 'string') {
                combinacao = combinacao.split(',').map(d => parseInt(d.trim()));
            }
            
            // Par√¢metros da Mega-Sena
            const limiteInferior = 1;
            const limiteSuperior = 60;
            const tamanhoJogo = 6;
            
            // Verificar quais n√∫meros podem ser formados com os d√≠gitos
            const numerosFormaveis = [];
            const setDigitos = new Set(combinacao);
            
            for (let i = limiteInferior; i <= limiteSuperior; i++) {
                let podeFormar = true;
                
                // Converter o n√∫mero para string
                const numStr = i.toString();
                
                // Verificar se todos os d√≠gitos est√£o na combina√ß√£o
                for (let d of numStr) {
                    if (!setDigitos.has(parseInt(d))) {
                        podeFormar = false;
                        break;
                    }
                }
                
                if (podeFormar) {
                    numerosFormaveis.push(i);
                }
            }
            
            // Calcular estat√≠sticas
            const totalNumerosFormaveis = numerosFormaveis.length;
            const ehValido = totalNumerosFormaveis >= tamanhoJogo;
            let jogosPossiveis = 0;
            
            if (ehValido) {
                jogosPossiveis = comb(totalNumerosFormaveis, tamanhoJogo);
            }
            
            // Total de jogos poss√≠veis na Mega-Sena (C(60,6))
            const totalJogosPossiveis = comb(limiteSuperior, tamanhoJogo);
            
            // Calcular porcentagem de cobertura
            const cobertura = jogosPossiveis / totalJogosPossiveis * 100;
            
            return {
                combinacao: combinacao,
                parametrosJogo: {
                    limiteInferior,
                    limiteSuperior,
                    tamanhoJogo
                },
                numerosFormaveis: numerosFormaveis,
                totalNumerosFormaveis: totalNumerosFormaveis,
                ehValido: ehValido,
                jogosPossiveis: jogosPossiveis,
                totalJogosPossiveis: totalJogosPossiveis,
                cobertura: cobertura
            };
        }

        // Analisar m√∫ltiplas combina√ß√µes
        function analisarTodasCombinacoes(combinacoes) {
            const resultados = [];
            
            for (const combinacao of combinacoes) {
                const resultado = analisarCombinacao(combinacao);
                resultados.push(resultado);
            }
            
            return resultados;
        }

        // Fun√ß√£o para carregar dados da API da Mega-Sena
        async function carregarDadosAPI() {
            const apiLoading = document.getElementById('api-loading');
            const apiContent = document.getElementById('api-content');
            const apiContainer = document.getElementById('api-container');
            
            apiContainer.classList.remove('hidden');
            apiLoading.classList.remove('hidden');
            apiContent.classList.add('hidden');
            
            try {
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                dadosMegaSena = await response.json();
                exibirDadosAPI();
                
                apiLoading.classList.add('hidden');
                apiContent.classList.remove('hidden');
                
            } catch (error) {
                console.error('Erro ao carregar dados da API:', error);
                apiLoading.classList.add('hidden');
                apiContent.innerHTML = `
                    <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg text-center">
                        <p class="text-red-600 dark:text-red-400">‚ùå Erro ao carregar dados da API da Caixa</p>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">Verifique sua conex√£o e tente novamente</p>
                    </div>
                `;
                apiContent.classList.remove('hidden');
            }
        }

        // Fun√ß√£o para exibir dados da API
        function exibirDadosAPI() {
            if (!dadosMegaSena) return;

            // Informa√ß√µes do concurso
            document.getElementById('api-numero').textContent = dadosMegaSena.numero;
            document.getElementById('api-data').textContent = dadosMegaSena.dataApuracao;
            document.getElementById('api-acumulou').textContent = dadosMegaSena.acumulado ? 'SIM' : 'N√ÉO';

            // N√∫meros sorteados
            const numerosContainer = document.getElementById('api-numeros');
            numerosContainer.innerHTML = '';
            dadosMegaSena.listaDezenas.forEach(numero => {
                const ball = document.createElement('span');
                ball.className = 'w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center font-bold text-sm';
                ball.textContent = numero;
                numerosContainer.appendChild(ball);
            });

            // Premia√ß√£o
            const premiosContainer = document.getElementById('api-premios');
            premiosContainer.innerHTML = '';
            
            dadosMegaSena.listaRateioPremio.forEach(premio => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center p-2 bg-white dark:bg-gray-700 rounded';
                div.innerHTML = `
                    <span class="font-medium">${premio.descricaoFaixa}</span>
                    <span class="font-bold">${premio.numeroDeGanhadores} ganhador(es)</span>
                    <span class="font-bold text-primary">${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(premio.valorPremio)}</span>
                `;
                premiosContainer.appendChild(div);
            });
        }

        // Elementos DOM
        const tamanhoSelect = document.getElementById('tamanho');
        const gerarBtn = document.getElementById('gerar');
        const verResumoBtn = document.getElementById('ver-resumo');
        const carregarDadosBtn = document.getElementById('carregar-dados-api');
        const loading = document.getElementById('loading');
        const resultadoContainer = document.getElementById('resultado-container');
        const totalCombinacoes = document.getElementById('total-combinacoes');
        const combinacoesValidas = document.getElementById('combinacoes-validas');
        const jogosPossiveis = document.getElementById('jogos-possiveis');
        const coberturaTotal = document.getElementById('cobertura-total');
        const resultadoTitulo = document.getElementById('resultado-titulo');
        const combinacoesContainer = document.getElementById('combinacoes');
        const anteriorBtn = document.getElementById('anterior');
        const proximoBtn = document.getElementById('proximo');
        const paginaInfo = document.getElementById('pagina-info');
        
        // Elementos de pesquisa
        const pesquisarInput = document.getElementById('pesquisar');
        const limparPesquisaBtn = document.getElementById('limpar-pesquisa');
        const resultadoPesquisa = document.getElementById('resultado-pesquisa');
        
        // Modal
        const modalOverlay = document.getElementById('modal-overlay');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const modalClose = document.getElementById('modal-close');
        
        // Modal de Resumo
        const resumoModalOverlay = document.getElementById('resumo-modal-overlay');
        const resumoModalTitle = document.getElementById('resumo-modal-title');
        const resumoModalBody = document.getElementById('resumo-modal-body');
        const resumoModalClose = document.getElementById('resumo-modal-close');
        const resumoLoading = document.getElementById('resumo-loading');
        const resumoContent = document.getElementById('resumo-content');

        // Vari√°veis de controle da interface
        let todasCombinacoes = [];
        let resultadosCombinacoes = [];
        let combinacoesFiltradas = [];
        let paginaAtual = 1;
        let pesquisaAtiva = false;
        const itensPorPagina = 12;
        
        // Cache para resultados do resumo
        let resumoCache = {};

        // Fun√ß√£o para mostrar o modal com detalhes da combina√ß√£o
        function mostrarDetalhesCombinacao(resultado) {
            modalTitle.textContent = `Detalhes: ${resultado.combinacao.join(',')}`;
            
            // Construir o conte√∫do do modal
            let conteudo = `
                <div class="space-y-6">
                    <div class="bg-primary-50 dark:bg-primary-900/30 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-2">Informa√ß√µes Gerais</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <div><span class="font-medium">Combina√ß√£o:</span> ${resultado.combinacao.join(',')}</div>
                            <div><span class="font-medium">Jogo:</span> Mega-Sena</div>
                            <div><span class="font-medium">Total de N√∫meros:</span> ${resultado.totalNumerosFormaveis}</div>
                            <div><span class="font-medium">Combina√ß√£o V√°lida:</span> 
                                <span class="${resultado.ehValido ? 'text-primary font-bold' : 'text-red-600 dark:text-red-400'}">
                                    ${resultado.ehValido ? 'Sim' : 'N√£o'}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-2">Estat√≠sticas de Jogos</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <div><span class="font-medium">Jogos Poss√≠veis:</span> ${resultado.jogosPossiveis.toLocaleString()}</div>
                            <div><span class="font-medium">Total de Jogos na Mega-Sena:</span> ${resultado.totalJogosPossiveis.toLocaleString()}</div>
                            <div><span class="font-medium">Cobertura:</span> ${resultado.cobertura.toFixed(8)}%</div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-3">N√∫meros Form√°veis (${resultado.totalNumerosFormaveis})</h3>
                        <div class="grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 gap-2 max-h-60 overflow-y-auto p-2">
            `;
            
            // Adicionar os n√∫meros form√°veis
            resultado.numerosFormaveis.forEach(num => {
                conteudo += `
                    <div class="bg-primary text-white rounded-lg p-2 text-center font-mono font-bold">
                        ${num}
                    </div>
                `;
            });
            
            conteudo += `
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-2">Requisitos para Jogo Completo</h3>
                        <p>Para formar um jogo completo na Mega-Sena, voc√™ precisa de pelo menos 
                           6 n√∫meros entre 1 e 60.</p>
                        <p class="mt-2">Esta combina√ß√£o ${resultado.ehValido ? 'atende' : 'n√£o atende'} aos requisitos m√≠nimos.</p>
                    </div>
                </div>
            `;
            
            modalBody.innerHTML = conteudo;
            modalOverlay.classList.remove('hidden');
        }

        // Fun√ß√£o para pesquisar combina√ß√µes
        function pesquisarCombinacoes(termo) {
            if (!termo.trim()) {
                // Se o termo de pesquisa estiver vazio, mostrar todas as combina√ß√µes
                pesquisaAtiva = false;
                combinacoesFiltradas = [...resultadosCombinacoes];
                paginaAtual = 1;
                resultadoPesquisa.classList.add('hidden');
                limparPesquisaBtn.classList.add('hidden');
                mostrarCombinacoes();
                return;
            }

            // Ativar a pesquisa
            pesquisaAtiva = true;
            limparPesquisaBtn.classList.remove('hidden');
            
            // Filtrar combina√ß√µes com base no termo
            combinacoesFiltradas = resultadosCombinacoes.filter(resultado => {
                const combStr = resultado.combinacao.join(',');
                return combStr.includes(termo);
            });
            
            // Atualizar a interface
            paginaAtual = 1;
            
            // Mostrar resultados
            resultadoPesquisa.classList.remove('hidden');
            resultadoPesquisa.textContent = `Encontradas ${combinacoesFiltradas.length} combina√ß√µes contendo "${termo}"`;
            
            mostrarCombinacoes();
        }

        // Fun√ß√£o para limpar a pesquisa
        function limparPesquisa() {
            pesquisarInput.value = '';
            pesquisaAtiva = false;
            combinacoesFiltradas = [...resultadosCombinacoes];
            paginaAtual = 1;
            resultadoPesquisa.classList.add('hidden');
            limparPesquisaBtn.classList.add('hidden');
            mostrarCombinacoes();
        }

        // Fun√ß√£o para mostrar as combina√ß√µes na interface
        function mostrarCombinacoes() {
            combinacoesContainer.innerHTML = '';
            
            // Usar a lista filtrada ou a lista completa
            const listaCombinacoes = pesquisaAtiva ? combinacoesFiltradas : resultadosCombinacoes;
            
            const inicio = (paginaAtual - 1) * itensPorPagina;
            const fim = Math.min(inicio + itensPorPagina, listaCombinacoes.length);
            
            for (let i = inicio; i < fim; i++) {
                const resultado = listaCombinacoes[i];
                const ehValido = resultado.ehValido;
                
                const card = document.createElement('div');
                card.classList.add('combination-card', 'bg-white', 'dark:bg-gray-800', 'rounded-xl', 'shadow-md', 'p-4', 'border');
                
                if (ehValido) {
                    card.classList.add('border-primary', 'dark:border-primary-700');
                } else {
                    card.classList.add('border-red-300', 'dark:border-red-700');
                }
                
                // Criar o conte√∫do do card
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="font-bold text-lg">${resultado.combinacao.join(',')}</h3>
                        <span class="px-2 py-1 rounded-full text-xs ${ehValido ? 'bg-primary-100 dark:bg-primary-900/40 text-primary-800 dark:text-primary-200' : 'bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-200'}">
                            ${ehValido ? 'V√°lida' : 'Inv√°lida'}
                        </span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>N√∫meros form√°veis:</span>
                            <span class="font-medium">${resultado.totalNumerosFormaveis}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Jogos poss√≠veis:</span>
                            <span class="font-medium">${ehValido ? resultado.jogosPossiveis.toLocaleString() : '0'}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Cobertura:</span>
                            <span class="font-medium">${resultado.cobertura.toFixed(6)}%</span>
                        </div>
                    </div>
                    <button class="ver-detalhes mt-3 w-full bg-primary bg-opacity-10 hover:bg-opacity-20 text-primary py-1 rounded-lg text-sm font-medium transition-all">
                        Ver Detalhes
                    </button>
                `;
                
                // Adicionar evento para mostrar detalhes
                const verDetalhesBtn = card.querySelector('.ver-detalhes');
                verDetalhesBtn.addEventListener('click', () => {
                    mostrarDetalhesCombinacao(resultado);
                });
                
                combinacoesContainer.appendChild(card);
            }
            
            // Atualizar informa√ß√µes de pagina√ß√£o
            const totalPaginas = Math.ceil(listaCombinacoes.length / itensPorPagina);
            paginaInfo.textContent = `P√°gina ${paginaAtual} de ${totalPaginas > 0 ? totalPaginas : 1}`;
            anteriorBtn.disabled = paginaAtual === 1;
            proximoBtn.disabled = paginaAtual === totalPaginas || listaCombinacoes.length === 0;
        }

        // Fun√ß√£o para atualizar as estat√≠sticas gerais
        function atualizarEstatisticasGerais() {
            // Contar combina√ß√µes v√°lidas
            const validas = resultadosCombinacoes.filter(r => r.ehValido);
            
            // Calcular total de jogos poss√≠veis
            let totalJogos = 0;
            let totalJogosPossiveis = 0;
            
            if (validas.length > 0) {
                totalJogos = validas.reduce((sum, r) => sum + r.jogosPossiveis, 0);
                totalJogosPossiveis = validas[0].totalJogosPossiveis;
            }
            
            // Calcular cobertura total
            const coberturaPercentual = totalJogosPossiveis > 0 ? 
                (totalJogos / totalJogosPossiveis) * 100 : 0;
            
            // Atualizar a interface
            totalCombinacoes.textContent = resultadosCombinacoes.length.toLocaleString();
            combinacoesValidas.textContent = validas.length.toLocaleString();
            jogosPossiveis.textContent = totalJogos.toLocaleString();
            coberturaTotal.textContent = coberturaPercentual.toFixed(8) + '%';
            
            return {
                tamanho: resultadosCombinacoes.length > 0 ? resultadosCombinacoes[0].combinacao.length : 0,
                total: resultadosCombinacoes.length,
                validas: validas.length,
                totalJogos: totalJogos,
                coberturaPercentual: coberturaPercentual
            };
        }
        
        // Fun√ß√£o para gerar e mostrar o resumo de todos os grupos
        async function gerarResumoCompleto() {
            // Mostrar o modal de resumo
            resumoModalOverlay.classList.remove('hidden');
            resumoLoading.classList.remove('hidden');
            resumoContent.classList.add('hidden');
            
            // Verificar se j√° temos os dados no cache
            if (resumoCache['mega-sena']) {
                // Usar os dados do cache
                mostrarConteudoResumo(resumoCache['mega-sena']);
                return;
            }
            
            // Array para armazenar os resultados
            const resultadosResumo = [];
            
            // Processar cada tamanho de grupo assincronamente
            for (let tamanho = 3; tamanho <= 10; tamanho++) {
                // Executar an√°lise em um timeout para n√£o travar a UI
                await new Promise(resolve => {
                    setTimeout(async () => {
                        try {
                            // Gerar combina√ß√µes
                            const digitos = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                            const combinacoes = gerarCombinacoes(digitos, tamanho);
                            
                            // Analisar combina√ß√µes
                            const resultados = analisarTodasCombinacoes(combinacoes);
                            
                            // Contar combina√ß√µes v√°lidas
                            const validas = resultados.filter(r => r.ehValido);
                            
                            // Calcular total de jogos poss√≠veis
                            let totalJogos = 0;
                            let totalJogosPossiveis = 0;
                            
                            if (validas.length > 0) {
                                totalJogos = validas.reduce((sum, r) => sum + r.jogosPossiveis, 0);
                                totalJogosPossiveis = validas[0].totalJogosPossiveis;
                            }
                            
                            // Calcular cobertura total
                            const coberturaPercentual = totalJogosPossiveis > 0 ? 
                                (totalJogos / totalJogosPossiveis) * 100 : 0;
                            
                            // Adicionar ao array de resultados
                            resultadosResumo.push({
                                tamanho,
                                total: combinacoes.length,
                                validas: validas.length,
                                totalJogos,
                                coberturaPercentual
                            });
                            
                            resolve();
                        } catch (error) {
                            console.error(`Erro ao analisar tamanho ${tamanho}:`, error);
                            resolve();
                        }
                    }, 0);
                });
            }
            
            // Ordenar por tamanho
            resultadosResumo.sort((a, b) => a.tamanho - b.tamanho);
            
            // Armazenar no cache
            resumoCache['mega-sena'] = resultadosResumo;
            
            // Mostrar os resultados
            mostrarConteudoResumo(resultadosResumo);
        }
        
        // Fun√ß√£o para mostrar o conte√∫do do resumo
        function mostrarConteudoResumo(resultados) {
            // Esconder o loading e mostrar o conte√∫do
            resumoLoading.classList.add('hidden');
            resumoContent.classList.remove('hidden');
            
            // Construir o conte√∫do HTML
            let html = `
                <h3 class="text-lg font-bold mb-4">Estat√≠sticas por Tamanho de Grupo - Mega-Sena</h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-primary text-white">
                                <th class="border border-primary-300 px-4 py-2">Tamanho</th>
                                <th class="border border-primary-300 px-4 py-2">Total Combina√ß√µes</th>
                                <th class="border border-primary-300 px-4 py-2">Combina√ß√µes V√°lidas</th>
                                <th class="border border-primary-300 px-4 py-2">Jogos Poss√≠veis</th>
                                <th class="border border-primary-300 px-4 py-2">Cobertura (%)</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Adicionar linhas para cada tamanho
            resultados.forEach(resultado => {
                const percentValidasClass = resultado.validas / resultado.total > 0.5 ? 
                    'text-primary' : 'text-red-600 dark:text-red-400';
                
                html += `
                    <tr class="hover:bg-primary-50 dark:hover:bg-primary-900/20">
                        <td class="border border-gray-300 dark:border-gray-600 px-4 py-2 text-center font-medium">${resultado.tamanho} d√≠gitos</td>
                        <td class="border border-gray-300 dark:border-gray-600 px-4 py-2 text-center">${resultado.total.toLocaleString()}</td>
                        <td class="border border-gray-300 dark:border-gray-600 px-4 py-2 text-center">
                            <span class="${percentValidasClass} font-medium">${resultado.validas.toLocaleString()}</span>
                            <span class="text-xs text-gray-500 dark:text-gray-400">(${Math.round(resultado.validas / resultado.total * 100)}%)</span>
                        </td>
                        <td class="border border-gray-300 dark:border-gray-600 px-4 py-2 text-center">${resultado.totalJogos.toLocaleString()}</td>
                        <td class="border border-gray-300 dark:border-gray-600 px-4 py-2 text-center font-medium">${resultado.coberturaPercentual.toFixed(8)}%</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-6 p-4 bg-primary-50 dark:bg-primary-900/30 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">An√°lise Comparativa - Mega-Sena</h3>
                    <p>O resumo acima mostra como a cobertura de jogos poss√≠veis varia de acordo com o tamanho do grupo de d√≠gitos para a Mega-Sena.</p>
                    <p class="mt-2">Observe que quanto maior o grupo, maior a cobertura, mas o n√∫mero de combina√ß√µes tamb√©m cresce significativamente.</p>
                    <p class="mt-2">Para a Mega-Sena, um equil√≠brio entre cobertura e quantidade de combina√ß√µes pode ser a estrat√©gia ideal.</p>
                </div>
                
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="p-4 bg-primary-100 dark:bg-primary-900/30 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3 text-primary">Melhor Cobertura</h3>
                        <div class="text-xl font-bold mb-2">${getMelhorCobertura(resultados).tamanho} d√≠gitos</div>
                        <p>Oferece a maior cobertura de jogos poss√≠veis (${getMelhorCobertura(resultados).coberturaPercentual.toFixed(8)}%).</p>
                    </div>
                    
                    <div class="p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3">Melhor Rela√ß√£o Cobertura/Combina√ß√µes</h3>
                        <div class="text-xl font-bold mb-2">${getMelhorRelacao(resultados).tamanho} d√≠gitos</div>
                        <p>Equil√≠brio entre quantidade de combina√ß√µes e cobertura de jogos.</p>
                    </div>
                </div>
            `;
            
            // Adicionar ao conte√∫do do modal
            resumoContent.innerHTML = html;
        }
        
        // Fun√ß√£o para encontrar o tamanho com melhor cobertura
        function getMelhorCobertura(resultados) {
            return resultados.reduce((melhor, atual) => 
                atual.coberturaPercentual > melhor.coberturaPercentual ? atual : melhor, 
                resultados[0]);
        }
        
        // Fun√ß√£o para encontrar o tamanho com melhor rela√ß√£o cobertura/combina√ß√µes
        function getMelhorRelacao(resultados) {
            return resultados.reduce((melhor, atual) => {
                const relacaoAtual = atual.coberturaPercentual / atual.total;
                const relacaoMelhor = melhor.coberturaPercentual / melhor.total;
                return relacaoAtual > relacaoMelhor ? atual : melhor;
            }, resultados[0]);
        }

        // Event listeners
        gerarBtn.addEventListener('click', async () => {
            const tamanho = parseInt(tamanhoSelect.value);
            
            // Mostrar loading
            loading.classList.remove('hidden');
            resultadoContainer.classList.add('hidden');
            
            // Resetar pesquisa
            limparPesquisa();
            
            // Executar an√°lise em um timeout para permitir que a UI atualize
            setTimeout(async () => {
                try {
                    // Gerar combina√ß√µes
                    const digitos = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                    todasCombinacoes = gerarCombinacoes(digitos, tamanho);
                    
                    // Analisar cada combina√ß√£o
                    resultadosCombinacoes = analisarTodasCombinacoes(todasCombinacoes);
                    combinacoesFiltradas = [...resultadosCombinacoes];
                    
                    // Resetar pagina√ß√£o
                    paginaAtual = 1;
                    
                    // Atualizar estat√≠sticas gerais
                    atualizarEstatisticasGerais();
                    
                    // Atualizar t√≠tulo
                    resultadoTitulo.textContent = `Combina√ß√µes com ${tamanho} d√≠gito(s) para Mega-Sena`;
                    
                    // Mostrar combina√ß√µes
                    mostrarCombinacoes();
                    
                    // Esconder loading e mostrar resultados
                    loading.classList.add('hidden');
                    resultadoContainer.classList.remove('hidden');
                } catch (error) {
                    console.error('Erro ao analisar combina√ß√µes:', error);
                    loading.classList.add('hidden');
                    // Criar modal customizado de erro
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center';
                    errorDiv.innerHTML = `
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-11/12 max-w-md mx-4">
                            <div class="bg-red-600 text-white p-4 rounded-t-xl">
                                <h2 class="text-xl font-bold">‚ö†Ô∏è Erro</h2>
                            </div>
                            <div class="p-6">
                                <p class="text-gray-700 dark:text-gray-300 mb-4">Ocorreu um erro ao analisar as combina√ß√µes. Por favor, tente novamente.</p>
                                <div class="flex justify-end">
                                    <button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg" onclick="this.closest('.fixed').remove()">
                                        OK
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(errorDiv);
                }
            }, 100);
        });

        // Event listener para o bot√£o de resumo
        verResumoBtn.addEventListener('click', gerarResumoCompleto);

        // Event listener para carregar dados da API
        carregarDadosBtn.addEventListener('click', carregarDadosAPI);

        // Event listeners para a funcionalidade de busca
        pesquisarInput.addEventListener('input', (e) => {
            pesquisarCombinacoes(e.target.value);
        });

        limparPesquisaBtn.addEventListener('click', limparPesquisa);

        // Event listeners para pagina√ß√£o
        anteriorBtn.addEventListener('click', () => {
            if (paginaAtual > 1) {
                paginaAtual--;
                mostrarCombinacoes();
            }
        });

        proximoBtn.addEventListener('click', () => {
            const listaCombinacoes = pesquisaAtiva ? combinacoesFiltradas : resultadosCombinacoes;
            if (paginaAtual < Math.ceil(listaCombinacoes.length / itensPorPagina)) {
                paginaAtual++;
                mostrarCombinacoes();
            }
        });

        // Fechar modal
        modalClose.addEventListener('click', () => {
            modalOverlay.classList.add('hidden');
        });

        // Clicar fora do modal para fechar
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.classList.add('hidden');
            }
        });

        // Fechar modal de resumo
        resumoModalClose.addEventListener('click', () => {
            resumoModalOverlay.classList.add('hidden');
        });

        // Clicar fora do modal de resumo para fechar
        resumoModalOverlay.addEventListener('click', (e) => {
            if (e.target === resumoModalOverlay) {
                resumoModalOverlay.classList.add('hidden');
            }
        });

        // Executar an√°lise inicial ap√≥s o carregamento da p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            // Executar uma an√°lise inicial com os valores padr√£o
            gerarBtn.click();
        });
    </script>
</body>
</html>