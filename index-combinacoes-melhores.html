<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking das Melhores Combina√ß√µes de D√≠gitos - Mega Sena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1B9A67',
                        'primary-light': '#22c383',
                        'primary-dark': '#178257'
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #1B9A67 0%, #178257 100%);
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .ranking-card {
            transition: all 0.3s ease;
        }
        .ranking-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        .medal-gold { background: linear-gradient(135deg, #FFD700, #FFA500); }
        .medal-silver { background: linear-gradient(135deg, #C0C0C0, #808080); }
        .medal-bronze { background: linear-gradient(135deg, #CD7F32, #8B4513); }
        .cache-info {
            background: linear-gradient(135deg, #d4f7e9 0%, #bef4de 100%);
            border-left: 4px solid #1B9A67;
        }
        .dark .cache-info {
            background: linear-gradient(135deg, #178257 0%, #136c49 100%);
            border-left-color: #22c383;
        }
        
        /* üé® SISTEMA DE CORES GRADUADO POR N√öMERO DE ACERTOS */
        .dezena-acertada {
            color: white !important;
            font-weight: bold !important;
            border: 2px solid !important;
            box-shadow: 0 0 12px !important;
            animation: pulseAcerto 1.5s infinite !important;
            transform: scale(1.08) !important;
            border-radius: 6px !important;
            padding: 4px 8px !important;
            margin: 0 2px !important;
            display: inline-block !important;
        }
        
        /* üèÜ 6 ACERTOS - DOURADO (SENA) */
        .acertos-6 .dezena-acertada {
            background: linear-gradient(135deg, #FFD700, #FFA500) !important;
            border-color: #FF8C00 !important;
            box-shadow: 0 0 16px rgba(255, 215, 0, 0.8) !important;
        }
        
        /* ü•á 5 ACERTOS - VERDE ESMERALDA (QUINA) */
        .acertos-5 .dezena-acertada {
            background: linear-gradient(135deg, #1B9A67, #178257) !important;
            border-color: #136c49 !important;
            box-shadow: 0 0 14px rgba(27, 154, 103, 0.7) !important;
        }
        
        /* ü•à 4 ACERTOS - AZUL ROYAL (QUADRA) */
        .acertos-4 .dezena-acertada {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
            border-color: #1e40af !important;
            box-shadow: 0 0 12px rgba(59, 130, 246, 0.6) !important;
        }
        
        /* ü•â 3 ACERTOS - LARANJA (REGULAR) */
        .acertos-3 .dezena-acertada {
            background: linear-gradient(135deg, #f59e0b, #d97706) !important;
            border-color: #b45309 !important;
            box-shadow: 0 0 12px rgba(245, 158, 11, 0.6) !important;
        }
        
        /* üî• 2 ACERTOS - ROSA/MAGENTA (FRACO) */
        .acertos-2 .dezena-acertada {
            background: linear-gradient(135deg, #ec4899, #db2777) !important;
            border-color: #be185d !important;
            box-shadow: 0 0 10px rgba(236, 72, 153, 0.5) !important;
        }
        
        /* üí´ 1 ACERTO - VERMELHO (M√çNIMO) */
        .acertos-1 .dezena-acertada {
            background: linear-gradient(135deg, #ef4444, #dc2626) !important;
            border-color: #b91c1c !important;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.4) !important;
        }
        
        .dezena-normal {
            background: #d4f7e9;
            color: #178257;
            transition: all 0.3s ease;
            border-radius: 6px;
            padding: 4px 8px;
            margin: 0 2px;
            display: inline-block;
            font-weight: 500;
        }
        
        .dark .dezena-normal {
            background: #178257;
            color: #bef4de;
        }
        
        @keyframes pulseAcerto {
            0%, 100% { 
                transform: scale(1.08);
            }
            50% { 
                transform: scale(1.12);
            }
        }
        
        /* üèÖ BADGES DE ACERTOS COM CORES CORRESPONDENTES */
        .badge-acertos-6 { background: linear-gradient(135deg, #FFD700, #FFA500); }
        .badge-acertos-5 { background: linear-gradient(135deg, #1B9A67, #178257); }
        .badge-acertos-4 { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .badge-acertos-3 { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .badge-acertos-2 { background: linear-gradient(135deg, #ec4899, #db2777); }
        .badge-acertos-1 { background: linear-gradient(135deg, #ef4444, #dc2626); }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <!-- Detec√ß√£o de tema escuro -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <!-- Header -->
    <div class="gradient-bg text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">üçÄ Combina√ß√µes (Melhores)</h1>
            <h2 class="text-2xl md:text-3xl font-semibold mb-6">D√≠gitos Mais Utilizados - Mega Sena</h2>
            <p class="text-lg opacity-90 max-w-3xl mx-auto">
                An√°lise completa das combina√ß√µes de d√≠gitos mais frequentes nos sorteios hist√≥ricos e quantos jogos s√£o poss√≠veis com cada combina√ß√£o
            </p>
        </div>
    </div>

    <!-- Info do Cache -->
    <div id="cache-info" class="container mx-auto px-4 py-4 hidden">
        <div class="cache-info rounded-lg p-4 text-sm">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-lg">üíæ</span>
                <span class="font-semibold">Sistema de Cache em Mem√≥ria</span>
            </div>
            <div id="cache-details" class="text-gray-700 dark:text-gray-300">
                Cache otimizado para acelerar consultas durante esta sess√£o. Dados s√£o mantidos em mem√≥ria para evitar recarregamentos desnecess√°rios.
            </div>
        </div>
    </div>

    <!-- Loading / Status -->
    <div id="loading-section" class="container mx-auto px-4 py-8">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 text-center">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent mb-4"></div>
            <h3 class="text-xl font-semibold mb-2">Analisando Dados Hist√≥ricos...</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4" id="loading-status">Conectando com a API da Caixa...</p>
            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                <div id="progress-bar" class="bg-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p class="text-sm text-gray-500 dark:text-gray-500 mt-2" id="progress-text">0%</p>
        </div>
    </div>

    <!-- Resumo Geral -->
    <div id="summary-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üìä Resumo da An√°lise</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-primary" id="total-concursos">-</div>
                    <div class="text-sm text-primary-dark dark:text-primary-light">Concursos Analisados</div>
                </div>
                
                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-primary" id="total-combinacoes-unicas">-</div>
                    <div class="text-sm text-primary-dark dark:text-primary-light">Combina√ß√µes √önicas</div>
                </div>
                
                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-primary" id="combinacao-mais-frequente">-</div>
                    <div class="text-sm text-primary-dark dark:text-primary-light">Mais Frequente</div>
                </div>
                
                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                    <div class="text-3xl font-bold text-primary" id="maior-potencial-jogos">-</div>
                    <div class="text-sm text-primary-dark dark:text-primary-light">Maior Potencial</div>
                </div>
            </div>
            
            <!-- Informa√ß√µes sobre range de concursos -->
            <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-primary-light dark:border-primary">
                <h4 class="font-semibold text-primary-dark dark:text-primary-light mb-3 text-center">üìã Range de Concursos Analisados</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                    <div>
                        <div class="text-lg font-bold text-primary" id="primeiro-concurso">-</div>
                        <div class="text-xs text-primary-dark dark:text-primary-light">Primeiro Concurso</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-primary" id="ultimo-concurso">-</div>
                        <div class="text-xs text-primary-dark dark:text-primary-light">√öltimo Concurso</div>
                    </div>
                    <div>
                        <div class="text-lg font-bold text-primary" id="range-concursos">-</div>
                        <div class="text-xs text-primary-dark dark:text-primary-light">Range Completo</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Filtros -->
    <div id="filters-section" class="container mx-auto px-4 py-4 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-lg font-semibold mb-4">üîç Filtros de An√°lise</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-medium mb-2">Quantidade de D√≠gitos:</label>
                    <select id="filter-qtd-digitos" class="w-full border dark:border-gray-700 rounded-md px-3 py-2 text-base focus:outline-none focus:ring-1 focus:ring-primary dark:bg-gray-700">
                        <option value="">Todas</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Frequ√™ncia M√≠nima:</label>
                    <input type="number" id="filter-freq-min" placeholder="Ex: 5" min="1" 
                        class="w-full border dark:border-gray-700 rounded-md px-3 py-2 text-base focus:outline-none focus:ring-1 focus:ring-primary dark:bg-gray-700">
                </div>
                
                <div>
                    <label class="block text-sm font-medium mb-2">Jogos M√≠nimos:</label>
                    <input type="number" id="filter-jogos-min" placeholder="Ex: 1000" min="1" 
                        class="w-full border dark:border-gray-700 rounded-md px-3 py-2 text-base focus:outline-none focus:ring-1 focus:ring-primary dark:bg-gray-700">
                </div>
                
                <div class="flex items-end">
                    <button id="apply-filters" class="w-full bg-primary hover:bg-primary-dark text-white py-2 px-4 rounded-md font-bold text-sm">
                        Aplicar Filtros
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Top 3 Destaque -->
    <div id="top3-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">ü•á Top 3 Combina√ß√µes Mais Utilizadas</h3>
            
            <div id="top3-container" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Ser√° preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Gr√°ficos -->
    <div id="charts-section" class="container mx-auto px-4 py-8 hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Gr√°fico de Frequ√™ncia -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-center">üìà Frequ√™ncia das Combina√ß√µes</h3>
                <div class="h-64">
                    <canvas id="frequencyChart"></canvas>
                </div>
            </div>
            
            <!-- Gr√°fico de Potencial de Jogos -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-center">üéØ Potencial de Jogos</h3>
                <div class="h-64">
                    <canvas id="jogosChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Ranking Completo -->
    <div id="ranking-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">üìã Ranking Completo das Combina√ß√µes</h3>
                <div class="flex items-center gap-4">
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Mostrando <span id="total-showing" class="font-bold text-primary">0</span> combina√ß√µes
                    </div>
                    <button 
                        id="toggleRankingCompleto" 
                        class="flex items-center px-4 py-2 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors duration-200"
                        onclick="toggleRankingCompletoSection()"
                    >
                        <span id="toggleRankingIcon">üëÅÔ∏è</span>
                        <span id="toggleRankingText" class="ml-2">Ocultar</span>
                    </button>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead class="bg-gray-100 dark:bg-gray-700">
                        <tr>
                            <th class="py-3 px-4 text-left text-sm font-semibold">Posi√ß√£o</th>
                            <th class="py-3 px-4 text-left text-sm font-semibold">Combina√ß√£o de D√≠gitos</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">Qtd. D√≠gitos</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">Frequ√™ncia</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">Intervalo M√©dio</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">N√∫meros V√°lidos</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">Jogos Poss√≠veis</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">Efici√™ncia</th>
                            <th class="py-3 px-4 text-center text-sm font-semibold">A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="ranking-table-body">
                        <!-- Ser√° preenchido dinamicamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Se√ß√£o de Jogos Recomendados -->
    <div id="jogos-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold mb-4">üé≤ Jogos Recomendados</h3>
                <p class="text-gray-600 dark:text-gray-400 mb-4">
                    120 jogos gerados com base nas combina√ß√µes de d√≠gitos mais frequentes
                </p>
                
                <!-- Bot√µes de Download -->
                <div class="flex flex-wrap justify-center gap-4 mb-6">
                    <button id="download-jogos-html" class="bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Download HTML
                    </button>
                    
                    <button id="download-jogos-txt" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Download TXT
                    </button>
                    
                    <button id="download-jogos-xlsx" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Download XLSX
                    </button>
                </div>
                
                <!-- Informa√ß√µes sobre a gera√ß√£o -->
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-primary-light dark:border-primary mb-6">
                    <h4 class="font-semibold text-primary-dark dark:text-primary-light mb-2">üìã Informa√ß√µes da Gera√ß√£o</h4>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                        <div class="text-center">
                            <div class="font-bold text-primary" id="jogos-baseados-em">-</div>
                            <div class="text-primary-dark dark:text-primary-light">Combina√ß√µes Utilizadas</div>
                        </div>
                        <div class="text-center">
                            <div class="font-bold text-primary">120</div>
                            <div class="text-primary-dark dark:text-primary-light">Jogos Gerados</div>
                        </div>
                        <div class="text-center">
                            <div class="font-bold text-primary" id="total-numeros-utilizados">-</div>
                            <div class="text-primary-dark dark:text-primary-light">N√∫meros Utilizados</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- üü¢ SE√á√ÉO DE VERIFICA√á√ÉO COM DESTAQUE VERDE VIBRANTE -->
            <div class="mb-8">
                <h4 class="font-semibold mb-4">üîç Verifica√ß√£o de Acertos - Destaque VERDE das Dezenas</h4>
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6 border">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Dezenas Sorteadas (separadas por espa√ßo):</label>
                            <input type="text" id="dezenas-sorteadas" placeholder="Ex: 01 15 23 32 45 60" 
                                class="w-full border dark:border-gray-600 rounded-md px-3 py-2 text-base focus:outline-none focus:ring-1 focus:ring-primary dark:bg-gray-600">
                            <div class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                                <span id="contador-numeros">0/6 n√∫meros</span> | 
                                <span id="contador-jogos-destacados">0 jogos destacados</span>
                            </div>
                        </div>
                        
                        <div class="flex items-end">
                            <button id="verificar-acertos" class="w-full bg-primary hover:bg-primary-dark text-white py-2 px-4 rounded-md font-bold text-sm">
                                üéØ Verificar Acertos
                            </button>
                        </div>
                    </div>
                    
                    <!-- Resultados da verifica√ß√£o -->
                    <div id="resultado-verificacao" class="hidden mt-4 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-primary-light dark:border-primary">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- Todos os 120 Jogos -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="font-semibold">üé≤ Todos os 120 Jogos Gerados</h4>
                    <div class="flex gap-2">
                        <button id="toggle-jogos-view" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded text-sm">
                            üìã Visualiza√ß√£o Compacta
                        </button>
                        <button id="limpar-filtros" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm">
                            üóëÔ∏è Limpar Filtros
                        </button>
                    </div>
                </div>
                
                <!-- Filtros de visualiza√ß√£o -->
                <div class="mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Ordenar por:</label>
                            <select id="ordenacao" class="w-full border dark:border-gray-600 rounded-md px-3 py-2 text-base focus:outline-none focus:ring-1 focus:ring-primary dark:bg-gray-600">
                                <option value="numero">N√∫mero do Jogo</option>
                                <option value="acertos">Maior Acerto</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Jogos por p√°gina:</label>
                            <select id="jogos-por-pagina" class="w-full border dark:border-gray-600 rounded-md px-3 py-2 text-base focus:outline-none focus:ring-1 focus:ring-primary dark:bg-gray-600">
                                <option value="20">20 jogos</option>
                                <option value="40">40 jogos</option>
                                <option value="60">60 jogos</option>
                                <option value="120">Todos (120)</option>
                            </select>
                        </div>
                        
                        <div class="flex items-end">
                            <button id="aplicar-filtros-jogos" class="w-full bg-primary hover:bg-primary-dark text-white py-2 px-4 rounded-md font-bold text-sm">
                                Aplicar Filtros
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Lista de jogos -->
                <div id="lista-jogos" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
                
                <!-- Pagina√ß√£o -->
                <div id="paginacao" class="flex justify-center items-center mt-6 gap-2">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes -->
    <div id="details-modal" class="fixed inset-0 z-50 hidden bg-black bg-opacity-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold" id="modal-title">Detalhes da Combina√ß√£o</h3>
                    <button id="close-modal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div id="modal-content">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let todosResultados = [];
        let rankingCombinacoes = [];
        let rankingFiltrado = [];
        let jogosGerados = [];
        
        // Cache em mem√≥ria para sess√£o atual
        let cacheMemoria = {
            concursos: new Map(),
            ultimoConcursoCarregado: 0,
            dataUltimaConsulta: null
        };
        
        // Vari√°veis para controle da visualiza√ß√£o dos jogos
        let jogosFiltrados = [];
        let paginaAtual = 1;
        let jogosPorPagina = 20;
        let viewCompacta = false;
        let ultimaVerificacao = null;
        
        // Elementos do DOM
        const loadingSection = document.getElementById('loading-section');
        const summarySection = document.getElementById('summary-section');
        const filtersSection = document.getElementById('filters-section');
        const top3Section = document.getElementById('top3-section');
        const chartsSection = document.getElementById('charts-section');
        const rankingSection = document.getElementById('ranking-section');
        
        // Fun√ß√£o para atualizar status do loading
        function updateLoadingStatus(text, percent) {
            document.getElementById('loading-status').textContent = text;
            document.getElementById('progress-bar').style.width = `${percent}%`;
            document.getElementById('progress-text').textContent = `${Math.round(percent)}%`;
        }

        // Fun√ß√£o para exibir informa√ß√µes do cache
        function exibirInfoCache() {
            const cacheInfo = document.getElementById('cache-info');
            const cacheDetails = document.getElementById('cache-details');
            
            if (cacheMemoria.concursos.size > 0) {
                cacheDetails.textContent = `${cacheMemoria.concursos.size} concursos em cache de mem√≥ria. Cache ativo durante esta sess√£o para otimizar performance.`;
                cacheInfo.classList.remove('hidden');
            }
        }
        
        // üõ°Ô∏è FUN√á√ÉO ROBUSTA PARA BUSCAR DADOS COM RETRY E FALLBACK
        async function buscarDadosCaixa() {
            try {
                updateLoadingStatus("Conectando com a API da Caixa...", 5);
                
                // Verificar se j√° temos dados em cache
                if (cacheMemoria.concursos.size > 0) {
                    updateLoadingStatus(`Cache em mem√≥ria encontrado: ${cacheMemoria.concursos.size} concursos`, 10);
                    exibirInfoCache();
                }
                
                // üîÑ BUSCAR √öLTIMO CONCURSO COM RETRY AUTOM√ÅTICO
                let ultimoConcurso = null;
                for (let tentativa = 1; tentativa <= 3; tentativa++) {
                    try {
                        updateLoadingStatus(`Conectando com API da Caixa (tentativa ${tentativa}/3)...`, 5 + tentativa * 2);
                        
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 segundos timeout
                        
                        const ultimoConcursoResponse = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena/', {
                            signal: controller.signal,
                            mode: 'cors',
                            cache: 'no-cache'
                        });
                        
                        clearTimeout(timeoutId);
                        
                        if (!ultimoConcursoResponse.ok) {
                            throw new Error(`HTTP ${ultimoConcursoResponse.status}`);
                        }
                        
                        ultimoConcurso = await ultimoConcursoResponse.json();
                        break; // Sucesso, sair do loop
                        
                    } catch (error) {
                        console.warn(`Tentativa ${tentativa} falhou:`, error.message);
                        
                        if (tentativa === 3) {
                            // √öltima tentativa falhou, verificar se temos cache
                            if (cacheMemoria.concursos.size > 0) {
                                updateLoadingStatus("API indispon√≠vel. Usando dados do cache...", 50);
                                
                                todosResultados = Array.from(cacheMemoria.concursos.values())
                                    .sort((a, b) => a.numero - b.numero);
                                analisarCombinacoes();
                                updateLoadingStatus(`Dados do cache carregados! ${todosResultados.length} concursos (offline).`, 100);
                                
                                setTimeout(() => {
                                    loadingSection.classList.add('hidden');
                                    exibirResultados();
                                }, 1000);
                                return;
                            } else {
                                // Sem cache, usar dados de exemplo
                                return usarDadosExemplo();
                            }
                        }
                        
                        // Aguardar antes da pr√≥xima tentativa
                        await new Promise(resolve => setTimeout(resolve, 1000 * tentativa));
                    }
                }
                
                if (!ultimoConcurso || !ultimoConcurso.numero) {
                    throw new Error('N√£o foi poss√≠vel obter informa√ß√µes do √∫ltimo concurso');
                }

                const numeroUltimoConcurso = ultimoConcurso.numero;
                const novosParaBuscar = numeroUltimoConcurso - cacheMemoria.ultimoConcursoCarregado;
                
                // Se cache est√° atualizado, usar dados em mem√≥ria
                if (novosParaBuscar === 0 && cacheMemoria.concursos.size > 0) {
                    updateLoadingStatus("Cache atualizado! Carregando dados em mem√≥ria...", 90);
                    
                    todosResultados = Array.from(cacheMemoria.concursos.values())
                        .sort((a, b) => a.numero - b.numero);
                    
                    analisarCombinacoes();
                    updateLoadingStatus(`Carregamento conclu√≠do! ${todosResultados.length} concursos do cache.`, 100);
                    
                    setTimeout(() => {
                        loadingSection.classList.add('hidden');
                        exibirResultados();
                    }, 1000);
                    return;
                }
                
                updateLoadingStatus(`${novosParaBuscar > 0 ? `${novosParaBuscar} novos concursos encontrados` : `Buscando ${numeroUltimoConcurso} concursos`}. Iniciando download...`, 15);

                const concursosFalharam = [];
                
                // Definir range de concursos para buscar
                const iniciarBusca = cacheMemoria.ultimoConcursoCarregado + 1;
                const totalParaBuscar = numeroUltimoConcurso - iniciarBusca + 1;
                
                if (totalParaBuscar > 0) {
                    updateLoadingStatus(`Buscando concursos ${iniciarBusca} a ${numeroUltimoConcurso}...`, 20);
                    
                    // Primeira tentativa - buscar novos concursos
                    for (let concurso = iniciarBusca; concurso <= numeroUltimoConcurso; concurso++) {
                        const progressoConcurso = concurso - iniciarBusca + 1;
                        const progressPercent = 20 + ((progressoConcurso / totalParaBuscar) * 50);
                        
                        if (progressoConcurso % 50 === 0 || concurso === numeroUltimoConcurso) {
                            updateLoadingStatus(`Baixando concurso ${concurso} de ${numeroUltimoConcurso} (${progressoConcurso}/${totalParaBuscar} novos)...`, progressPercent);
                        }
                        
                        try {
                            const resultado = await buscarConcursoEspecifico(concurso);
                            if (resultado) {
                                cacheMemoria.concursos.set(concurso, resultado);
                            } else {
                                concursosFalharam.push(concurso);
                            }
                        } catch (error) {
                            concursosFalharam.push(concurso);
                        }
                        
                        // Pequena pausa a cada 10 concursos para n√£o sobrecarregar a API
                        if (concurso % 10 === 0) {
                            await new Promise(resolve => setTimeout(resolve, 50));
                        }
                    }

                    // Segunda tentativa - retry para concursos que falharam
                    if (concursosFalharam.length > 0) {
                        updateLoadingStatus(`Retry: tentando novamente ${concursosFalharam.length} concursos que falharam...`, 75);
                        
                        for (let i = 0; i < concursosFalharam.length; i++) {
                            const concurso = concursosFalharam[i];
                            const progressPercent = 75 + ((i / concursosFalharam.length) * 10);
                            
                            updateLoadingStatus(`Retry concurso ${concurso} (${i + 1}/${concursosFalharam.length})...`, progressPercent);
                            
                            try {
                                const resultado = await buscarConcursoEspecifico(concurso);
                                if (resultado) {
                                    cacheMemoria.concursos.set(concurso, resultado);
                                }
                            } catch (error) {
                                console.warn(`Concurso ${concurso} falhou mesmo no retry:`, error);
                            }
                            
                            await new Promise(resolve => setTimeout(resolve, 100));
                        }
                    }
                    
                    // Atualizar cache metadata
                    cacheMemoria.ultimoConcursoCarregado = numeroUltimoConcurso;
                    cacheMemoria.dataUltimaConsulta = new Date().toISOString();
                }

                // Converter cache para array
                todosResultados = Array.from(cacheMemoria.concursos.values())
                    .sort((a, b) => a.numero - b.numero);

                const concursosObtidos = todosResultados.length;
                const concursosPerdidos = numeroUltimoConcurso - concursosObtidos;
                
                updateLoadingStatus(`Obtidos ${concursosObtidos}/${numeroUltimoConcurso} concursos total. Analisando...`, 85);
                
                if (concursosPerdidos > 0) {
                    console.warn(`Aten√ß√£o: ${concursosPerdidos} concursos n√£o puderam ser obtidos da API`);
                }

                updateLoadingStatus("Atualizando cache em mem√≥ria...", 88);
                exibirInfoCache();
                
                updateLoadingStatus(`Analisando ${todosResultados.length} concursos v√°lidos...`, 90);
                analisarCombinacoes();
                
                const statusFinal = novosParaBuscar > 0 ? 
                    `Cache atualizado! ${novosParaBuscar} novos concursos adicionados. Total: ${todosResultados.length} concursos.` :
                    `Carregamento conclu√≠do! ${todosResultados.length} concursos analisados.`;
                
                updateLoadingStatus(statusFinal, 100);
                
                // Exibir resultados
                setTimeout(() => {
                    loadingSection.classList.add('hidden');
                    exibirResultados();
                }, 1000);

            } catch (error) {
                console.error('Erro ao buscar dados:', error);
                updateLoadingStatus(`Erro: ${error.message}`, 0);
                
                // Em caso de erro, tentar usar cache mesmo que desatualizado
                if (cacheMemoria.concursos.size > 0) {
                    console.warn('Erro na API, usando dados do cache em mem√≥ria...');
                    updateLoadingStatus(`Erro na API, carregando ${cacheMemoria.concursos.size} concursos do cache...`, 50);
                    
                    todosResultados = Array.from(cacheMemoria.concursos.values())
                        .sort((a, b) => a.numero - b.numero);
                    analisarCombinacoes();
                    updateLoadingStatus(`Dados do cache carregados! ${todosResultados.length} concursos (pode estar desatualizado).`, 100);
                    
                    setTimeout(() => {
                        loadingSection.classList.add('hidden');
                        exibirResultados();
                    }, 1000);
                }
            }
        }

        // Fun√ß√£o para buscar um concurso espec√≠fico com retry autom√°tico
        async function buscarConcursoEspecifico(numero, tentativas = 3) {
            for (let tentativa = 1; tentativa <= tentativas; tentativa++) {
                try {
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena/${numero}`);
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            // Concurso n√£o existe
                            return null;
                        }
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const dados = await response.json();
                    
                    // Validar se os dados est√£o completos
                    if (dados && 
                        dados.numero && 
                        dados.listaDezenas && 
                        Array.isArray(dados.listaDezenas) && 
                        dados.listaDezenas.length === 6) {
                        
                        return {
                            numero: parseInt(dados.numero),
                            data: dados.dataApuracao || '',
                            dezenas: dados.listaDezenas.map(n => parseInt(n))
                        };
                    }
                    
                    // Se chegou aqui, os dados est√£o incompletos
                    if (tentativa < tentativas) {
                        await new Promise(resolve => setTimeout(resolve, 200 * tentativa)); // Delay progressivo
                        continue;
                    }
                    
                    return null;
                    
                } catch (error) {
                    if (tentativa < tentativas) {
                        await new Promise(resolve => setTimeout(resolve, 500 * tentativa)); // Delay progressivo maior para erros
                        continue;
                    }
                    
                    // Falhou em todas as tentativas
                    console.error(`Concurso ${numero}: falhou ap√≥s ${tentativas} tentativas:`, error.message);
                    return null;
                }
            }
            
            return null;
        }

        // Fun√ß√£o para analisar as combina√ß√µes de d√≠gitos
        function analisarCombinacoes() {
            const combinacoes = {};
            
            todosResultados.forEach(concurso => {
                // Extrair d√≠gitos √∫nicos das dezenas
                const digitosUnicos = new Set();
                concurso.dezenas.forEach(dezena => {
                    const dezenaStr = dezena.toString().padStart(2, '0');
                    dezenaStr.split('').forEach(digito => digitosUnicos.add(parseInt(digito)));
                });
                
                const digitosArray = Array.from(digitosUnicos).sort((a, b) => a - b);
                const chave = digitosArray.join(',');
                
                if (!combinacoes[chave]) {
                    combinacoes[chave] = {
                        digitos: digitosArray,
                        chave: chave,
                        frequencia: 0,
                        concursos: [],
                        numerosValidos: calcularNumerosValidos(digitosArray),
                        jogosPossiveis: 0
                    };
                }
                
                combinacoes[chave].frequencia++;
                combinacoes[chave].concursos.push(concurso.numero);
            });
            
            // Calcular jogos poss√≠veis e intervalos para cada combina√ß√£o
            Object.values(combinacoes).forEach(combo => {
                combo.jogosPossiveis = calcularJogosPossiveis(combo.numerosValidos.length);
                combo.eficiencia = combo.jogosPossiveis > 0 ? (combo.frequencia / combo.jogosPossiveis * 1000000).toFixed(2) : 0;
                
                // Calcular intervalos entre concursos
                const intervalos = calcularIntervalos(combo.concursos);
                combo.intervalos = intervalos;
                combo.intervaloMedio = intervalos.length > 0 ? Math.round(intervalos.reduce((a, b) => a + b, 0) / intervalos.length) : 0;
                combo.intervaloMinimo = intervalos.length > 0 ? Math.min(...intervalos) : 0;
                combo.intervaloMaximo = intervalos.length > 0 ? Math.max(...intervalos) : 0;
            });
            
            // Ordenar por frequ√™ncia (decrescente)
            rankingCombinacoes = Object.values(combinacoes)
                .sort((a, b) => b.frequencia - a.frequencia);
                
            rankingFiltrado = [...rankingCombinacoes];
        }

        // Fun√ß√£o para calcular n√∫meros v√°lidos que podem ser formados com os d√≠gitos
        function calcularNumerosValidos(digitos) {
            const numerosValidos = [];
            
            for (let i = 1; i <= 60; i++) {
                const numStr = i.toString().padStart(2, '0');
                const digitosDoNumero = numStr.split('').map(d => parseInt(d));
                
                if (digitosDoNumero.every(d => digitos.includes(d))) {
                    numerosValidos.push(i);
                }
            }
            
            return numerosValidos;
        }

        // Fun√ß√£o para calcular quantos jogos s√£o poss√≠veis (C(n,6))
        function calcularJogosPossiveis(totalNumeros) {
            if (totalNumeros < 6) return 0;
            
            // F√≥rmula de combina√ß√£o C(n,6) = n! / (6! * (n-6)!)
            function factorial(n) {
                if (n <= 1) return 1;
                return n * factorial(n - 1);
            }
            
            function combination(n, r) {
                if (r > n) return 0;
                return factorial(n) / (factorial(r) * factorial(n - r));
            }
            
            return combination(totalNumeros, 6);
        }

        // Fun√ß√£o para calcular intervalos entre concursos
        function calcularIntervalos(concursos) {
            if (concursos.length < 2) return [];
            
            const intervalos = [];
            for (let i = 1; i < concursos.length; i++) {
                intervalos.push(concursos[i] - concursos[i - 1]);
            }
            
            return intervalos;
        }

        // Fun√ß√£o para exibir todos os resultados
        function exibirResultados() {
            exibirResumoGeral();
            criarFiltros();
            exibirTop3();
            criarGraficos();
            exibirRankingCompleto();
            gerarJogosRecomendados();
            
            // Mostrar todas as se√ß√µes
            summarySection.classList.remove('hidden');
            filtersSection.classList.remove('hidden');
            top3Section.classList.remove('hidden');
            chartsSection.classList.remove('hidden');
            rankingSection.classList.remove('hidden');
            document.getElementById('jogos-section').classList.remove('hidden');
        }

        // Fun√ß√£o para exibir resumo geral
        function exibirResumoGeral() {
            document.getElementById('total-concursos').textContent = todosResultados.length.toLocaleString('pt-BR');
            document.getElementById('total-combinacoes-unicas').textContent = rankingCombinacoes.length.toLocaleString('pt-BR');
            
            if (rankingCombinacoes.length > 0) {
                document.getElementById('combinacao-mais-frequente').textContent = 
                    `${rankingCombinacoes[0].digitos.join(',')} (${rankingCombinacoes[0].frequencia}x)`;
                
                const maiorPotencial = rankingCombinacoes.reduce((max, combo) => 
                    combo.jogosPossiveis > max.jogosPossiveis ? combo : max
                );
                document.getElementById('maior-potencial-jogos').textContent = 
                    maiorPotencial.jogosPossiveis.toLocaleString('pt-BR');
            }
            
            // Exibir informa√ß√µes sobre range de concursos
            if (todosResultados.length > 0) {
                // Ordenar resultados por n√∫mero do concurso para encontrar o primeiro e √∫ltimo
                const resultadosOrdenados = [...todosResultados].sort((a, b) => a.numero - b.numero);
                const primeiroConcurso = resultadosOrdenados[0].numero;
                const ultimoConcurso = resultadosOrdenados[resultadosOrdenados.length - 1].numero;
                
                document.getElementById('primeiro-concurso').textContent = primeiroConcurso;
                document.getElementById('ultimo-concurso').textContent = ultimoConcurso;
                document.getElementById('range-concursos').textContent = `${primeiroConcurso} ‚Üí ${ultimoConcurso}`;
            }
        }

        // Fun√ß√£o para criar filtros
        function criarFiltros() {
            const filterQtdDigitos = document.getElementById('filter-qtd-digitos');
            
            // Obter quantidades √∫nicas de d√≠gitos
            const qtdDigitos = [...new Set(rankingCombinacoes.map(c => c.digitos.length))].sort((a, b) => a - b);
            
            qtdDigitos.forEach(qtd => {
                const option = document.createElement('option');
                option.value = qtd;
                option.textContent = `${qtd} d√≠gitos`;
                filterQtdDigitos.appendChild(option);
            });
            
            // Event listener para aplicar filtros
            document.getElementById('apply-filters').addEventListener('click', aplicarFiltros);
        }

        // Fun√ß√£o para aplicar filtros
        function aplicarFiltros() {
            const qtdDigitos = document.getElementById('filter-qtd-digitos').value;
            const freqMin = parseInt(document.getElementById('filter-freq-min').value) || 0;
            const jogosMin = parseInt(document.getElementById('filter-jogos-min').value) || 0;
            
            rankingFiltrado = rankingCombinacoes.filter(combo => {
                if (qtdDigitos && combo.digitos.length != qtdDigitos) return false;
                if (combo.frequencia < freqMin) return false;
                if (combo.jogosPossiveis < jogosMin) return false;
                return true;
            });
            
            // Atualizar exibi√ß√µes
            exibirTop3();
            exibirRankingCompleto();
            criarGraficos();
        }

        // Fun√ß√£o para exibir Top 3
        function exibirTop3() {
            const container = document.getElementById('top3-container');
            container.innerHTML = '';
            
            const top3 = rankingFiltrado.slice(0, 3);
            const medals = ['medal-gold', 'medal-silver', 'medal-bronze'];
            const positions = ['ü•á', 'ü•à', 'ü•â'];
            
            top3.forEach((combo, index) => {
                const card = document.createElement('div');
                card.className = `ranking-card p-6 rounded-lg shadow-lg text-center ${medals[index]} text-white`;
                
                card.innerHTML = `
                    <div class="text-4xl mb-2">${positions[index]}</div>
                    <div class="text-xl font-bold mb-2">Posi√ß√£o ${index + 1}</div>
                    <div class="text-lg font-semibold mb-3">[${combo.digitos.join(', ')}]</div>
                    <div class="space-y-2 text-sm">
                        <div><strong>${combo.digitos.length}</strong> d√≠gitos</div>
                        <div><strong>${combo.frequencia}</strong> apari√ß√µes</div>
                        <div><strong>${combo.numerosValidos.length}</strong> n√∫meros v√°lidos</div>
                        <div><strong>${combo.jogosPossiveis.toLocaleString('pt-BR')}</strong> jogos poss√≠veis</div>
                    </div>
                    <button onclick="mostrarDetalhes('${combo.chave}')" 
                        class="mt-4 bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded font-semibold">
                        Ver Detalhes
                    </button>
                `;
                
                container.appendChild(card);
            });
        }

        // Fun√ß√£o para criar gr√°ficos
        function criarGraficos() {
            criarGraficoFrequencia();
            criarGraficoJogos();
        }

        function criarGraficoFrequencia() {
            const ctx = document.getElementById('frequencyChart').getContext('2d');
            
            // Destruir gr√°fico anterior se existir
            if (window.frequencyChartInstance) {
                window.frequencyChartInstance.destroy();
            }
            
            const top10 = rankingFiltrado.slice(0, 10);
            
            window.frequencyChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: top10.map(c => `[${c.digitos.join(',')}]`),
                    datasets: [{
                        label: 'Frequ√™ncia',
                        data: top10.map(c => c.frequencia),
                        backgroundColor: 'rgba(27, 154, 103, 0.7)',
                        borderColor: 'rgba(27, 154, 103, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Apari√ß√µes'
                            }
                        }
                    }
                }
            });
        }

        function criarGraficoJogos() {
            const ctx = document.getElementById('jogosChart').getContext('2d');
            
            // Destruir gr√°fico anterior se existir
            if (window.jogosChartInstance) {
                window.jogosChartInstance.destroy();
            }
            
            const top10 = rankingFiltrado.slice(0, 10);
            
            window.jogosChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: top10.map(c => `[${c.digitos.join(',')}]`),
                    datasets: [{
                        label: 'Jogos Poss√≠veis',
                        data: top10.map(c => c.jogosPossiveis),
                        backgroundColor: 'rgba(27, 154, 103, 0.1)',
                        borderColor: 'rgba(27, 154, 103, 1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Jogos Poss√≠veis'
                            }
                        }
                    }
                }
            });
        }

        // Fun√ß√£o para exibir ranking completo
        function exibirRankingCompleto() {
            const tbody = document.getElementById('ranking-table-body');
            tbody.innerHTML = '';
            
            document.getElementById('total-showing').textContent = rankingFiltrado.length.toLocaleString('pt-BR');
            
            rankingFiltrado.forEach((combo, index) => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 border-b dark:border-gray-700';
                
                // Determinar cor da posi√ß√£o
                let positionClass = '';
                if (index < 3) positionClass = 'text-yellow-600 font-bold';
                else if (index < 10) positionClass = 'text-primary font-semibold';
                
                row.innerHTML = `
                    <td class="py-3 px-4 ${positionClass}">${index + 1}¬∫</td>
                    <td class="py-3 px-4 font-mono font-semibold">[${combo.digitos.join(', ')}]</td>
                    <td class="py-3 px-4 text-center">${combo.digitos.length}</td>
                    <td class="py-3 px-4 text-center font-bold text-primary">${combo.frequencia}</td>
                    <td class="py-3 px-4 text-center font-semibold text-orange-600">${combo.intervaloMedio || '-'}</td>
                    <td class="py-3 px-4 text-center">${combo.numerosValidos.length}</td>
                    <td class="py-3 px-4 text-center font-semibold text-primary">${combo.jogosPossiveis.toLocaleString('pt-BR')}</td>
                    <td class="py-3 px-4 text-center text-sm">${combo.eficiencia}</td>
                    <td class="py-3 px-4 text-center">
                        <button onclick="mostrarDetalhes('${combo.chave}')" 
                            class="bg-primary hover:bg-primary-dark text-white px-3 py-1 rounded text-sm">
                            Detalhes
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Fun√ß√£o para mostrar detalhes de uma combina√ß√£o
        function mostrarDetalhes(chave) {
            const combo = rankingCombinacoes.find(c => c.chave === chave);
            if (!combo) return;
            
            const modal = document.getElementById('details-modal');
            const title = document.getElementById('modal-title');
            const content = document.getElementById('modal-content');
            
            title.textContent = `Detalhes da Combina√ß√£o [${combo.digitos.join(', ')}]`;
            
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                        <h4 class="font-semibold mb-3">üìä Estat√≠sticas</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Quantidade de d√≠gitos:</span>
                                <span class="font-semibold">${combo.digitos.length}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Frequ√™ncia de apari√ß√£o:</span>
                                <span class="font-semibold text-primary">${combo.frequencia} vezes</span>
                            </div>
                            <div class="flex justify-between">
                                <span>N√∫meros v√°lidos formados:</span>
                                <span class="font-semibold">${combo.numerosValidos.length}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Jogos poss√≠veis:</span>
                                <span class="font-semibold text-primary">${combo.jogosPossiveis.toLocaleString('pt-BR')}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Efici√™ncia:</span>
                                <span class="font-semibold">${combo.eficiencia}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                        <h4 class="font-semibold mb-3">‚è±Ô∏è Intervalos Entre Concursos</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Intervalo m√©dio:</span>
                                <span class="font-semibold text-orange-600">${combo.intervaloMedio || 0} concursos</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Menor intervalo:</span>
                                <span class="font-semibold text-primary">${combo.intervaloMinimo || 0} concursos</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Maior intervalo:</span>
                                <span class="font-semibold text-red-600">${combo.intervaloMaximo || 0} concursos</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Total de intervalos:</span>
                                <span class="font-semibold">${combo.intervalos ? combo.intervalos.length : 0}</span>
                            </div>
                            ${combo.intervalos && combo.intervalos.length > 0 ? `
                            <div class="mt-3 pt-2 border-t border-gray-300 dark:border-gray-600">
                                <div class="text-xs text-gray-600 dark:text-gray-400">
                                    Todos os intervalos: ${combo.intervalos.join(', ')}
                                </div>
                            </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                        <h4 class="font-semibold mb-3">üéØ N√∫meros V√°lidos</h4>
                        <div class="grid grid-cols-6 gap-2 text-sm max-h-48 overflow-y-auto">
                            ${combo.numerosValidos.map(num => 
                                `<span class="bg-primary text-white px-2 py-1 rounded text-center">${num.toString().padStart(2, '0')}</span>`
                            ).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                    <h4 class="font-semibold mb-3">üìÖ Concursos que utilizaram esta combina√ß√£o</h4>
                    <div class="grid grid-cols-8 md:grid-cols-12 gap-2 text-sm max-h-32 overflow-y-auto">
                        ${combo.concursos.map(concurso => 
                            `<span class="bg-green-100 dark:bg-green-800 text-green-800 dark:text-green-200 px-2 py-1 rounded text-center">${concurso}</span>`
                        ).join('')}
                    </div>
                    <p class="text-xs text-gray-500 mt-2">
                        Total: ${combo.concursos.length} concursos de ${todosResultados.length} analisados 
                        (${((combo.frequencia / todosResultados.length) * 100).toFixed(2)}%)
                    </p>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // Event listeners
        document.getElementById('close-modal').addEventListener('click', () => {
            document.getElementById('details-modal').classList.add('hidden');
        });

        // Fechar modal clicando fora
        document.getElementById('details-modal').addEventListener('click', (e) => {
            if (e.target.id === 'details-modal') {
                document.getElementById('details-modal').classList.add('hidden');
            }
        });

        // Fun√ß√£o para gerar 120 jogos recomendados
        function gerarJogosRecomendados() {
            try {
                // Pegar as 5 melhores combina√ß√µes que tenham pelo menos 6 n√∫meros v√°lidos
                const melhoresCombinacoes = rankingCombinacoes
                    .filter(combo => combo.numerosValidos.length >= 6)
                    .slice(0, 5);
                
                if (melhoresCombinacoes.length === 0) {
                    console.error('Nenhuma combina√ß√£o v√°lida encontrada para gerar jogos');
                    return;
                }
                
                jogosGerados = [];
                const jogosSet = new Set(); // Para evitar duplicatas
                
                // Distribuir 120 jogos entre as melhores combina√ß√µes
                const jogosPorCombinacao = Math.floor(120 / melhoresCombinacoes.length);
                const restante = 120 % melhoresCombinacoes.length;
                
                let numerosUtilizados = new Set();
                let jogoIndex = 0;
                
                melhoresCombinacoes.forEach((combo, index) => {
                    const quantidadeJogos = jogosPorCombinacao + (index < restante ? 1 : 0);
                    const numerosDisponiveis = [...combo.numerosValidos];
                    
                    // Adicionar n√∫meros v√°lidos ao conjunto total
                    numerosDisponiveis.forEach(num => numerosUtilizados.add(num));
                    
                    for (let i = 0; i < quantidadeJogos; i++) {
                        let tentativas = 0;
                        while (tentativas < 100) { // M√°ximo 100 tentativas para evitar loop infinito
                            // Gerar jogo aleat√≥rio com 6 n√∫meros desta combina√ß√£o
                            const dezenas = gerarJogoAleatorio(numerosDisponiveis);
                            const jogoStr = dezenas.join(' ');
                            
                            if (!jogosSet.has(jogoStr)) {
                                jogosSet.add(jogoStr);
                                
                                jogosGerados.push({
                                    dezenas: dezenas,
                                    numeroJogo: jogoIndex + 1
                                });
                                
                                jogoIndex++;
                                break;
                            }
                            tentativas++;
                        }
                        
                        // Se n√£o conseguiu gerar um jogo √∫nico, for√ßa um jogo mesmo que seja repetido
                        if (tentativas >= 100) {
                            const dezenas = gerarJogoAleatorio(numerosDisponiveis);
                            
                            jogosGerados.push({
                                dezenas: dezenas,
                                numeroJogo: jogoIndex + 1
                            });
                            
                            jogoIndex++;
                        }
                    }
                });
                
                // Completar com jogos aleat√≥rios se necess√°rio
                while (jogosGerados.length < 120) {
                    const todosNumeros = Array.from(numerosUtilizados);
                    const dezenas = gerarJogoAleatorio(todosNumeros);
                    
                    jogosGerados.push({
                        dezenas: dezenas,
                        numeroJogo: jogoIndex + 1
                    });
                    
                    jogoIndex++;
                }
                
                // Garantir que temos exatamente 120 jogos
                jogosGerados = jogosGerados.slice(0, 120);
                
                // Atualizar informa√ß√µes na tela
                document.getElementById('jogos-baseados-em').textContent = melhoresCombinacoes.length;
                document.getElementById('total-numeros-utilizados').textContent = numerosUtilizados.size;
                
                // Exibir todos os jogos
                exibirTodosJogos();
                
                // Configurar downloads
                configurarDownloads();
                
                console.log(`Gerados ${jogosGerados.length} jogos baseados em ${melhoresCombinacoes.length} combina√ß√µes`);
                
            } catch (error) {
                console.error('Erro ao gerar jogos:', error);
            }
        }
        
        // Fun√ß√£o para gerar um jogo aleat√≥rio de 6 n√∫meros
        function gerarJogoAleatorio(numerosDisponiveis) {
            if (numerosDisponiveis.length < 6) {
                // Se n√£o temos n√∫meros suficientes, preencher com n√∫meros aleat√≥rios de 1-60
                const numerosExtras = [];
                for (let i = 1; i <= 60; i++) {
                    if (!numerosDisponiveis.includes(i)) {
                        numerosExtras.push(i);
                    }
                }
                numerosDisponiveis = [...numerosDisponiveis, ...numerosExtras];
            }
            
            const jogo = [];
            const numerosUsados = new Set();
            
            while (jogo.length < 6) {
                const indiceAleatorio = Math.floor(Math.random() * numerosDisponiveis.length);
                const numero = numerosDisponiveis[indiceAleatorio];
                
                if (!numerosUsados.has(numero)) {
                    jogo.push(numero);
                    numerosUsados.add(numero);
                }
            }
            
            // Ordenar o jogo e formatar com zeros √† esquerda
            return jogo.sort((a, b) => a - b).map(n => n.toString().padStart(2, '0'));
        }
        
        // Fun√ß√£o para exibir todos os jogos
        function exibirTodosJogos() {
            configurarEventListenersJogos();
            jogosFiltrados = [...jogosGerados];
            atualizarVisualizacaoJogos();
        }

        // Fun√ß√£o para configurar event listeners dos jogos
        function configurarEventListenersJogos() {
            // Verifica√ß√£o de acertos
            document.getElementById('verificar-acertos').addEventListener('click', verificarAcertos);
            
            // üü¢ BUSCA INTELIGENTE EM TEMPO REAL COM DESTAQUE VERDE
            document.getElementById('dezenas-sorteadas').addEventListener('input', buscarJogosTempoReal);
            
            // Filtros e visualiza√ß√£o
            document.getElementById('aplicar-filtros-jogos').addEventListener('click', aplicarFiltrosJogos);
            document.getElementById('toggle-jogos-view').addEventListener('click', alternarVisualizacao);
            document.getElementById('limpar-filtros').addEventListener('click', limparFiltrosJogos);
            
            // Controle de pagina√ß√£o
            document.getElementById('jogos-por-pagina').addEventListener('change', (e) => {
                jogosPorPagina = parseInt(e.target.value);
                paginaAtual = 1;
                atualizarVisualizacaoJogos();
            });
        }

        // Fun√ß√£o para verificar acertos
        function verificarAcertos() {
            const dezenasInput = document.getElementById('dezenas-sorteadas').value.trim();
            const resultadoDiv = document.getElementById('resultado-verificacao');
            
            if (!dezenasInput) {
                // Criar modal personalizado em vez de alert()
                mostrarModal('Aten√ß√£o', 'Por favor, preencha as dezenas sorteadas.');
                return;
            }
            
            // Processar dezenas
            const dezenasSorteadas = dezenasInput.split(/\s+/)
                .map(n => n.padStart(2, '0'))
                .filter(n => n.match(/^\d{2}$/))
                .sort();
            
            if (dezenasSorteadas.length !== 6) {
                mostrarModal('Erro de Valida√ß√£o', 'Por favor, insira exatamente 6 dezenas v√°lidas (01-60).');
                return;
            }
            
            // Verificar cada jogo
            const resultados = jogosGerados.map((jogo, index) => {
                const acertos = contarAcertos(jogo.dezenas, dezenasSorteadas);
                
                return {
                    numeroJogo: jogo.numeroJogo,
                    dezenas: jogo.dezenas,
                    acertos: acertos,
                    pontuacao: acertos
                };
            });
            
            // Ordenar por pontua√ß√£o (acertos)
            resultados.sort((a, b) => b.pontuacao - a.pontuacao);
            
            ultimaVerificacao = {
                dezenasSorteadas,
                resultados
            };
            
            exibirResultadoVerificacao(resultados, dezenasSorteadas);
            
            // Atualizar visualiza√ß√£o dos jogos para destacar acertos
            atualizarVisualizacaoJogos();
        }

        // Fun√ß√£o para criar modal customizado (substitui alert)
        function mostrarModal(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-gray-100">${titulo}</h3>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white hover:bg-primary-dark rounded font-semibold" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Fun√ß√£o para contar acertos entre duas listas de dezenas
        function contarAcertos(dezenas1, dezenas2) {
            return dezenas1.filter(d => dezenas2.includes(d)).length;
        }

        // Fun√ß√£o para exibir resultado da verifica√ß√£o
        function exibirResultadoVerificacao(resultados, dezenasSorteadas) {
            const resultadoDiv = document.getElementById('resultado-verificacao');
            
            // Estat√≠sticas gerais
            const maxAcertos = Math.max(...resultados.map(r => r.acertos));
            const melhoresJogos = resultados.filter(r => r.acertos === maxAcertos);
            
            // Distribui√ß√£o de acertos
            const distribuicao = {};
            for (let i = 0; i <= 6; i++) {
                distribuicao[i] = resultados.filter(r => r.acertos === i).length;
            }
            
            resultadoDiv.innerHTML = `
                <h5 class="font-bold text-lg mb-4">üéØ Resultado da Verifica√ß√£o</h5>
                
                <!-- Dezenas sorteadas -->
                <div class="mb-4">
                    <h6 class="font-semibold mb-2">Dezenas Sorteadas:</h6>
                    <div class="flex flex-wrap gap-2">
                        ${dezenasSorteadas.map(d => 
                            `<span class="bg-primary text-white px-3 py-1 rounded font-mono font-bold">${d}</span>`
                        ).join('')}
                    </div>
                </div>
                
                <!-- Estat√≠sticas -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="text-center p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                        <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-400">${maxAcertos}</div>
                        <div class="text-xs text-yellow-700 dark:text-yellow-300">M√°ximo de Acertos</div>
                    </div>
                    
                    <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                        <div class="text-2xl font-bold text-primary">${melhoresJogos.length}</div>
                        <div class="text-xs text-primary-dark dark:text-primary-light">Jogos com ${maxAcertos} Acertos</div>
                    </div>
                    
                    <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                        <div class="text-2xl font-bold text-primary">${resultados.filter(r => r.pontuacao >= 3).length}</div>
                        <div class="text-xs text-primary-dark dark:text-primary-light">3+ Acertos Total</div>
                    </div>
                </div>
                
                <!-- Distribui√ß√£o de acertos -->
                <div class="mb-6">
                    <h6 class="font-semibold mb-3">üìä Distribui√ß√£o de Acertos:</h6>
                    <div class="grid grid-cols-4 md:grid-cols-7 gap-2 text-sm">
                        ${Object.entries(distribuicao).map(([acertos, quantidade]) => 
                            `<div class="text-center p-2 bg-gray-100 dark:bg-gray-700 rounded">
                                <div class="font-bold text-primary">${quantidade}</div>
                                <div class="text-xs">${acertos} acertos</div>
                            </div>`
                        ).join('')}
                    </div>
                </div>
                
                <!-- Top 10 melhores jogos -->
                <div class="mb-4">
                    <h6 class="font-semibold mb-3">üèÜ Top 10 Melhores Jogos:</h6>
                    <div class="space-y-2">
                        ${resultados.slice(0, 10).map((resultado, index) => {
                            const medalClass = index < 3 ? ['text-yellow-500', 'text-gray-500', 'text-orange-500'][index] : 'text-gray-400';
                            const bgClass = resultado.acertos >= 4 ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800' : 
                                           resultado.acertos >= 3 ? 'bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800' : 
                                           'bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600';
                            
                            return `<div class="flex items-center justify-between p-3 ${bgClass} border rounded-lg">
                                <div class="flex items-center gap-3">
                                    <span class="font-bold ${medalClass}">#${index + 1}</span>
                                    <span class="text-sm text-gray-500">Jogo ${resultado.numeroJogo}:</span>
                                    <span class="font-mono font-bold">${resultado.dezenas.join(' ')}</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="bg-primary text-white px-2 py-1 rounded text-xs font-bold">
                                        ${resultado.acertos} acertos
                                    </span>
                                </div>
                            </div>`;
                        }).join('')}
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para aplicar filtros nos jogos
        function aplicarFiltrosJogos() {
            const ordenacao = document.getElementById('ordenacao').value;
            
            // Filtrar jogos
            jogosFiltrados = [...jogosGerados];
            
            // Ordenar jogos
            if (ordenacao === 'numero') {
                jogosFiltrados.sort((a, b) => a.numeroJogo - b.numeroJogo);
            } else if (ordenacao === 'acertos' && ultimaVerificacao) {
                jogosFiltrados.sort((a, b) => {
                    const resultA = ultimaVerificacao.resultados.find(r => r.numeroJogo === a.numeroJogo);
                    const resultB = ultimaVerificacao.resultados.find(r => r.numeroJogo === b.numeroJogo);
                    return (resultB ? resultB.pontuacao : 0) - (resultA ? resultA.pontuacao : 0);
                });
            }
            
            paginaAtual = 1;
            atualizarVisualizacaoJogos();
        }

        // Fun√ß√£o para limpar filtros
        function limparFiltrosJogos() {
            document.getElementById('ordenacao').value = 'numero';
            document.getElementById('jogos-por-pagina').value = '20';
            jogosPorPagina = 20;
            jogosFiltrados = [...jogosGerados];
            paginaAtual = 1;
            atualizarVisualizacaoJogos();
        }

        // Fun√ß√£o para alternar visualiza√ß√£o
        function alternarVisualizacao() {
            viewCompacta = !viewCompacta;
            const btn = document.getElementById('toggle-jogos-view');
            btn.textContent = viewCompacta ? 'üìã Visualiza√ß√£o Expandida' : 'üìã Visualiza√ß√£o Compacta';
            atualizarVisualizacaoJogos();
        }

        // üü¢ FUN√á√ÉO PRINCIPAL PARA ATUALIZAR VISUALIZA√á√ÉO COM DESTAQUE VERDE VIBRANTE
        function atualizarVisualizacaoJogos() {
            const container = document.getElementById('lista-jogos');
            const paginacaoContainer = document.getElementById('paginacao');
            
            // Calcular pagina√ß√£o
            const totalJogos = jogosFiltrados.length;
            const totalPaginas = Math.ceil(totalJogos / jogosPorPagina);
            const inicio = (paginaAtual - 1) * jogosPorPagina;
            const fim = Math.min(inicio + jogosPorPagina, totalJogos);
            const jogosParaExibir = jogosFiltrados.slice(inicio, fim);
            
            // Limpar container
            container.innerHTML = '';
            
            // Exibir jogos com DESTAQUE VERDE VIBRANTE
            jogosParaExibir.forEach(jogo => {
                const jogoDiv = document.createElement('div');
                
                // Verificar se tem resultado de verifica√ß√£o para este jogo
                let resultadoVerificacao = null;
                if (ultimaVerificacao) {
                    resultadoVerificacao = ultimaVerificacao.resultados.find(r => r.numeroJogo === jogo.numeroJogo);
                }
                
                // Classes para destacar acertos
                let borderClass = 'border-gray-200 dark:border-gray-600';
                let bgClass = 'bg-gray-50 dark:bg-gray-700';
                
                if (resultadoVerificacao) {
                    if (resultadoVerificacao.acertos >= 4) {
                        borderClass = 'border-primary';
                        bgClass = 'bg-green-50 dark:bg-green-900/20';
                    } else if (resultadoVerificacao.acertos >= 3) {
                        borderClass = 'border-yellow-500';
                        bgClass = 'bg-yellow-50 dark:bg-yellow-900/20';
                    }
                }
                
                // üé® DETERMINAR CLASSE DE COR BASEADA NO N√öMERO DE ACERTOS
                const acertosClass = resultadoVerificacao ? `acertos-${resultadoVerificacao.acertos}` : '';
                
                // üü¢ GERAR HTML DAS DEZENAS COM CORES GRADUADAS POR ACERTOS
                const dezenasHTML = jogo.dezenas.map(dezena => {
                    const isAcerto = ultimaVerificacao && ultimaVerificacao.dezenasSorteadas.includes(dezena);
                    const classes = isAcerto ? 'dezena-acertada' : 'dezena-normal';
                    return `<span class="${classes}">${dezena}</span>`;
                }).join(' ');
                
                // üèÖ BADGE DE ACERTOS COM COR CORRESPONDENTE
                const badgeAcertos = resultadoVerificacao ? 
                    `<span class="badge-acertos-${resultadoVerificacao.acertos} text-white px-2 py-1 rounded text-xs font-bold">
                        ${resultadoVerificacao.acertos} ${getEmojiPorAcertos(resultadoVerificacao.acertos)}
                    </span>` : '';
                
                if (viewCompacta) {
                    jogoDiv.className = `${acertosClass} ${bgClass} p-2 rounded border ${borderClass} text-sm`;
                    jogoDiv.innerHTML = `
                        <div class="flex justify-between items-center">
                            <span class="text-xs text-gray-500">#${jogo.numeroJogo}</span>
                            <div class="flex flex-wrap">${dezenasHTML}</div>
                            ${badgeAcertos}
                        </div>
                    `;
                } else {
                    jogoDiv.className = `${acertosClass} ${bgClass} p-4 rounded-lg border ${borderClass}`;
                    jogoDiv.innerHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-gray-500">Jogo ${jogo.numeroJogo}</span>
                            ${resultadoVerificacao ? `
                                <div class="flex gap-2">
                                    ${badgeAcertos}
                                </div>
                            ` : ''}
                        </div>
                        <div class="text-lg font-bold mb-2">${dezenasHTML}</div>
                        ${resultadoVerificacao ? `
                            <div class="mt-2 text-xs text-gray-600 dark:text-gray-400">
                                <strong>${getNomePorAcertos(resultadoVerificacao.acertos)}:</strong> 
                                ${resultadoVerificacao.acertos > 0 ? 
                                    jogo.dezenas.filter(d => ultimaVerificacao.dezenasSorteadas.includes(d)).join(', ') : 
                                    'Nenhuma dezena acertada'
                                }
                            </div>
                        ` : ''}
                    `;
                }
                
                container.appendChild(jogoDiv);
            });
            
            // Atualizar pagina√ß√£o
            atualizarPaginacao(totalPaginas, paginacaoContainer);
        }

        // Fun√ß√£o para atualizar pagina√ß√£o
        function atualizarPaginacao(totalPaginas, container) {
            container.innerHTML = '';
            
            if (totalPaginas <= 1) return;
            
            // Bot√£o anterior
            const btnAnterior = document.createElement('button');
            btnAnterior.textContent = '‚Üê Anterior';
            btnAnterior.className = `px-3 py-2 text-sm rounded ${paginaAtual === 1 ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-primary text-white hover:bg-primary-dark'}`;
            btnAnterior.disabled = paginaAtual === 1;
            btnAnterior.addEventListener('click', () => {
                if (paginaAtual > 1) {
                    paginaAtual--;
                    atualizarVisualizacaoJogos();
                }
            });
            container.appendChild(btnAnterior);
            
            // N√∫meros das p√°ginas
            const maxBotoes = 5;
            let inicio = Math.max(1, paginaAtual - Math.floor(maxBotoes / 2));
            let fim = Math.min(totalPaginas, inicio + maxBotoes - 1);
            
            if (fim - inicio < maxBotoes - 1) {
                inicio = Math.max(1, fim - maxBotoes + 1);
            }
            
            for (let i = inicio; i <= fim; i++) {
                const btn = document.createElement('button');
                btn.textContent = i;
                btn.className = `px-3 py-2 text-sm rounded ${i === paginaAtual ? 'bg-primary text-white' : 'bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500'}`;
                btn.addEventListener('click', () => {
                    paginaAtual = i;
                    atualizarVisualizacaoJogos();
                });
                container.appendChild(btn);
            }
            
            // Bot√£o pr√≥xima
            const btnProxima = document.createElement('button');
            btnProxima.textContent = 'Pr√≥xima ‚Üí';
            btnProxima.className = `px-3 py-2 text-sm rounded ${paginaAtual === totalPaginas ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-primary text-white hover:bg-primary-dark'}`;
            btnProxima.disabled = paginaAtual === totalPaginas;
            btnProxima.addEventListener('click', () => {
                if (paginaAtual < totalPaginas) {
                    paginaAtual++;
                    atualizarVisualizacaoJogos();
                }
            });
            container.appendChild(btnProxima);
        }

        // Fun√ß√£o para configurar os downloads
        function configurarDownloads() {
            // Download HTML
            document.getElementById('download-jogos-html').addEventListener('click', () => {
                downloadJogosHTML();
            });
            
            // Download TXT
            document.getElementById('download-jogos-txt').addEventListener('click', () => {
                downloadJogosTXT();
            });
            
            // Download XLSX
            document.getElementById('download-jogos-xlsx').addEventListener('click', () => {
                downloadJogosXLSX();
            });
        }
        
        // Fun√ß√£o para download em HTML
        function downloadJogosHTML() {
            try {
                let htmlContent = `
                <!DOCTYPE html>
                <html lang="pt-BR">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>120 Jogos Recomendados - Mega Sena</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
                        .jogo { display: inline-block; margin: 5px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9; font-family: monospace; font-weight: bold; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .data { text-align: center; margin-bottom: 20px; font-size: 14px; color: #666; }
                        @media (prefers-color-scheme: dark) {
                            body { background-color: #1a1a1a; color: #e0e0e0; }
                            .jogo { background-color: #333; border-color: #555; color: #fff; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>120 Jogos Recomendados - Mega Sena</h1>
                        <h2>Baseados nas Combina√ß√µes de D√≠gitos Mais Frequentes</h2>
                    </div>
                    <div class="data">
                        Gerado em: ${new Date().toLocaleString('pt-BR')}<br>
                        Total de concursos analisados: ${todosResultados.length}
                    </div>
                    <div class="jogos">
                `;
                
                jogosGerados.forEach((jogo) => {
                    htmlContent += `<div class="jogo">${jogo.dezenas.join(' ')}</div>\n`;
                });
                
                htmlContent += `
                    </div>
                </body>
                </html>
                `;
                
                const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'jogos_megasena_120.html';
                link.click();
                
            } catch (error) {
                console.error('Erro ao gerar HTML:', error);
                mostrarModal('Erro', 'Erro ao gerar arquivo HTML.');
            }
        }
        
        // Fun√ß√£o para download em TXT
        function downloadJogosTXT() {
            try {
                let txtContent = '';
                
                jogosGerados.forEach((jogo) => {
                    txtContent += `${jogo.dezenas.join(' ')}\n`;
                });
                
                const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'jogos_megasena_120.txt';
                link.click();
                
            } catch (error) {
                console.error('Erro ao gerar TXT:', error);
                mostrarModal('Erro', 'Erro ao gerar arquivo TXT.');
            }
        }
        
        // Fun√ß√£o para download em XLSX
        function downloadJogosXLSX() {
            try {
                let xlsxContent = `
                <table border="1">
                    <tr>
                        <th>N√∫mero 1</th>
                        <th>N√∫mero 2</th>
                        <th>N√∫mero 3</th>
                        <th>N√∫mero 4</th>
                        <th>N√∫mero 5</th>
                        <th>N√∫mero 6</th>
                    </tr>
                `;
                
                jogosGerados.forEach((jogo) => {
                    xlsxContent += `<tr>`;
                    jogo.dezenas.forEach(numero => {
                        xlsxContent += `<td>${numero}</td>`;
                    });
                    xlsxContent += `</tr>\n`;
                });
                
                xlsxContent += `</table>`;
                
                const blob = new Blob([xlsxContent], { type: 'application/vnd.ms-excel' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'jogos_megasena_120.xls';
                link.click();
                
            } catch (error) {
                console.error('Erro ao gerar XLSX:', error);
                mostrarModal('Erro', 'Erro ao gerar arquivo XLSX.');
            }
        }

        // üèÜ FUN√á√ÉO PRINCIPAL DE BUSCA INTELIGENTE EM TEMPO REAL COM FILTRO DE JOGOS PREMIADOS
        function buscarJogosTempoReal() {
            const dezenasInput = document.getElementById('dezenas-sorteadas').value.trim();
            
            // Processar n√∫meros digitados
            const numerosDigitados = dezenasInput.split(/\s+/)
                .map(n => n.padStart(2, '0'))
                .filter(n => n.match(/^\d{2}$/) && parseInt(n) >= 1 && parseInt(n) <= 60);
            
            // Atualizar contadores
            document.getElementById('contador-numeros').textContent = `${numerosDigitados.length}/6 n√∫meros`;
            
            // Se n√£o h√° n√∫meros digitados, mostrar todos os jogos
            if (numerosDigitados.length === 0) {
                document.getElementById('contador-jogos-destacados').textContent = '0 jogos premiados';
                ultimaVerificacao = null; // Limpar verifica√ß√£o
                jogosFiltrados = [...jogosGerados]; // Mostrar todos os jogos
                paginaAtual = 1; // Resetar para primeira p√°gina
                atualizarVisualizacaoJogos();
                return;
            }
            
            // Criar verifica√ß√£o tempor√°ria para destaque EM TEMPO REAL
            let verificacaoTemporaria = null;
            
            if (numerosDigitados.length > 0) {
                const resultados = jogosGerados.map((jogo) => {
                    const acertos = contarAcertos(jogo.dezenas, numerosDigitados);
                    
                    return {
                        numeroJogo: jogo.numeroJogo,
                        dezenas: jogo.dezenas,
                        acertos: acertos,
                        pontuacao: acertos,
                        jogo: jogo // Refer√™ncia do jogo original
                    };
                });
                
                // üèÜ FILTRAR APENAS JOGOS PREMIADOS (com pelo menos 1 acerto)
                const jogosPremiados = resultados.filter(r => r.acertos > 0);
                
                // Ordenar jogos premiados por pontua√ß√£o (maiores acertos primeiro)
                jogosPremiados.sort((a, b) => b.pontuacao - a.pontuacao);
                
                // Atualizar contador
                document.getElementById('contador-jogos-destacados').textContent = `${jogosPremiados.length} jogos premiados`;
                
                // üéØ MOSTRAR APENAS OS JOGOS PREMIADOS
                jogosFiltrados = jogosPremiados.map(r => r.jogo);
                paginaAtual = 1; // Resetar para primeira p√°gina
                
                verificacaoTemporaria = {
                    dezenasSorteadas: numerosDigitados,
                    resultados: resultados
                };
            }
            
            // Usar verifica√ß√£o tempor√°ria para DESTAQUE VERDE VIBRANTE EM TEMPO REAL
            ultimaVerificacao = verificacaoTemporaria;
            atualizarVisualizacaoJogos();
        }

        // Fun√ß√£o para mostrar/ocultar ranking completo
        function toggleRankingCompletoSection() {
            const tableContainer = document.querySelector('#ranking-section .overflow-x-auto');
            const toggleIcon = document.getElementById('toggleRankingIcon');
            const toggleText = document.getElementById('toggleRankingText');
            
            if (tableContainer.style.display === 'none') {
                tableContainer.style.display = 'block';
                toggleIcon.textContent = 'üëÅÔ∏è';
                toggleText.textContent = 'Ocultar';
            } else {
                tableContainer.style.display = 'none';
                toggleIcon.textContent = 'üîç';
                toggleText.textContent = 'Mostrar';
            }
        }

        // üé® FUN√á√ïES AUXILIARES PARA SISTEMA DE CORES E EMOJIS
        function getEmojiPorAcertos(acertos) {
            const emojis = {
                6: 'üèÜ', // SENA - Dourado
                5: 'ü•á', // QUINA - Verde
                4: 'ü•à', // QUADRA - Azul
                3: 'ü•â', // REGULAR - Laranja
                2: '‚ö°', // FRACO - Rosa/Magenta
                1: 'üí´', // M√çNIMO - Vermelho
                0: '‚óØ'  // SEM ACERTOS
            };
            return emojis[acertos] || '‚óØ';
        }
        
        function getNomePorAcertos(acertos) {
            const nomes = {
                6: 'SENA',
                5: 'QUINA',
                4: 'QUADRA',
                3: 'REGULAR',
                2: 'FRACO',
                1: 'M√çNIMO',
                0: 'SEM ACERTOS'
            };
            return nomes[acertos] || 'SEM ACERTOS';
        }

        // üìÇ FUN√á√ÉO PARA USAR DADOS DE EXEMPLO QUANDO API FALHA
        function usarDadosExemplo() {
            updateLoadingStatus("API indispon√≠vel. Carregando dados de exemplo...", 50);
            
            // Dados de exemplo simulando concursos reais da Mega Sena
            const dadosExemplo = [
                { numero: 1, data: '2024-01-01', dezenas: [3, 15, 23, 32, 45, 60] },
                { numero: 2, data: '2024-01-02', dezenas: [7, 12, 25, 38, 44, 52] },
                { numero: 3, data: '2024-01-03', dezenas: [5, 17, 29, 33, 41, 58] },
                { numero: 4, data: '2024-01-04', dezenas: [1, 13, 28, 35, 47, 59] },
                { numero: 5, data: '2024-01-05', dezenas: [9, 21, 31, 42, 48, 55] },
                { numero: 6, data: '2024-01-06', dezenas: [6, 18, 24, 36, 43, 56] },
                { numero: 7, data: '2024-01-07', dezenas: [11, 19, 27, 39, 46, 57] },
                { numero: 8, data: '2024-01-08', dezenas: [8, 16, 26, 34, 49, 54] },
                { numero: 9, data: '2024-01-09', dezenas: [2, 14, 22, 37, 50, 53] },
                { numero: 10, data: '2024-01-10', dezenas: [4, 20, 30, 40, 51, 61] }
            ];
            
            // Duplicar dados para simular mais concursos
            todosResultados = [];
            for (let i = 0; i < 50; i++) {
                dadosExemplo.forEach((exemplo, index) => {
                    todosResultados.push({
                        numero: i * 10 + index + 1,
                        data: exemplo.data,
                        dezenas: exemplo.dezenas
                    });
                });
            }
            
            updateLoadingStatus("Analisando dados de exemplo...", 80);
            analisarCombinacoes();
            updateLoadingStatus("Dados de exemplo carregados! (Modo offline - 500 concursos simulados)", 100);
            
            setTimeout(() => {
                loadingSection.classList.add('hidden');
                exibirResultados();
                
                // Mostrar aviso sobre dados de exemplo
                mostrarModal('Modo Offline', 'A API da Caixa est√° indispon√≠vel. O aplicativo est√° funcionando com dados de exemplo para demonstra√ß√£o.');
            }, 1000);
        }

        // Inicializar aplica√ß√£o
        window.onload = function() {
            buscarDadosCaixa();
        };
    </script>
</body>
</html>