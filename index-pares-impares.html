<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise Completa - Resultados Mega Sena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE'
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .number-ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }
        .number-ball.par {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        .number-ball.impar {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        .dezena-ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .dezena-ball.repetida {
            border: 3px solid #fbbf24;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.6);
            animation: pulse-gold 2s infinite;
        }
        @keyframes pulse-gold {
            0%, 100% { box-shadow: 0 0 15px rgba(251, 191, 36, 0.6); }
            50% { box-shadow: 0 0 25px rgba(251, 191, 36, 0.9); }
        }
        
        /* Melhorias visuais */
        .shimmer {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0) 0%, 
                rgba(255,255,255,0.2) 50%, 
                rgba(255,255,255,0) 100%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .success-checkmark {
            animation: checkmark 0.5s ease-in-out;
        }
        
        @keyframes checkmark {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Estilos para o bot√£o toggle */
        .toggle-button {
            background: linear-gradient(135deg, #8b5cf6, #3b82f6);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }
        
        .toggle-button:hover {
            background: linear-gradient(135deg, #7c3aed, #2563eb);
            box-shadow: 0 12px 35px rgba(139, 92, 246, 0.4);
        }

        /* Anima√ß√µes para as se√ß√µes */
        .secao-oculta {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.5s ease;
        }
        
        .secao-visivel {
            max-height: 2000px;
            opacity: 1;
            transform: translateY(0);
            transition: all 0.5s ease;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <!-- Detec√ß√£o de tema escuro -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>

    <!-- Header -->
    <div class="gradient-bg text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">üìä An√°lise (Pares vs √çmpares)</h1>
            <h2 class="text-2xl md:text-3xl font-semibold mb-6">Resultados Hist√≥ricos - Mega Sena</h2>
            <p class="text-lg opacity-90 max-w-3xl mx-auto">
                An√°lise estat√≠stica completa de <strong>TODOS</strong> os concursos realizados pela Caixa Econ√¥mica Federal
            </p>
        </div>
    </div>

    <!-- Loading / Status Profissional -->
    <div id="loading-section" class="container mx-auto px-4 py-8">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
            <!-- Header do Loading -->
            <div class="text-center mb-6">
                <div class="inline-block animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent mb-4"></div>
                <h3 class="text-2xl font-bold mb-2">üîÑ Carregando TODOS os Dados Oficiais</h3>
                <p class="text-gray-600 dark:text-gray-400">Caixa Econ√¥mica Federal - Loteria Mega Sena</p>
                <p class="text-sm text-primary font-semibold mt-2">Do primeiro ao √∫ltimo concurso dispon√≠vel</p>
            </div>

            <!-- Status Atual -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-medium">Status:</span>
                    <span class="text-sm text-gray-500" id="loading-status">Inicializando...</span>
                </div>
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden">
                    <div id="progress-bar" class="bg-gradient-to-r from-primary to-purple-600 h-3 rounded-full transition-all duration-500 shadow-sm shimmer" style="width: 0%"></div>
                </div>
                <div class="flex justify-between mt-1">
                    <span class="text-xs text-gray-500" id="progress-text">0%</span>
                    <span class="text-xs text-gray-500" id="progress-eta">Estimando tempo...</span>
                </div>
            </div>

            <!-- Estat√≠sticas em Tempo Real -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
                    <div class="text-2xl font-bold text-blue-600 dark:text-blue-400" id="concursos-carregados">0</div>
                    <div class="text-xs text-blue-700 dark:text-blue-300">Concursos Carregados</div>
                </div>
                <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                    <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="ultimo-concurso-status">-</div>
                    <div class="text-xs text-green-700 dark:text-green-300">√öltimo Processado</div>
                </div>
                <div class="text-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800">
                    <div class="text-2xl font-bold text-purple-600 dark:text-purple-400" id="numeros-processados">0</div>
                    <div class="text-xs text-purple-700 dark:text-purple-300">N√∫meros Processados</div>
                </div>
                <div class="text-center p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800">
                    <div class="text-2xl font-bold text-orange-600 dark:text-orange-400" id="velocidade-download">0/s</div>
                    <div class="text-xs text-orange-700 dark:text-orange-300">Concursos/seg</div>
                </div>
            </div>

            <!-- Log de Atividades -->
            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                <h4 class="font-semibold mb-2 text-sm flex items-center gap-2">
                    <span>üìã</span>
                    <span>Log de Atividades</span>
                    <span class="text-xs text-gray-500 ml-auto" id="total-logs">(0 eventos)</span>
                </h4>
                <div id="activity-log" class="space-y-1 text-xs text-gray-600 dark:text-gray-400 max-h-32 overflow-y-auto">
                    <div class="flex items-center gap-2">
                        <span class="text-blue-500">‚Ä¢</span>
                        <span>Sistema inicializado</span>
                        <span class="text-gray-400 ml-auto" id="init-time"></span>
                    </div>
                </div>
            </div>

            <!-- Informa√ß√µes da API -->
            <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-md">
                <h4 class="font-semibold mb-2 text-blue-800 dark:text-blue-200 flex items-center gap-2">
                    <span>‚ÑπÔ∏è</span>
                    <span>Informa√ß√µes do Sistema</span>
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <ul class="text-sm text-blue-700 dark:text-blue-300 space-y-1">
                        <li>‚Ä¢ Dados oficiais da Caixa Econ√¥mica Federal</li>
                        <li>‚Ä¢ <strong>TODOS</strong> os concursos desde o in√≠cio da loteria</li>
                        <li>‚Ä¢ An√°lise estat√≠stica completa em tempo real</li>
                        <li>‚Ä¢ Processamento otimizado em lotes</li>
                    </ul>
                    <div class="text-sm text-blue-700 dark:text-blue-300">
                        <div class="mb-1">
                            <strong>API Principal:</strong> 
                            <span class="font-mono text-xs">servicebus2.caixa.gov.br</span>
                        </div>
                        <div class="mb-1">
                            <strong>Range de Busca:</strong> 
                            <span class="font-semibold text-green-600">Concurso 1 ‚Üí √öltimo dispon√≠vel</span>
                        </div>
                        <div>
                            <strong>√öltima Atualiza√ß√£o:</strong> 
                            <span id="last-update-time">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bot√£o de Cancelar -->
            <div id="cancel-button-container" class="text-center mt-6 hidden">
                <button id="cancel-button" class="px-6 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors flex items-center gap-2 mx-auto">
                    <span>‚ùå</span>
                    <span>Cancelar Carregamento</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Resumo Geral -->
    <div id="summary-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center flex items-center justify-center gap-2">
                <span class="success-checkmark">‚úÖ</span>
                <span>üìà Resumo Geral Completo</span>
            </h3>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
                    <div class="text-3xl font-bold text-blue-600 dark:text-blue-400" id="total-concursos">-</div>
                    <div class="text-sm text-blue-700 dark:text-blue-300">Total de Concursos</div>
                </div>
                
                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                    <div class="text-3xl font-bold text-green-600 dark:text-green-400" id="total-numeros">-</div>
                    <div class="text-sm text-green-700 dark:text-green-300">N√∫meros Sorteados</div>
                </div>
                
                <div class="text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800">
                    <div class="text-3xl font-bold text-purple-600 dark:text-purple-400" id="primeiro-concurso">-</div>
                    <div class="text-sm text-purple-700 dark:text-purple-300">Primeiro Concurso</div>
                </div>
                
                <div class="text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800">
                    <div class="text-3xl font-bold text-orange-600 dark:text-orange-400" id="ultimo-concurso">-</div>
                    <div class="text-sm text-orange-700 dark:text-orange-300">√öltimo Concurso</div>
                </div>
            </div>

            <!-- Informa√ß√µes Adicionais -->
            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
                <h4 class="font-semibold mb-3 text-center">üìä Estat√≠sticas do Carregamento</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-center">
                    <div>
                        <span class="font-semibold">Tempo Total:</span>
                        <div id="tempo-total-carregamento" class="font-bold text-primary">-</div>
                    </div>
                    <div>
                        <span class="font-semibold">Velocidade M√©dia:</span>
                        <div id="velocidade-media" class="font-bold text-primary">-</div>
                    </div>
                    <div>
                        <span class="font-semibold">√öltima Atualiza√ß√£o:</span>
                        <div id="data-ultima-atualizacao" class="font-bold text-primary">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- An√°lise Principal: Pares vs √çmpares -->
    <div id="pares-impares-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üéØ AN√ÅLISE PRINCIPAL 1: Pares vs √çmpares</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <!-- N√∫meros Pares -->
                <div class="text-center p-6 bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-800 rounded-lg">
                    <h4 class="text-xl font-bold text-blue-600 dark:text-blue-400 mb-4">üîµ N√öMEROS PARES</h4>
                    <div class="text-5xl font-bold text-blue-600 dark:text-blue-400 mb-2" id="total-pares">-</div>
                    <div class="text-sm text-blue-700 dark:text-blue-300 mb-4">Total de ocorr√™ncias</div>
                    <div class="text-2xl font-semibold text-blue-600 dark:text-blue-400" id="percent-pares">-%</div>
                    <div class="text-xs text-blue-600 dark:text-blue-400">Percentual do total</div>
                </div>
                
                <!-- N√∫meros √çmpares -->
                <div class="text-center p-6 bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-lg">
                    <h4 class="text-xl font-bold text-red-600 dark:text-red-400 mb-4">üî¥ N√öMEROS √çMPARES</h4>
                    <div class="text-5xl font-bold text-red-600 dark:text-red-400 mb-2" id="total-impares">-</div>
                    <div class="text-sm text-red-700 dark:text-red-300 mb-4">Total de ocorr√™ncias</div>
                    <div class="text-2xl font-semibold text-red-600 dark:text-red-400" id="percent-impares">-%</div>
                    <div class="text-xs text-red-600 dark:text-red-400">Percentual do total</div>
                </div>
            </div>

            <!-- Gr√°fico Pares vs √çmpares -->
            <div class="mb-6">
                <h4 class="text-lg font-semibold mb-4 text-center">üìä Distribui√ß√£o Visual</h4>
                <div class="h-64">
                    <canvas id="paresImparesChart"></canvas>
                </div>
            </div>

            <!-- An√°lise por Concurso -->
            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                <h4 class="font-semibold mb-3">üìà An√°lise Detalhada:</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div>
                        <span class="font-semibold">M√©dia por concurso:</span>
                        <div>Pares: <span id="media-pares-concurso" class="font-bold text-blue-600">-</span></div>
                        <div>√çmpares: <span id="media-impares-concurso" class="font-bold text-red-600">-</span></div>
                    </div>
                    <div>
                        <span class="font-semibold">Concurso mais par:</span>
                        <div id="concurso-mais-par" class="font-bold">-</div>
                    </div>
                    <div>
                        <span class="font-semibold">Concurso mais √≠mpar:</span>
                        <div id="concurso-mais-impar" class="font-bold">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- An√°lise Principal: D√≠gitos Finais -->
    <div id="digitos-finais-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üéØ AN√ÅLISE PRINCIPAL 2: D√≠gitos Finais Mais Sorteados</h3>
            
            <!-- Ranking dos D√≠gitos -->
            <div class="mb-8">
                <h4 class="text-lg font-semibold mb-4 text-center">üèÜ Ranking dos D√≠gitos Finais</h4>
                <div id="ranking-digitos" class="grid grid-cols-2 md:grid-cols-5 gap-4">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
            </div>

            <!-- Gr√°fico D√≠gitos Finais -->
            <div class="mb-6">
                <h4 class="text-lg font-semibold mb-4 text-center">üìä Frequ√™ncia dos D√≠gitos Finais</h4>
                <div class="h-64">
                    <canvas id="digitosFinaisChart"></canvas>
                </div>
            </div>

            <!-- An√°lise Estat√≠stica -->
            <div class="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                <h4 class="font-semibold mb-3">üìà An√°lise Estat√≠stica:</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div>
                        <span class="font-semibold">D√≠gito mais sorteado:</span>
                        <div id="digito-mais-sorteado" class="font-bold text-green-600">-</div>
                    </div>
                    <div>
                        <span class="font-semibold">D√≠gito menos sorteado:</span>
                        <div id="digito-menos-sorteado" class="font-bold text-red-600">-</div>
                    </div>
                    <div>
                        <span class="font-semibold">Diferen√ßa maior-menor:</span>
                        <div id="diferenca-digitos" class="font-bold text-purple-600">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Estat√≠sticas Extras -->
    <div id="extras-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üìä Estat√≠sticas Extras</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- N√∫meros Mais Sorteados -->
                <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4">
                    <h4 class="font-semibold mb-3 text-green-800 dark:text-green-200">üéØ Top 10 N√∫meros Mais Sorteados</h4>
                    <div id="numeros-mais-sorteados" class="space-y-1 text-sm">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
                
                <!-- N√∫meros Menos Sorteados -->
                <div class="bg-red-50 dark:bg-red-900/20 rounded-lg p-4">
                    <h4 class="font-semibold mb-3 text-red-800 dark:text-red-200">‚ùÑÔ∏è Top 10 N√∫meros Menos Sorteados</h4>
                    <div id="numeros-menos-sorteados" class="space-y-1 text-sm">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
                
                <!-- Sequ√™ncias -->
                <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">
                    <h4 class="font-semibold mb-3 text-blue-800 dark:text-blue-200">üî¢ An√°lise de Sequ√™ncias</h4>
                    <div class="space-y-2 text-sm">
                        <div>Sequ√™ncias de 2: <span id="sequencias-2" class="font-bold">-</span></div>
                        <div>Sequ√™ncias de 3: <span id="sequencias-3" class="font-bold">-</span></div>
                        <div>Sequ√™ncias de 4+: <span id="sequencias-4" class="font-bold">-</span></div>
                        <div class="mt-3 text-xs text-blue-700 dark:text-blue-300">
                            <strong>Maior sequ√™ncia:</strong><br>
                            <span id="maior-sequencia">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ranking de Pares vs √çmpares -->
    <div id="ranking-pares-impares-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üìä RANKING: Distribui√ß√£o Pares vs √çmpares por Jogo</h3>
            <div id="ranking-pares-impares-container" class="space-y-4">
                <!-- Ser√° preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Ranking de Dezenas Repetidas -->
    <div id="ranking-dezenas-repetidas-section" class="container mx-auto px-4 py-8 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">üéØ RANKING: Dezenas Finais Repetidas por Jogo</h3>
            <div id="ranking-dezenas-repetidas-container" class="space-y-4">
                <!-- Ser√° preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Controle dos Resultados Completos -->
    <div id="ultimos-resultados-container" class="container mx-auto px-4 py-8 hidden">
        
        <!-- Bot√£o Toggle Individual - Pares vs √çmpares -->
        <div class="text-center mb-6">
            <button id="toggle-pares-impares" class="toggle-button inline-flex items-center gap-3 px-8 py-4 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                <span id="toggle-icon-pares" class="text-2xl">üëÅÔ∏è</span>
                <span id="toggle-text-pares" class="text-lg">Mostrar TODOS os Resultados - Pares vs √çmpares</span>
                <span id="toggle-arrow-pares" class="text-xl transition-transform duration-300">‚¨áÔ∏è</span>
            </button>
            <div class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                <p class="text-xs">üîµ An√°lise completa de pares vs √≠mpares em todos os concursos hist√≥ricos</p>
            </div>
        </div>

        <!-- Se√ß√£o Pares vs √çmpares -->
        <div id="secao-pares-impares" class="secao-oculta mb-8">
            <!-- √öltimos Resultados - Pares vs √çmpares -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
                <h3 class="text-2xl font-bold mb-6 text-center flex items-center justify-center gap-2">
                    <span>üìÖ</span>
                    <span>TODOS os Resultados - Pares vs √çmpares</span>
                    <span class="text-lg text-primary ml-2" id="total-resultados-pares">(<span id="count-resultados-pares">0</span> concursos)</span>
                </h3>
                <div id="ultimos-resultados" class="space-y-4">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
            </div>
            
            <!-- √öltimos Resultados - Dezenas Finais -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                <h3 class="text-2xl font-bold mb-6 text-center flex items-center justify-center gap-2">
                    <span>üéØ</span>
                    <span>TODOS os Resultados - Dezenas Finais Repetidas</span>
                    <span class="text-lg text-primary ml-2" id="total-resultados-dezenas">(<span id="count-resultados-dezenas">0</span> concursos)</span>
                </h3>
                <div id="ultimos-resultados-dezenas" class="space-y-4">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
                
                <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-md">
                    <h4 class="font-semibold mb-2 text-blue-800 dark:text-blue-200 flex items-center gap-2">
                        <span>üìã</span>
                        <span>Legenda das Cores</span>
                    </h4>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-2 text-sm">
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(0, 70%, 60%)"></div>
                            <span>D√≠gito 0</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(36, 70%, 60%)"></div>
                            <span>D√≠gito 1</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(72, 70%, 60%)"></div>
                            <span>D√≠gito 2</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(108, 70%, 60%)"></div>
                            <span>D√≠gito 3</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(144, 70%, 60%)"></div>
                            <span>D√≠gito 4</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(180, 70%, 60%)"></div>
                            <span>D√≠gito 5</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(216, 70%, 60%)"></div>
                            <span>D√≠gito 6</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(252, 70%, 60%)"></div>
                            <span>D√≠gito 7</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(288, 70%, 60%)"></div>
                            <span>D√≠gito 8</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(324, 70%, 60%)"></div>
                            <span>D√≠gito 9</span>
                        </div>
                    </div>
                    <p class="text-xs text-blue-700 dark:text-blue-300 mt-2">
                        <strong>N√∫meros com a mesma cor terminam com o mesmo d√≠gito.</strong> 
                        Quando h√° repeti√ß√µes, elas s√£o destacadas com bordas douradas e efeito de brilho.
                    </p>
                </div>
            </div>
        </div>

        <!-- Bot√£o Toggle Individual - Dezenas Finais -->
        <div class="text-center mb-6">
            <button id="toggle-dezenas-finais" class="toggle-button inline-flex items-center gap-3 px-8 py-4 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-purple-300">
                <span id="toggle-icon-dezenas" class="text-2xl">üëÅÔ∏è</span>
                <span id="toggle-text-dezenas" class="text-lg">Mostrar TODOS os Resultados - Dezenas Finais Repetidas</span>
                <span id="toggle-arrow-dezenas" class="text-xl transition-transform duration-300">‚¨áÔ∏è</span>
            </button>
            <div class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                <p class="text-xs">üéØ An√°lise completa de repeti√ß√µes de d√≠gitos finais em todos os concursos hist√≥ricos</p>
            </div>
        </div>

        <!-- Se√ß√£o Dezenas Finais -->
        <div id="secao-dezenas-finais" class="secao-oculta">
            <!-- Dezenas Finais Repetidas -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
                <h3 class="text-2xl font-bold mb-6 text-center flex items-center justify-center gap-2">
                    <span>üéØ</span>
                    <span>TODOS os Resultados - Dezenas Finais Repetidas</span>
                    <span class="text-lg text-primary ml-2" id="total-resultados-dezenas-2">(<span id="count-resultados-dezenas-2">0</span> concursos)</span>
                </h3>
                <div id="ultimos-resultados-dezenas-2" class="space-y-4">
                    <!-- Ser√° preenchido dinamicamente -->
                </div>
                
                <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-md">
                    <h4 class="font-semibold mb-2 text-blue-800 dark:text-blue-200 flex items-center gap-2">
                        <span>üìã</span>
                        <span>Legenda das Cores</span>
                    </h4>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-2 text-sm">
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(0, 70%, 60%)"></div>
                            <span>D√≠gito 0</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(36, 70%, 60%)"></div>
                            <span>D√≠gito 1</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(72, 70%, 60%)"></div>
                            <span>D√≠gito 2</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(108, 70%, 60%)"></div>
                            <span>D√≠gito 3</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(144, 70%, 60%)"></div>
                            <span>D√≠gito 4</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(180, 70%, 60%)"></div>
                            <span>D√≠gito 5</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(216, 70%, 60%)"></div>
                            <span>D√≠gito 6</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(252, 70%, 60%)"></div>
                            <span>D√≠gito 7</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(288, 70%, 60%)"></div>
                            <span>D√≠gito 8</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-full border border-gray-300" style="background: hsl(324, 70%, 60%)"></div>
                            <span>D√≠gito 9</span>
                        </div>
                    </div>
                    <p class="text-xs text-blue-700 dark:text-blue-300 mt-2">
                        <strong>N√∫meros com a mesma cor terminam com o mesmo d√≠gito.</strong> 
                        Quando h√° repeti√ß√µes, elas s√£o destacadas com bordas douradas e efeito de brilho.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais para controle do sistema
        let todosResultados = [];
        let carregamentoCancelado = false;
        let estatisticas = {
            totalConcursos: 0,
            totalNumeros: 0,
            pares: 0,
            impares: 0,
            digitosFinais: {},
            numerosFrequencia: {},
            concursos: []
        };
        
        // Vari√°veis de controle de tempo e performance
        let tempoInicioCarregamento = Date.now();
        let ultimaAtualizacaoVelocidade = Date.now();
        let contadorConcursosVelocidade = 0;
        let totalLogsAtividade = 0;

        // APIs dispon√≠veis (com prioridade)
        const APIS_DISPONIVEIS = [
            'https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena',
            'https://loteriascaixa-api.herokuapp.com/api/megasena'
        ];

        // ===== FUN√á√ïES DE INTERFACE E CONTROLE =====

        function adicionarLog(mensagem, tipo = 'info') {
            const logContainer = document.getElementById('activity-log');
            const agora = new Date();
            const timestamp = agora.toLocaleTimeString('pt-BR');
            
            const logItem = document.createElement('div');
            logItem.className = 'flex items-center gap-2';
            
            let icone = '‚Ä¢';
            let cor = 'text-gray-500';
            
            switch(tipo) {
                case 'success':
                    icone = '‚úÖ';
                    cor = 'text-green-500';
                    break;
                case 'error':
                    icone = '‚ùå';
                    cor = 'text-red-500';
                    break;
                case 'warning':
                    icone = '‚ö†Ô∏è';
                    cor = 'text-yellow-500';
                    break;
                case 'api':
                    icone = 'üîó';
                    cor = 'text-blue-500';
                    break;
                default:
                    icone = '‚Ä¢';
                    cor = 'text-gray-500';
            }
            
            logItem.innerHTML = `
                <span class="${cor}">${icone}</span>
                <span>${mensagem}</span>
                <span class="text-gray-400 ml-auto">${timestamp}</span>
            `;
            
            // Inserir no topo
            logContainer.insertBefore(logItem, logContainer.firstChild);
            
            // Limitar a 20 logs para performance
            while (logContainer.children.length > 20) {
                logContainer.removeChild(logContainer.lastChild);
            }
            
            // Atualizar contador
            totalLogsAtividade++;
            document.getElementById('total-logs').textContent = `(${totalLogsAtividade} eventos)`;
            
            console.log(`[${tipo.toUpperCase()}] ${mensagem}`);
        }

        function atualizarProgresso(porcentagem, status, eta = null) {
            document.getElementById('progress-bar').style.width = `${porcentagem}%`;
            document.getElementById('progress-text').textContent = `${Math.round(porcentagem)}%`;
            document.getElementById('loading-status').textContent = status;
            
            if (eta) {
                document.getElementById('progress-eta').textContent = eta;
            }
        }

        function atualizarEstatisticasCarregamento(concursosCarregados, ultimoConcurso, numerosProcessados) {
            document.getElementById('concursos-carregados').textContent = concursosCarregados.toLocaleString('pt-BR');
            document.getElementById('ultimo-concurso-status').textContent = ultimoConcurso || '-';
            document.getElementById('numeros-processados').textContent = numerosProcessados.toLocaleString('pt-BR');
            
            // Calcular velocidade de download
            const agora = Date.now();
            const tempoDecorrido = agora - ultimaAtualizacaoVelocidade;
            
            if (tempoDecorrido >= 1000) { // Atualizar a cada segundo
                const velocidade = Math.round(contadorConcursosVelocidade / (tempoDecorrido / 1000));
                document.getElementById('velocidade-download').textContent = `${velocidade}/s`;
                
                // Reset para pr√≥ximo c√°lculo
                ultimaAtualizacaoVelocidade = agora;
                contadorConcursosVelocidade = 0;
            }
        }

        function mostrarBotaoCancelar() {
            setTimeout(() => {
                if (!carregamentoCancelado) {
                    document.getElementById('cancel-button-container').classList.remove('hidden');
                }
            }, 10000); // Mostrar ap√≥s 10 segundos
        }

        function configurarEventos() {
            // Configurar bot√£o de cancelar
            document.getElementById('cancel-button').addEventListener('click', () => {
                carregamentoCancelado = true;
                adicionarLog('Carregamento cancelado pelo usu√°rio', 'warning');
                atualizarProgresso(100, 'Cancelado pelo usu√°rio');
                
                // Mostrar resultados parciais se houver
                if (todosResultados.length > 0) {
                    setTimeout(() => {
                        processarDados();
                        finalizarCarregamento();
                    }, 1000);
                } else {
                    document.getElementById('loading-status').textContent = 'Opera√ß√£o cancelada';
                }
            });

            // Configurar tempo inicial
            document.getElementById('init-time').textContent = new Date().toLocaleTimeString('pt-BR');
        }

        // ===== FUN√á√ïES DE API E CARREGAMENTO =====

        async function buscarDadosCaixa() {
            try {
                tempoInicioCarregamento = Date.now();
                adicionarLog('üöÄ Iniciando busca COMPLETA de dados da Caixa...', 'info');
                atualizarProgresso(5, 'Conectando com a API...');
                
                // Buscar √∫ltimo concurso para saber o total
                const ultimoConcursoInfo = await buscarUltimoConcurso();
                if (!ultimoConcursoInfo) {
                    throw new Error('N√£o foi poss√≠vel obter informa√ß√µes do √∫ltimo concurso');
                }

                const numeroUltimoConcurso = ultimoConcursoInfo.numero;
                adicionarLog(`üéØ √öltimo concurso encontrado: #${numeroUltimoConcurso}`, 'success');
                adicionarLog(`üìä Range de busca: Concurso 1 ‚Üí ${numeroUltimoConcurso}`, 'info');
                atualizarProgresso(15, `Encontrados ${numeroUltimoConcurso} concursos. Iniciando busca completa...`);

                // Configurar processamento em lotes otimizado
                const loteSize = determinarTamanhoLote(numeroUltimoConcurso);
                const totalLotes = Math.ceil(numeroUltimoConcurso / loteSize);
                
                adicionarLog(`‚öôÔ∏è Processamento em ${totalLotes} lotes de ${loteSize} concursos`, 'info');
                
                // Mostrar bot√£o de cancelar
                mostrarBotaoCancelar();
                
                // IMPORTANTE: Processar TODOS os lotes do concurso 1 at√© o √∫ltimo
                for (let lote = 0; lote < totalLotes && !carregamentoCancelado; lote++) {
                    const inicio = lote * loteSize + 1; // Sempre come√ßar do 1
                    const fim = Math.min((lote + 1) * loteSize, numeroUltimoConcurso);
                    
                    const progressoLote = 15 + (lote / totalLotes) * 70;
                    const eta = calcularETA(lote, totalLotes, tempoInicioCarregamento);
                    
                    atualizarProgresso(progressoLote, `Lote ${lote + 1}/${totalLotes}: Concursos ${inicio}-${fim}`, eta);
                    adicionarLog(`üì• Baixando concursos ${inicio} a ${fim}...`, 'api');
                    
                    // Buscar concursos deste lote
                    const resultadosLote = await buscarLoteConcursos(inicio, fim);
                    
                    // Adicionar resultados v√°lidos
                    resultadosLote.forEach(resultado => {
                        if (resultado) {
                            todosResultados.push(resultado);
                            contadorConcursosVelocidade++;
                        }
                    });
                    
                    // Atualizar estat√≠sticas em tempo real
                    atualizarEstatisticasCarregamento(
                        todosResultados.length,
                        fim,
                        todosResultados.length * 6 // Mega Sena tem 6 n√∫meros
                    );
                    
                    // Log de progresso a cada 10 lotes
                    if ((lote + 1) % 10 === 0) {
                        adicionarLog(`‚úÖ Processados ${lote + 1}/${totalLotes} lotes (${todosResultados.length} concursos)`, 'success');
                    }
                    
                    // Pequena pausa para n√£o sobrecarregar a API
                    await new Promise(resolve => setTimeout(resolve, 50));
                }

                if (carregamentoCancelado) {
                    adicionarLog('‚ö†Ô∏è Processamento interrompido pelo usu√°rio', 'warning');
                } else {
                    adicionarLog(`üéâ Carregamento conclu√≠do: ${todosResultados.length} concursos obtidos`, 'success');
                }
                
                // Processar dados finais
                atualizarProgresso(90, 'Processando dados estat√≠sticos...');
                processarDados();
                
                // Finalizar
                atualizarProgresso(100, 'Carregamento conclu√≠do!');
                finalizarCarregamento();

            } catch (error) {
                console.error('Erro no carregamento:', error);
                adicionarLog(`‚ùå Erro: ${error.message}`, 'error');
                atualizarProgresso(0, `Erro: ${error.message}`);
                
                // Tentar usar dados de backup ou exemplo
                setTimeout(() => {
                    tentarCarregamentoAlternativo();
                }, 3000);
            }
        }

        async function buscarUltimoConcurso() {
            for (const apiUrl of APIS_DISPONIVEIS) {
                try {
                    adicionarLog(`üîç Testando API: ${new URL(apiUrl).hostname}`, 'api');
                    const response = await fetch(`${apiUrl}/`);
                    if (response.ok) {
                        const dados = await response.json();
                        const numero = dados.numero || dados.concurso;
                        if (numero) {
                            adicionarLog(`‚úÖ API funcionando: ${new URL(apiUrl).hostname}`, 'success');
                            return { numero, apiUrl };
                        }
                    }
                } catch (error) {
                    adicionarLog(`‚ùå Falha na API: ${new URL(apiUrl).hostname}`, 'error');
                }
            }
            return null;
        }

        async function buscarLoteConcursos(inicio, fim) {
            const promises = [];
            
            // CORRIGIDO: Garantir que busque desde o concurso 1
            for (let i = inicio; i <= fim; i++) {
                promises.push(buscarConcursoEspecifico(i));
            }
            
            const resultados = await Promise.allSettled(promises);
            return resultados.map(r => r.status === 'fulfilled' ? r.value : null);
        }

        async function buscarConcursoEspecifico(numero) {
            for (const apiUrl of APIS_DISPONIVEIS) {
                try {
                    const response = await fetch(`${apiUrl}/${numero}`, {
                        timeout: 10000 // Timeout de 10 segundos
                    });
                    
                    if (!response.ok) continue;
                    
                    const dados = await response.json();
                    
                    // Normalizar formato dos dados
                    let numerosArray;
                    let dataApuracao;
                    
                    if (dados.listaDezenas) {
                        // Formato API oficial da Caixa
                        numerosArray = dados.listaDezenas.map(n => parseInt(n));
                        dataApuracao = dados.dataApuracao;
                    } else if (dados.dezenas) {
                        // Formato API alternativa
                        numerosArray = dados.dezenas.map(n => parseInt(n));
                        dataApuracao = dados.data;
                    } else {
                        continue;
                    }
                    
                    if (numerosArray && numerosArray.length === 6) { // Mega Sena tem 6 n√∫meros
                        return {
                            numero: dados.numero || dados.concurso || numero,
                            data: dataApuracao,
                            numeros: numerosArray
                        };
                    }
                } catch (error) {
                    // Continuar tentando outras APIs
                    continue;
                }
            }
            
            return null; // N√£o conseguiu buscar este concurso
        }

        function determinarTamanhoLote(totalConcursos) {
            // Otimizar tamanho do lote baseado no total
            if (totalConcursos <= 100) return 10;
            if (totalConcursos <= 500) return 25;
            if (totalConcursos <= 1000) return 50;
            return 75; // Para grandes volumes
        }

        function calcularETA(loteAtual, totalLotes, tempoInicio) {
            if (loteAtual === 0) return 'Calculando...';
            
            const tempoDecorrido = Date.now() - tempoInicio;
            const tempoMedioLote = tempoDecorrido / loteAtual;
            const lotesRestantes = totalLotes - loteAtual;
            const tempoRestante = tempoMedioLote * lotesRestantes;
            
            const minutos = Math.floor(tempoRestante / 60000);
            const segundos = Math.floor((tempoRestante % 60000) / 1000);
            
            if (minutos > 0) {
                return `~${minutos}m ${segundos}s restantes`;
            } else {
                return `~${segundos}s restantes`;
            }
        }

        function tentarCarregamentoAlternativo() {
            adicionarLog('‚ö†Ô∏è Tentando carregamento alternativo...', 'warning');
            // Implementar carregamento com dados reduzidos ou cache
            usarDadosExemplo();
        }

        // ===== PROCESSAMENTO DE DADOS =====

        function processarDados() {
            if (todosResultados.length === 0) {
                adicionarLog('‚ö†Ô∏è Nenhum dado para processar', 'warning');
                return;
            }

            adicionarLog(`üìä Processando estat√≠sticas de ${todosResultados.length} concursos...`, 'info');
            
            // Inicializar contadores
            estatisticas.totalConcursos = todosResultados.length;
            estatisticas.totalNumeros = estatisticas.totalConcursos * 6; // Mega Sena tem 6 n√∫meros
            estatisticas.pares = 0;
            estatisticas.impares = 0;
            estatisticas.digitosFinais = {};
            estatisticas.numerosFrequencia = {};
            
            // Inicializar contadores
            for (let i = 0; i <= 9; i++) {
                estatisticas.digitosFinais[i] = 0;
            }
            for (let i = 1; i <= 60; i++) { // Mega Sena vai de 1 a 60
                estatisticas.numerosFrequencia[i] = 0;
            }

            // Processar cada concurso
            todosResultados.forEach(concurso => {
                let paresConcurso = 0;
                let imparesConcurso = 0;

                concurso.numeros.forEach(numero => {
                    estatisticas.numerosFrequencia[numero]++;
                    
                    if (numero % 2 === 0) {
                        estatisticas.pares++;
                        paresConcurso++;
                    } else {
                        estatisticas.impares++;
                        imparesConcurso++;
                    }
                    
                    const digitoFinal = numero % 10;
                    estatisticas.digitosFinais[digitoFinal]++;
                });

                estatisticas.concursos.push({
                    numero: concurso.numero,
                    data: concurso.data,
                    numeros: concurso.numeros,
                    pares: paresConcurso,
                    impares: imparesConcurso
                });
            });

            estatisticas.concursos.sort((a, b) => a.numero - b.numero);
            adicionarLog('‚úÖ Processamento estat√≠stico conclu√≠do', 'success');
        }

        function finalizarCarregamento() {
            const tempoTotal = Date.now() - tempoInicioCarregamento;
            const tempoFormatado = formatarTempo(tempoTotal);
            const velocidadeMedia = Math.round(todosResultados.length / (tempoTotal / 1000));
            
            // Atualizar informa√ß√µes finais
            document.getElementById('tempo-total-carregamento').textContent = tempoFormatado;
            document.getElementById('velocidade-media').textContent = `${velocidadeMedia} concursos/s`;
            document.getElementById('data-ultima-atualizacao').textContent = new Date().toLocaleString('pt-BR');
            document.getElementById('last-update-time').textContent = new Date().toLocaleString('pt-BR');
            
            adicionarLog(`üèÅ Carregamento finalizado em ${tempoFormatado}`, 'success');
            
            // Ocultar loading e mostrar resultados
            setTimeout(() => {
                document.getElementById('loading-section').classList.add('hidden');
                exibirResultados();
            }, 1000);
        }

        function formatarTempo(milliseconds) {
            const seconds = Math.floor(milliseconds / 1000);
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            
            if (minutes > 0) {
                return `${minutes}m ${remainingSeconds}s`;
            } else {
                return `${remainingSeconds}s`;
            }
        }

        // ===== EXIBI√á√ÉO DOS RESULTADOS =====

        function exibirResultados() {
            exibirResumoGeral();
            exibirAnaliseParesImpares();
            exibirAnaliseDigitosFinais();
            exibirEstatisticasExtras();
            exibirRankingParesImpares();
            exibirRankingDezenasRepetidas();
            exibirUltimosResultados();
            exibirUltimosResultadosDezenas();
            exibirUltimosResultadosDezenasIndividual();
            
            // Configurar os toggles individuais DEPOIS de criar todas as se√ß√µes
            setTimeout(() => {
                configurarTogglesIndividuais();
            }, 500);
        }

        function exibirResumoGeral() {
            document.getElementById('total-concursos').textContent = estatisticas.totalConcursos.toLocaleString('pt-BR');
            document.getElementById('total-numeros').textContent = estatisticas.totalNumeros.toLocaleString('pt-BR');
            
            if (estatisticas.concursos.length > 0) {
                document.getElementById('primeiro-concurso').textContent = estatisticas.concursos[0].numero;
                document.getElementById('ultimo-concurso').textContent = estatisticas.concursos[estatisticas.concursos.length - 1].numero;
            }
            
            document.getElementById('summary-section').classList.remove('hidden');
        }

        function exibirAnaliseParesImpares() {
            const totalNumeros = estatisticas.totalNumeros;
            const percentPares = ((estatisticas.pares / totalNumeros) * 100).toFixed(1);
            const percentImpares = ((estatisticas.impares / totalNumeros) * 100).toFixed(1);

            document.getElementById('total-pares').textContent = estatisticas.pares.toLocaleString('pt-BR');
            document.getElementById('total-impares').textContent = estatisticas.impares.toLocaleString('pt-BR');
            document.getElementById('percent-pares').textContent = `${percentPares}%`;
            document.getElementById('percent-impares').textContent = `${percentImpares}%`;

            const mediaPares = (estatisticas.pares / estatisticas.totalConcursos).toFixed(1);
            const mediaImpares = (estatisticas.impares / estatisticas.totalConcursos).toFixed(1);
            
            document.getElementById('media-pares-concurso').textContent = mediaPares;
            document.getElementById('media-impares-concurso').textContent = mediaImpares;

            let concursoMaisPar = { numero: 0, pares: 0 };
            let concursoMaisImpar = { numero: 0, impares: 0 };
            
            estatisticas.concursos.forEach(concurso => {
                if (concurso.pares > concursoMaisPar.pares) {
                    concursoMaisPar = { numero: concurso.numero, pares: concurso.pares };
                }
                if (concurso.impares > concursoMaisImpar.impares) {
                    concursoMaisImpar = { numero: concurso.numero, impares: concurso.impares };
                }
            });

            document.getElementById('concurso-mais-par').textContent = `#${concursoMaisPar.numero} (${concursoMaisPar.pares} pares)`;
            document.getElementById('concurso-mais-impar').textContent = `#${concursoMaisImpar.numero} (${concursoMaisImpar.impares} √≠mpares)`;

            criarGraficoParesImpares();
            document.getElementById('pares-impares-section').classList.remove('hidden');
        }

        function exibirAnaliseDigitosFinais() {
            const digitosOrdenados = Object.entries(estatisticas.digitosFinais)
                .map(([digito, freq]) => ({ digito: parseInt(digito), frequencia: freq }))
                .sort((a, b) => b.frequencia - a.frequencia);

            const rankingContainer = document.getElementById('ranking-digitos');
            rankingContainer.innerHTML = '';

            digitosOrdenados.forEach((item, index) => {
                const posicao = index + 1;
                const percent = ((item.frequencia / estatisticas.totalNumeros) * 100).toFixed(1);
                
                let medalha = '';
                let corClass = '';
                if (posicao === 1) {
                    medalha = 'ü•á';
                    corClass = 'bg-yellow-100 dark:bg-yellow-900/30 border-yellow-400';
                } else if (posicao === 2) {
                    medalha = 'ü•à';
                    corClass = 'bg-gray-100 dark:bg-gray-700 border-gray-400';
                } else if (posicao === 3) {
                    medalha = 'ü•â';
                    corClass = 'bg-orange-100 dark:bg-orange-900/30 border-orange-400';
                } else {
                    corClass = 'bg-blue-50 dark:bg-blue-900/20 border-blue-200';
                }

                const digitoCard = document.createElement('div');
                digitoCard.className = `text-center p-4 border-2 rounded-lg ${corClass}`;
                digitoCard.innerHTML = `
                    <div class="text-lg mb-1">${medalha}</div>
                    <div class="text-3xl font-bold text-primary dark:text-blue-400">${item.digito}</div>
                    <div class="text-sm font-semibold">${item.frequencia.toLocaleString('pt-BR')}</div>
                    <div class="text-xs opacity-75">${percent}%</div>
                    <div class="text-xs mt-1">#{posicao}</div>
                `;
                rankingContainer.appendChild(digitoCard);
            });

            const maisFrequente = digitosOrdenados[0];
            const menosFrequente = digitosOrdenados[digitosOrdenados.length - 1];
            const diferenca = maisFrequente.frequencia - menosFrequente.frequencia;

            document.getElementById('digito-mais-sorteado').textContent = `${maisFrequente.digito} (${maisFrequente.frequencia.toLocaleString('pt-BR')} vezes)`;
            document.getElementById('digito-menos-sorteado').textContent = `${menosFrequente.digito} (${menosFrequente.frequencia.toLocaleString('pt-BR')} vezes)`;
            document.getElementById('diferenca-digitos').textContent = `${diferenca.toLocaleString('pt-BR')} ocorr√™ncias`;

            criarGraficoDigitosFinais();
            document.getElementById('digitos-finais-section').classList.remove('hidden');
        }

        function exibirEstatisticasExtras() {
            const numerosOrdenados = Object.entries(estatisticas.numerosFrequencia)
                .map(([num, freq]) => ({ numero: parseInt(num), frequencia: freq }))
                .sort((a, b) => b.frequencia - a.frequencia);

            // Top 10 mais sorteados
            const top10Mais = numerosOrdenados.slice(0, 10);
            const maisContainer = document.getElementById('numeros-mais-sorteados');
            maisContainer.innerHTML = '';
            top10Mais.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center';
                div.innerHTML = `
                    <span>${index + 1}¬∫</span>
                    <span class="font-bold">${item.numero.toString().padStart(2, '0')}</span>
                    <span>${item.frequencia} vezes</span>
                `;
                maisContainer.appendChild(div);
            });

            // Top 10 menos sorteados
            const top10Menos = numerosOrdenados.slice(-10).reverse();
            const menosContainer = document.getElementById('numeros-menos-sorteados');
            menosContainer.innerHTML = '';
            top10Menos.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center';
                div.innerHTML = `
                    <span>${index + 1}¬∫</span>
                    <span class="font-bold">${item.numero.toString().padStart(2, '0')}</span>
                    <span>${item.frequencia} vezes</span>
                `;
                menosContainer.appendChild(div);
            });

            analisarSequencias();
            document.getElementById('extras-section').classList.remove('hidden');
        }

        function analisarSequencias() {
            let sequencias2 = 0;
            let sequencias3 = 0;
            let sequencias4Plus = 0;
            let maiorSequencia = { numeros: [], concurso: 0, tamanho: 0 };

            estatisticas.concursos.forEach(concurso => {
                const numerosOrdenados = [...concurso.numeros].sort((a, b) => a - b);
                
                let sequenciaAtual = [numerosOrdenados[0]];
                let maiorSequenciaConcurso = [numerosOrdenados[0]];

                for (let i = 1; i < numerosOrdenados.length; i++) {
                    if (numerosOrdenados[i] === numerosOrdenados[i-1] + 1) {
                        sequenciaAtual.push(numerosOrdenados[i]);
                    } else {
                        if (sequenciaAtual.length >= 2) {
                            if (sequenciaAtual.length === 2) sequencias2++;
                            else if (sequenciaAtual.length === 3) sequencias3++;
                            else sequencias4Plus++;

                            if (sequenciaAtual.length > maiorSequenciaConcurso.length) {
                                maiorSequenciaConcurso = [...sequenciaAtual];
                            }
                        }
                        sequenciaAtual = [numerosOrdenados[i]];
                    }
                }

                if (sequenciaAtual.length >= 2) {
                    if (sequenciaAtual.length === 2) sequencias2++;
                    else if (sequenciaAtual.length === 3) sequencias3++;
                    else sequencias4Plus++;

                    if (sequenciaAtual.length > maiorSequenciaConcurso.length) {
                        maiorSequenciaConcurso = [...sequenciaAtual];
                    }
                }

                if (maiorSequenciaConcurso.length > maiorSequencia.tamanho) {
                    maiorSequencia = {
                        numeros: maiorSequenciaConcurso,
                        concurso: concurso.numero,
                        tamanho: maiorSequenciaConcurso.length
                    };
                }
            });

            document.getElementById('sequencias-2').textContent = sequencias2;
            document.getElementById('sequencias-3').textContent = sequencias3;
            document.getElementById('sequencias-4').textContent = sequencias4Plus;
            
            if (maiorSequencia.tamanho >= 2) {
                document.getElementById('maior-sequencia').textContent = 
                    `${maiorSequencia.numeros.join('-')} (Concurso #${maiorSequencia.concurso}, ${maiorSequencia.tamanho} n√∫meros)`;
            } else {
                document.getElementById('maior-sequencia').textContent = 'Nenhuma sequ√™ncia encontrada';
            }
        }

        function exibirUltimosResultados() {
            // MOSTRAR TODOS OS RESULTADOS - n√£o apenas os √∫ltimos 10
            const todosOsConcursos = [...estatisticas.concursos].reverse(); // Do √∫ltimo para o primeiro
            const container = document.getElementById('ultimos-resultados');
            container.innerHTML = '';

            adicionarLog(`üìä Exibindo TODOS os ${todosOsConcursos.length} concursos - Pares vs √çmpares`, 'info');

            // Atualizar contador no t√≠tulo
            document.getElementById('count-resultados-pares').textContent = todosOsConcursos.length.toLocaleString('pt-BR');

            // Criar mensagem informativa no in√≠cio
            const infoDiv = document.createElement('div');
            infoDiv.className = 'mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg text-center';
            infoDiv.innerHTML = `
                <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">üìà An√°lise Completa Hist√≥rica</h4>
                <p class="text-sm text-blue-700 dark:text-blue-300">
                    Visualizando <strong>${todosOsConcursos.length.toLocaleString('pt-BR')} concursos</strong> 
                    do #${estatisticas.concursos[0]?.numero || 1} ao #${estatisticas.concursos[estatisticas.concursos.length - 1]?.numero || todosOsConcursos.length}
                </p>
                <p class="text-xs text-blue-600 dark:text-blue-400 mt-1">
                    üîµ Azul = N√∫meros Pares | üî¥ Vermelho = N√∫meros √çmpares
                </p>
            `;
            container.appendChild(infoDiv);

            // Processar todos os concursos
            todosOsConcursos.forEach((concurso, index) => {
                const div = document.createElement('div');
                div.className = 'flex flex-col md:flex-row items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-600';
                
                const numerosHTML = concurso.numeros.map(num => {
                    const isPar = num % 2 === 0;
                    return `<div class="number-ball ${isPar ? 'par' : 'impar'}">${num.toString().padStart(2, '0')}</div>`;
                }).join('');

                // Adicionar an√°lise visual para concursos com padr√µes interessantes
                let destaque = '';
                if (concurso.pares === 6) { // Mega Sena tem 6 n√∫meros
                    destaque = '<span class="text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded ml-2">üéØ TODOS PARES!</span>';
                } else if (concurso.impares === 6) {
                    destaque = '<span class="text-xs bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-2 py-1 rounded ml-2">üéØ TODOS √çMPARES!</span>';
                } else if (concurso.pares === 3 && concurso.impares === 3) {
                    destaque = '<span class="text-xs bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-2 py-1 rounded ml-2">‚öñÔ∏è EQUILIBRADO</span>';
                }

                div.innerHTML = `
                    <div class="text-center md:text-left mb-2 md:mb-0">
                        <div class="font-bold">Concurso #${concurso.numero}</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">${concurso.data}</div>
                    </div>
                    <div class="flex gap-2 mb-2 md:mb-0">
                        ${numerosHTML}
                    </div>
                    <div class="text-center text-sm">
                        <div class="flex items-center justify-center">
                            <span>Pares: <strong class="text-blue-600">${concurso.pares}</strong> | √çmpares: <strong class="text-red-600">${concurso.impares}</strong></span>
                            ${destaque}
                        </div>
                    </div>
                `;
                container.appendChild(div);

                // Log de progresso a cada 100 concursos processados
                if ((index + 1) % 100 === 0) {
                    adicionarLog(`‚úÖ Exibidos ${index + 1}/${todosOsConcursos.length} concursos (Pares vs √çmpares)`, 'info');
                }
            });

            // Mostrar o container
            document.getElementById('ultimos-resultados-container').classList.remove('hidden');

            adicionarLog(`‚úÖ Exibi√ß√£o completa finalizada: ${todosOsConcursos.length} concursos (Pares vs √çmpares)`, 'success');
        }

        function exibirUltimosResultadosDezenas() {
            // MOSTRAR TODOS OS RESULTADOS - n√£o apenas os √∫ltimos 10
            const todosOsConcursos = [...estatisticas.concursos].reverse(); // Do √∫ltimo para o primeiro
            const container = document.getElementById('ultimos-resultados-dezenas');
            container.innerHTML = '';

            adicionarLog(`üéØ Exibindo TODOS os ${todosOsConcursos.length} concursos - Dezenas Finais`, 'info');

            // Atualizar contador no t√≠tulo
            document.getElementById('count-resultados-dezenas').textContent = todosOsConcursos.length.toLocaleString('pt-BR');

            // Criar mensagem informativa no in√≠cio
            const infoDiv = document.createElement('div');
            infoDiv.className = 'mb-6 p-4 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-lg text-center';
            infoDiv.innerHTML = `
                <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-2">üéØ An√°lise Completa de D√≠gitos Finais</h4>
                <p class="text-sm text-purple-700 dark:text-purple-300">
                    Analisando <strong>${todosOsConcursos.length.toLocaleString('pt-BR')} concursos</strong> 
                    para identificar padr√µes de repeti√ß√£o nos d√≠gitos finais (0-9)
                </p>
                <p class="text-xs text-purple-600 dark:text-purple-400 mt-1">
                    ‚ú® Bordas douradas = Repeti√ß√µes de d√≠gitos finais | üåà Cores = Agrupamento por d√≠gito final
                </p>
            `;
            container.appendChild(infoDiv);

            // Contadores para estat√≠sticas
            let totalConcursosComRepeticao = 0;
            let maxRepeticoesConcurso = 0;
            let concursoMaisRepeticoes = { numero: 0, repeticoes: 0 };

            // Processar todos os concursos
            todosOsConcursos.forEach((concurso, index) => {
                const digitosFinais = {};
                const repeticoes = {};
                
                concurso.numeros.forEach(num => {
                    const digitoFinal = num % 10;
                    if (!digitosFinais[digitoFinal]) {
                        digitosFinais[digitoFinal] = [];
                    }
                    digitosFinais[digitoFinal].push(num);
                });

                Object.entries(digitosFinais).forEach(([digito, numeros]) => {
                    if (numeros.length > 1) {
                        repeticoes[digito] = numeros;
                    }
                });

                // Estat√≠sticas
                const totalRepeticoes = Object.keys(repeticoes).length;
                if (totalRepeticoes > 0) {
                    totalConcursosComRepeticao++;
                }
                if (totalRepeticoes > maxRepeticoesConcurso) {
                    maxRepeticoesConcurso = totalRepeticoes;
                    concursoMaisRepeticoes = { numero: concurso.numero, repeticoes: totalRepeticoes };
                }

                const div = document.createElement('div');
                div.className = 'p-4 bg-gray-50 dark:bg-gray-700 rounded-lg transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-600';
                
                const numerosHTML = concurso.numeros.map(num => {
                    const digitoFinal = num % 10;
                    const cor = `hsl(${digitoFinal * 36}, 70%, 60%)`;
                    const isRepetida = repeticoes[digitoFinal] !== undefined;
                    const repetidaClass = isRepetida ? 'repetida' : '';
                    
                    return `<div class="dezena-ball ${repetidaClass}" style="background: ${cor}">${num.toString().padStart(2, '0')}</div>`;
                }).join('');

                let resumoRepeticoes = '';
                let destacueEspecial = '';
                
                if (Object.keys(repeticoes).length > 0) {
                    const repeticoesTexto = Object.entries(repeticoes).map(([digito, numeros]) => {
                        return `D√≠gito ${digito}: ${numeros.map(n => n.toString().padStart(2, '0')).join(', ')}`;
                    }).join(' | ');
                    resumoRepeticoes = `<div class="text-xs text-amber-600 dark:text-amber-400 font-semibold mt-2">‚ú® ${repeticoesTexto}</div>`;
                    
                    // Destacar concursos com muitas repeti√ß√µes
                    if (Object.keys(repeticoes).length >= 3) {
                        destacueEspecial = '<span class="text-xs bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 px-2 py-1 rounded ml-2">üî• ALTA REPETI√á√ÉO!</span>';
                    } else if (Object.keys(repeticoes).length === 2) {
                        destacueEspecial = '<span class="text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded ml-2">‚ö° DUPLA REPETI√á√ÉO</span>';
                    }
                } else {
                    resumoRepeticoes = `<div class="text-xs text-gray-500 mt-2">Nenhuma repeti√ß√£o de d√≠gito final</div>`;
                }

                div.innerHTML = `
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="text-center md:text-left mb-2 md:mb-0">
                            <div class="font-bold">Concurso #${concurso.numero}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">${concurso.data}</div>
                        </div>
                        <div class="flex gap-2 mb-2 md:mb-0">
                            ${numerosHTML}
                        </div>
                        <div class="text-center text-sm">
                            <div class="flex items-center justify-center">
                                <span>Repeti√ß√µes: <strong class="text-purple-600">${Object.keys(repeticoes).length}</strong></span>
                                ${destacueEspecial}
                            </div>
                        </div>
                    </div>
                    ${resumoRepeticoes}
                `;
                container.appendChild(div);

                // Log de progresso a cada 100 concursos processados
                if ((index + 1) % 100 === 0) {
                    adicionarLog(`‚úÖ Exibidos ${index + 1}/${todosOsConcursos.length} concursos (Dezenas Finais)`, 'info');
                }
            });

            // Adicionar estat√≠sticas resumo no final
            const resumoDiv = document.createElement('div');
            resumoDiv.className = 'mt-6 p-4 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-lg';
            
            const percentualComRepeticao = ((totalConcursosComRepeticao / todosOsConcursos.length) * 100).toFixed(1);
            
            resumoDiv.innerHTML = `
                <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-2 text-center">üìä Estat√≠sticas Gerais de Repeti√ß√µes</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center text-sm">
                    <div>
                        <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">${totalConcursosComRepeticao.toLocaleString('pt-BR')}</div>
                        <div class="text-purple-700 dark:text-purple-300">Concursos com repeti√ß√£o</div>
                        <div class="text-xs text-purple-600">({percentualComRepeticao}% do total)</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-amber-600 dark:text-amber-400">${maxRepeticoesConcurso}</div>
                        <div class="text-amber-700 dark:text-amber-300">M√°ximo de repeti√ß√µes</div>
                        <div class="text-xs text-amber-600">em um √∫nico concurso</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-green-600 dark:text-green-400">#${concursoMaisRepeticoes.numero}</div>
                        <div class="text-green-700 dark:text-green-300">Concurso com mais repeti√ß√µes</div>
                        <div class="text-xs text-green-600">(${concursoMaisRepeticoes.repeticoes} d√≠gitos repetidos)</div>
                    </div>
                </div>
            `;
            container.appendChild(resumoDiv);

            adicionarLog(`‚úÖ Exibi√ß√£o completa finalizada: ${todosOsConcursos.length} concursos (Dezenas Finais)`, 'success');
        }

        function criarGraficoParesImpares() {
            const ctx = document.getElementById('paresImparesChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['N√∫meros Pares', 'N√∫meros √çmpares'],
                    datasets: [{
                        data: [estatisticas.pares, estatisticas.impares],
                        backgroundColor: ['#3b82f6', '#ef4444'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = estatisticas.totalNumeros;
                                    const percent = ((context.parsed / total) * 100).toFixed(1);
                                    return `${context.label}: ${context.parsed.toLocaleString('pt-BR')} (${percent}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function criarGraficoDigitosFinais() {
            const ctx = document.getElementById('digitosFinaisChart').getContext('2d');
            
            const labels = [];
            const data = [];
            const colors = [];
            
            for (let i = 0; i <= 9; i++) {
                labels.push(`D√≠gito ${i}`);
                data.push(estatisticas.digitosFinais[i]);
                colors.push(`hsl(${i * 36}, 70%, 60%)`);
            }
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Frequ√™ncia',
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors.map(color => color.replace('60%', '40%')),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Ocorr√™ncias'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'D√≠gito Final'
                            }
                        }
                    }
                }
            });
        }

        // ===== RANKING DE PARES VS √çMPARES =====
        function exibirRankingParesImpares() {
            const container = document.getElementById('ranking-pares-impares-container');
            container.innerHTML = '';

            // Calcular estat√≠sticas de distribui√ß√£o pares vs √≠mpares
            const distribuicaoParesImpares = {};
            
            estatisticas.concursos.forEach(concurso => {
                const chave = `${concurso.pares}P-${concurso.impares}I`;
                if (!distribuicaoParesImpares[chave]) {
                    distribuicaoParesImpares[chave] = {
                        pares: concurso.pares,
                        impares: concurso.impares,
                        frequencia: 0,
                        exemplos: []
                    };
                }
                distribuicaoParesImpares[chave].frequencia++;
                if (distribuicaoParesImpares[chave].exemplos.length < 3) {
                    distribuicaoParesImpares[chave].exemplos.push({
                        numero: concurso.numero,
                        data: concurso.data,
                        numeros: concurso.numeros
                    });
                }
            });

            // Ordenar por frequ√™ncia
            const rankingOrdenado = Object.values(distribuicaoParesImpares)
                .sort((a, b) => b.frequencia - a.frequencia);

            // Criar cabe√ßalho
            const headerDiv = document.createElement('div');
            headerDiv.className = 'mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg text-center';
            headerDiv.innerHTML = `
                <h4 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">üìä Distribui√ß√£o por Quantidade de Pares e √çmpares</h4>
                <p class="text-sm text-blue-700 dark:text-blue-300">
                    Ranking de frequ√™ncia das combina√ß√µes de pares vs √≠mpares em <strong>${estatisticas.totalConcursos.toLocaleString('pt-BR')} concursos</strong>
                </p>
            `;
            container.appendChild(headerDiv);

            // Criar ranking
            rankingOrdenado.forEach((item, index) => {
                const posicao = index + 1;
                const percent = ((item.frequencia / estatisticas.totalConcursos) * 100).toFixed(1);
                
                let medalha = '';
                let corClass = '';
                if (posicao === 1) {
                    medalha = 'ü•á';
                    corClass = 'bg-yellow-100 dark:bg-yellow-900/30 border-yellow-400';
                } else if (posicao === 2) {
                    medalha = 'ü•à';
                    corClass = 'bg-gray-100 dark:bg-gray-700 border-gray-400';
                } else if (posicao === 3) {
                    medalha = 'ü•â';
                    corClass = 'bg-orange-100 dark:bg-orange-900/30 border-orange-400';
                } else {
                    corClass = 'bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600';
                }

                const rankingCard = document.createElement('div');
                rankingCard.className = `p-4 border-2 rounded-lg ${corClass} transition-all hover:shadow-lg`;
                rankingCard.innerHTML = `
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="text-center md:text-left mb-3 md:mb-0">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-lg">${medalha}</span>
                                <span class="text-lg font-bold">#{posicao}</span>
                                <span class="text-xl font-bold text-primary">${item.pares} Pares - ${item.impares} √çmpares</span>
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">
                                <strong>${item.frequencia.toLocaleString('pt-BR')} jogos</strong> (${percent}% do total)
                            </div>
                        </div>
                        <div class="flex flex-col gap-2">
                            <div class="text-xs text-gray-500 mb-1">Exemplos de concursos:</div>
                            ${item.exemplos.map(exemplo => `
                                <div class="text-xs bg-gray-50 dark:bg-gray-700 p-2 rounded flex items-center gap-2">
                                    <span class="font-semibold">#${exemplo.numero}</span>
                                    <span class="text-gray-400">${exemplo.data}</span>
                                    <div class="flex gap-1">
                                        ${exemplo.numeros.map(num => {
                                            const isPar = num % 2 === 0;
                                            return `<span class="w-6 h-6 rounded-full text-xs flex items-center justify-center text-white font-bold ${isPar ? 'bg-blue-500' : 'bg-red-500'}">${num.toString().padStart(2, '0')}</span>`;
                                        }).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(rankingCard);
            });

            document.getElementById('ranking-pares-impares-section').classList.remove('hidden');
            adicionarLog('‚úÖ Ranking Pares vs √çmpares criado com sucesso', 'success');
        }

        // ===== RANKING DE DEZENAS REPETIDAS =====
        function exibirRankingDezenasRepetidas() {
            const container = document.getElementById('ranking-dezenas-repetidas-container');
            container.innerHTML = '';

            // Calcular estat√≠sticas de repeti√ß√µes de d√≠gitos finais
            const distribuicaoRepeticoes = {};
            
            estatisticas.concursos.forEach(concurso => {
                const digitosFinais = {};
                const repeticoes = {};
                
                concurso.numeros.forEach(num => {
                    const digitoFinal = num % 10;
                    if (!digitosFinais[digitoFinal]) {
                        digitosFinais[digitoFinal] = [];
                    }
                    digitosFinais[digitoFinal].push(num);
                });

                Object.entries(digitosFinais).forEach(([digito, numeros]) => {
                    if (numeros.length > 1) {
                        repeticoes[digito] = numeros;
                    }
                });

                const totalRepeticoes = Object.keys(repeticoes).length;
                const chave = `${totalRepeticoes}R`;
                
                if (!distribuicaoRepeticoes[chave]) {
                    distribuicaoRepeticoes[chave] = {
                        repeticoes: totalRepeticoes,
                        frequencia: 0,
                        exemplos: []
                    };
                }
                distribuicaoRepeticoes[chave].frequencia++;
                if (distribuicaoRepeticoes[chave].exemplos.length < 3) {
                    distribuicaoRepeticoes[chave].exemplos.push({
                        numero: concurso.numero,
                        data: concurso.data,
                        numeros: concurso.numeros,
                        repeticoesDetalhes: repeticoes
                    });
                }
            });

            // Ordenar por frequ√™ncia
            const rankingOrdenado = Object.values(distribuicaoRepeticoes)
                .sort((a, b) => b.frequencia - a.frequencia);

            // Criar cabe√ßalho
            const headerDiv = document.createElement('div');
            headerDiv.className = 'mb-6 p-4 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-lg text-center';
            headerDiv.innerHTML = `
                <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-2">üéØ Distribui√ß√£o por Quantidade de Repeti√ß√µes de D√≠gitos Finais</h4>
                <p class="text-sm text-purple-700 dark:text-purple-300">
                    Ranking de frequ√™ncia das repeti√ß√µes de d√≠gitos finais em <strong>${estatisticas.totalConcursos.toLocaleString('pt-BR')} concursos</strong>
                </p>
            `;
            container.appendChild(headerDiv);

            // Criar ranking
            rankingOrdenado.forEach((item, index) => {
                const posicao = index + 1;
                const percent = ((item.frequencia / estatisticas.totalConcursos) * 100).toFixed(1);
                
                let medalha = '';
                let corClass = '';
                let descricao = '';
                
                if (item.repeticoes === 0) {
                    descricao = 'Sem Repeti√ß√µes';
                    corClass = 'bg-green-100 dark:bg-green-900/30 border-green-400';
                } else if (item.repeticoes === 1) {
                    descricao = '1 D√≠gito Repetido';
                    corClass = 'bg-yellow-100 dark:bg-yellow-900/30 border-yellow-400';
                } else if (item.repeticoes === 2) {
                    descricao = '2 D√≠gitos Repetidos';
                    corClass = 'bg-orange-100 dark:bg-orange-900/30 border-orange-400';
                } else {
                    descricao = `${item.repeticoes} D√≠gitos Repetidos`;
                    corClass = 'bg-red-100 dark:bg-red-900/30 border-red-400';
                }
                
                if (posicao === 1) medalha = 'ü•á';
                else if (posicao === 2) medalha = 'ü•à';
                else if (posicao === 3) medalha = 'ü•â';

                const rankingCard = document.createElement('div');
                rankingCard.className = `p-4 border-2 rounded-lg ${corClass} transition-all hover:shadow-lg`;
                rankingCard.innerHTML = `
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="text-center md:text-left mb-3 md:mb-0">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="text-lg">${medalha}</span>
                                <span class="text-lg font-bold">#{posicao}</span>
                                <span class="text-xl font-bold text-primary">${descricao}</span>
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">
                                <strong>${item.frequencia.toLocaleString('pt-BR')} jogos</strong> (${percent}% do total)
                            </div>
                        </div>
                        <div class="flex flex-col gap-2">
                            <div class="text-xs text-gray-500 mb-1">Exemplos de concursos:</div>
                            ${item.exemplos.map(exemplo => {
                                const repeticoesTexto = Object.entries(exemplo.repeticoesDetalhes).map(([digito, numeros]) => {
                                    return `D√≠gito ${digito}: ${numeros.map(n => n.toString().padStart(2, '0')).join(', ')}`;
                                }).join(' | ');
                                
                                return `
                                <div class="text-xs bg-gray-50 dark:bg-gray-700 p-2 rounded">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="font-semibold">#${exemplo.numero}</span>
                                        <span class="text-gray-400">${exemplo.data}</span>
                                    </div>
                                    <div class="flex gap-1 mb-1">
                                        ${exemplo.numeros.map(num => {
                                            const digitoFinal = num % 10;
                                            const cor = `hsl(${digitoFinal * 36}, 70%, 60%)`;
                                            const isRepetida = exemplo.repeticoesDetalhes[digitoFinal] !== undefined;
                                            return `<span class="w-6 h-6 rounded-full text-xs flex items-center justify-center text-white font-bold${isRepetida ? ' ring-2 ring-yellow-400' : ''}" style="background: ${cor}">${num.toString().padStart(2, '0')}</span>`;
                                        }).join('')}
                                    </div>
                                    ${repeticoesTexto ? `<div class="text-xs text-amber-600 dark:text-amber-400">‚ú® ${repeticoesTexto}</div>` : ''}
                                </div>
                            `;
                            }).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(rankingCard);
            });

            document.getElementById('ranking-dezenas-repetidas-section').classList.remove('hidden');
            adicionarLog('‚úÖ Ranking Dezenas Repetidas criado com sucesso', 'success');
        }

        // ===== SEGUNDA FUN√á√ÉO PARA DEZENAS FINAIS INDIVIDUAL =====
        function exibirUltimosResultadosDezenasIndividual() {
            // MOSTRAR TODOS OS RESULTADOS - para a se√ß√£o individual
            const todosOsConcursos = [...estatisticas.concursos].reverse(); // Do √∫ltimo para o primeiro
            const container = document.getElementById('ultimos-resultados-dezenas-2');
            container.innerHTML = '';

            adicionarLog(`üéØ Exibindo TODOS os ${todosOsConcursos.length} concursos - Dezenas Finais Individual`, 'info');

            // Atualizar contador no t√≠tulo
            document.getElementById('count-resultados-dezenas-2').textContent = todosOsConcursos.length.toLocaleString('pt-BR');

            // Criar mensagem informativa no in√≠cio
            const infoDiv = document.createElement('div');
            infoDiv.className = 'mb-6 p-4 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-lg text-center';
            infoDiv.innerHTML = `
                <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-2">üéØ An√°lise Completa Individual de D√≠gitos Finais</h4>
                <p class="text-sm text-purple-700 dark:text-purple-300">
                    Se√ß√£o individual para an√°lise de <strong>${todosOsConcursos.length.toLocaleString('pt-BR')} concursos</strong>
                </p>
                <p class="text-xs text-purple-600 dark:text-purple-400 mt-1">
                    ‚ú® Controle individual para esta se√ß√£o espec√≠fica
                </p>
            `;
            container.appendChild(infoDiv);

            // Contadores para estat√≠sticas
            let totalConcursosComRepeticao = 0;
            let maxRepeticoesConcurso = 0;
            let concursoMaisRepeticoes = { numero: 0, repeticoes: 0 };

            // Processar todos os concursos
            todosOsConcursos.forEach((concurso, index) => {
                const digitosFinais = {};
                const repeticoes = {};
                
                concurso.numeros.forEach(num => {
                    const digitoFinal = num % 10;
                    if (!digitosFinais[digitoFinal]) {
                        digitosFinais[digitoFinal] = [];
                    }
                    digitosFinais[digitoFinal].push(num);
                });

                Object.entries(digitosFinais).forEach(([digito, numeros]) => {
                    if (numeros.length > 1) {
                        repeticoes[digito] = numeros;
                    }
                });

                // Estat√≠sticas
                const totalRepeticoes = Object.keys(repeticoes).length;
                if (totalRepeticoes > 0) {
                    totalConcursosComRepeticao++;
                }
                if (totalRepeticoes > maxRepeticoesConcurso) {
                    maxRepeticoesConcurso = totalRepeticoes;
                    concursoMaisRepeticoes = { numero: concurso.numero, repeticoes: totalRepeticoes };
                }

                const div = document.createElement('div');
                div.className = 'p-4 bg-gray-50 dark:bg-gray-700 rounded-lg transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-600';
                
                const numerosHTML = concurso.numeros.map(num => {
                    const digitoFinal = num % 10;
                    const cor = `hsl(${digitoFinal * 36}, 70%, 60%)`;
                    const isRepetida = repeticoes[digitoFinal] !== undefined;
                    const repetidaClass = isRepetida ? 'repetida' : '';
                    
                    return `<div class="dezena-ball ${repetidaClass}" style="background: ${cor}">${num.toString().padStart(2, '0')}</div>`;
                }).join('');

                let resumoRepeticoes = '';
                let destacueEspecial = '';
                
                if (Object.keys(repeticoes).length > 0) {
                    const repeticoesTexto = Object.entries(repeticoes).map(([digito, numeros]) => {
                        return `D√≠gito ${digito}: ${numeros.map(n => n.toString().padStart(2, '0')).join(', ')}`;
                    }).join(' | ');
                    resumoRepeticoes = `<div class="text-xs text-amber-600 dark:text-amber-400 font-semibold mt-2">‚ú® ${repeticoesTexto}</div>`;
                    
                    // Destacar concursos com muitas repeti√ß√µes
                    if (Object.keys(repeticoes).length >= 3) {
                        destacueEspecial = '<span class="text-xs bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 px-2 py-1 rounded ml-2">üî• ALTA REPETI√á√ÉO!</span>';
                    } else if (Object.keys(repeticoes).length === 2) {
                        destacueEspecial = '<span class="text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded ml-2">‚ö° DUPLA REPETI√á√ÉO</span>';
                    }
                } else {
                    resumoRepeticoes = `<div class="text-xs text-gray-500 mt-2">Nenhuma repeti√ß√£o de d√≠gito final</div>`;
                }

                div.innerHTML = `
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="text-center md:text-left mb-2 md:mb-0">
                            <div class="font-bold">Concurso #${concurso.numero}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">${concurso.data}</div>
                        </div>
                        <div class="flex gap-2 mb-2 md:mb-0">
                            ${numerosHTML}
                        </div>
                        <div class="text-center text-sm">
                            <div class="flex items-center justify-center">
                                <span>Repeti√ß√µes: <strong class="text-purple-600">${Object.keys(repeticoes).length}</strong></span>
                                ${destacueEspecial}
                            </div>
                        </div>
                    </div>
                    ${resumoRepeticoes}
                `;
                container.appendChild(div);

                // Log de progresso a cada 100 concursos processados
                if ((index + 1) % 100 === 0) {
                    adicionarLog(`‚úÖ Exibidos ${index + 1}/${todosOsConcursos.length} concursos (Dezenas Finais Individual)`, 'info');
                }
            });

            // Adicionar estat√≠sticas resumo no final
            const resumoDiv = document.createElement('div');
            resumoDiv.className = 'mt-6 p-4 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded-lg';
            
            const percentualComRepeticao = ((totalConcursosComRepeticao / todosOsConcursos.length) * 100).toFixed(1);
            
            resumoDiv.innerHTML = `
                <h4 class="font-semibold text-purple-800 dark:text-purple-200 mb-2 text-center">üìä Estat√≠sticas Gerais de Repeti√ß√µes (Se√ß√£o Individual)</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center text-sm">
                    <div>
                        <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">${totalConcursosComRepeticao.toLocaleString('pt-BR')}</div>
                        <div class="text-purple-700 dark:text-purple-300">Concursos com repeti√ß√£o</div>
                        <div class="text-xs text-purple-600">({percentualComRepeticao}% do total)</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-amber-600 dark:text-amber-400">${maxRepeticoesConcurso}</div>
                        <div class="text-amber-700 dark:text-amber-300">M√°ximo de repeti√ß√µes</div>
                        <div class="text-xs text-amber-600">em um √∫nico concurso</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-green-600 dark:text-green-400">#${concursoMaisRepeticoes.numero}</div>
                        <div class="text-green-700 dark:text-green-300">Concurso com mais repeti√ß√µes</div>
                        <div class="text-xs text-green-600">(${concursoMaisRepeticoes.repeticoes} d√≠gitos repetidos)</div>
                    </div>
                </div>
            `;
            container.appendChild(resumoDiv);

            adicionarLog(`‚úÖ Exibi√ß√£o completa finalizada: ${todosOsConcursos.length} concursos (Dezenas Finais Individual)`, 'success');
        }

        // ===== TOGGLES INDIVIDUAIS =====
        function configurarTogglesIndividuais() {
            // Toggle para Pares vs √çmpares
            const toggleParesBtn = document.getElementById('toggle-pares-impares');
            if (toggleParesBtn) {
                toggleParesBtn.addEventListener('click', () => {
                    toggleSecaoIndividual('secao-pares-impares', 'pares');
                });
                adicionarLog('Toggle Pares vs √çmpares configurado', 'success');
            }

            // Toggle para Dezenas Finais
            const toggleDezenasBtn = document.getElementById('toggle-dezenas-finais');
            if (toggleDezenasBtn) {
                toggleDezenasBtn.addEventListener('click', () => {
                    toggleSecaoIndividual('secao-dezenas-finais', 'dezenas');
                });
                adicionarLog('Toggle Dezenas Finais configurado', 'success');
            }
        }

        function toggleSecaoIndividual(secaoId, tipo) {
            const section = document.getElementById(secaoId);
            const toggleIcon = document.getElementById(`toggle-icon-${tipo}`);
            const toggleText = document.getElementById(`toggle-text-${tipo}`);
            const toggleArrow = document.getElementById(`toggle-arrow-${tipo}`);
            
            if (!section || !toggleIcon || !toggleText || !toggleArrow) {
                console.error(`Elementos do toggle ${tipo} n√£o encontrados`);
                return;
            }
            
            const isHidden = section.classList.contains('secao-oculta');
            
            if (isHidden) {
                // Mostrar se√ß√£o
                section.classList.remove('secao-oculta');
                section.classList.add('secao-visivel');
                
                // Atualizar bot√£o
                toggleIcon.textContent = 'üôà';
                if (tipo === 'pares') {
                    toggleText.textContent = 'Ocultar TODOS os Resultados - Pares vs √çmpares';
                } else {
                    toggleText.textContent = 'Ocultar TODOS os Resultados - Dezenas Finais Repetidas';
                }
                toggleArrow.textContent = '‚¨ÜÔ∏è';
                toggleArrow.style.transform = 'rotate(180deg)';
                
                // Salvar prefer√™ncia
                try {
                    localStorage.setItem(`mostrar${tipo.charAt(0).toUpperCase() + tipo.slice(1)}`, 'true');
                } catch (e) {
                    console.warn('N√£o foi poss√≠vel salvar prefer√™ncia');
                }
                
                adicionarLog(`Se√ß√£o ${tipo} exibida`, 'info');
            } else {
                // Ocultar se√ß√£o
                section.classList.remove('secao-visivel');
                section.classList.add('secao-oculta');
                
                // Atualizar bot√£o
                toggleIcon.textContent = 'üëÅÔ∏è';
                if (tipo === 'pares') {
                    toggleText.textContent = 'Mostrar TODOS os Resultados - Pares vs √çmpares';
                } else {
                    toggleText.textContent = 'Mostrar TODOS os Resultados - Dezenas Finais Repetidas';
                }
                toggleArrow.textContent = '‚¨áÔ∏è';
                toggleArrow.style.transform = 'rotate(0deg)';
                
                // Salvar prefer√™ncia
                try {
                    localStorage.setItem(`mostrar${tipo.charAt(0).toUpperCase() + tipo.slice(1)}`, 'false');
                } catch (e) {
                    console.warn('N√£o foi poss√≠vel salvar prefer√™ncia');
                }
                
                adicionarLog(`Se√ß√£o ${tipo} ocultada`, 'info');
            }
        }

        function usarDadosExemplo() {
            adicionarLog('‚ö†Ô∏è Carregando dados de exemplo...', 'warning');
            
            const exemplos = [
                { numero: 1, data: "1996-03-11", numeros: [4, 5, 30, 33, 41, 52] },
                { numero: 2, data: "1996-03-16", numeros: [7, 10, 13, 25, 42, 49] },
                { numero: 3, data: "1996-03-23", numeros: [12, 15, 17, 32, 45, 57] },
                { numero: 4, data: "1996-03-30", numeros: [2, 19, 26, 36, 40, 58] },
                { numero: 5, data: "1996-04-06", numeros: [1, 6, 9, 14, 22, 44] },
                { numero: 6, data: "1996-04-13", numeros: [8, 16, 20, 28, 39, 54] },
                { numero: 7, data: "1996-04-20", numeros: [3, 11, 18, 24, 37, 51] },
                { numero: 8, data: "1996-04-27", numeros: [13, 21, 29, 35, 46, 60] },
                { numero: 9, data: "1996-05-04", numeros: [5, 23, 27, 31, 43, 56] },
                { numero: 10, data: "1996-05-11", numeros: [2, 4, 6, 8, 10, 12] }
            ];
            
            todosResultados = exemplos;
            processarDados();
            
            atualizarProgresso(100, 'Dados de exemplo carregados');
            finalizarCarregamento();
        }

        // ===== INICIALIZA√á√ÉO =====
        window.onload = function() {
            configurarEventos();
            buscarDadosCaixa();
        };
    </script>
</body>
</html>